/*!
*  filename: ej2.map.all.min.js
*  version : 5.1.55.55
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};t.m=n;t.c=i;t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})};t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})};t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r};t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i};t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};t.p="";t(t.s=5)}([function(n){n.exports=ejs.base},function(n){n.exports=ejs.data},function(n){n.exports=ejs.svgbase},function(n){n.exports=ejs.pdfexport},function(n,t){t.copy=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}},function(n,t,i){"use strict";function bt(n,t){return null!=n?-1!==n.indexOf("%")?t/100*parseInt(n,10):parseInt(n,10):null}function rf(n){n.renderer=new st.SvgRenderer(n.element.id),function(n){n.element.style.height=Object(r.isNullOrUndefined)(n.height)?"auto":n.height;n.element.style.width=Object(r.isNullOrUndefined)(n.width)?"auto":n.width;var t=n.element.clientWidth,i=n.element.clientHeight,u=bt(n.element.style.width,t),f=bt(n.element.style.height,i);n.availableSize="0px"===n.width||"0%"===n.width||"0%"===n.height||"0px"===n.height?new d(0,0):new d(bt(n.width,t)||t||u||600,bt(n.height,i)||i||f||(n.isDevice?Math.min(window.innerWidth,window.innerHeight):450))}(n);n.svgObject=n.renderer.createSvg({id:n.element.id+"_svg",width:n.availableSize.width,height:n.availableSize.height});"0px"!==n.width&&"0%"!==n.width&&"0%"!==n.height&&"0px"!==n.height||(n.svgObject.setAttribute("height","0"),n.svgObject.setAttribute("width","0"))}function li(n,t,i){var r=i.getBoundingClientRect(),u=i.ownerDocument.defaultView.pageXOffset,f=i.ownerDocument.defaultView.pageYOffset,e=i.ownerDocument.documentElement.clientTop,o=i.ownerDocument.documentElement.clientLeft,s=r.left+u-o,h=r.top+f-e;return new rt(n-s,t-h)}function ai(n){return n*(Math.PI/180)}function gi(n){return n*(180/Math.PI)}function w(n,t,i,u,f){var a,v,y,s,h,l,p=new d(f.mapAreaRect.width,f.mapAreaRect.height),it=f.baseMapBounds.longitude,rt=f.baseMapBounds.latitude,e=ai(n),c=ai(t),b=f.projectionType,w=f.isTileMap?256*Math.pow(2,1):Object(r.isNullOrUndefined)(i)?Math.min(p.width,p.height):Math.min(p.width,p.height)*i,k,g,nt,tt;if("Normal"===u.geometryType)a=Object(r.isNullOrUndefined)(i)?t:Math.abs((t-it.min)*i),v=Object(r.isNullOrUndefined)(i)?n:Math.abs((rt.max-n)*i);else if("Geographic"===u.geometryType){switch(b){case"Mercator":k=new o(w/2,w/2);a=k.x+t*(w/360);g=function(n,t,i){return Object(r.isNullOrUndefined)(t)||(n=Math.max(n,t)),Object(r.isNullOrUndefined)(i)||(n=Math.min(n,i)),n}(Math.sin(ai(n)),-.9999,.9999);v=k.y+.5*Math.log((1+g)/(1-g))*(-w/(2*Math.PI));break;case"Winkel3":h=((y=nr(c,e)).x+c/(Math.PI/2))/2;s=(y.y+e)/2;break;case"Miller":h=c;s=1.25*Math.log(Math.tan(Math.PI/4+.4*e));break;case"Eckert3":h=2/(l=Math.sqrt(Math.PI*(4+Math.PI)))*c*(1+Math.sqrt(1-4*e*e/(Math.PI*Math.PI)));s=4/l*e;break;case"AitOff":h=(y=nr(c,e)).x;s=y.y;break;case"Eckert5":h=c*(1+Math.cos(e))/Math.sqrt(2+Math.PI);s=2*e/Math.sqrt(2+Math.PI);break;case"Equirectangular":h=c;s=e;break;case"Eckert6":for(l=(1+Math.PI/2)*Math.sin(e),nt=1/0,tt=0;tt<10&&Math.abs(nt)>1e-6;tt++)e-=nt=(e+Math.sin(e)-l)/(1+Math.cos(e));l=Math.sqrt(2+Math.PI);h=c*(1+Math.cos(e))/l;s=2*e/l}a="Mercator"===b?a:tr(function(n,t){var i=n.baseMapBounds.longitude,u=Object(r.isNullOrUndefined)(n.baseSize)?n.mapAreaRect.width:n.mapAreaRect.width+Math.abs(n.baseSize.width-n.mapAreaRect.width)/2;return Math.round(u*(t-i.min)/(i.max-i.min)*100)/100}(f,gi(h)),3);v="Mercator"===b?v:-tr(function(n,t){var i=n.baseMapBounds.latitude;return Math.round(n.mapAreaRect.height*(t-i.min)/(i.max-i.min)*100)/100}(f,gi(s)),3)}return new o(a,v)}function ut(n,t,i,r){var u=256*Math.pow(2,t),s=(n.x+180)/360,f=Math.sin(n.y*Math.PI/180),h=.5-Math.log((1+f)/(1-f))/(4*Math.PI),e=n.x,o=n.y;return r&&(e=s*u+.5+i.x,o=h*u+.5+i.y),{x:e,y:o}}function nr(n,t){var i,r=Math.cos(t),u=function(n){return n/Math.sin(n)}((i=r*Math.cos(n/=2),Math.acos(i)));return new o(2*r*Math.sin(n)*u,Math.sin(t)*u)}function tr(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i}function v(n,t){var i=document.getElementById("mapsmeasuretext");return null===i&&(i=Object(r.createElement)("text",{id:"mapsmeasuretext"}),document.body.appendChild(i)),i.innerHTML=n,i.style.position="absolute",i.style.fontSize="number"==typeof t.size?t.size+"px":t.size,i.style.fontWeight=t.fontWeight,i.style.fontStyle=t.fontStyle,i.style.fontFamily=t.fontFamily,i.style.visibility="hidden",i.style.top="-100",i.style.left="0",i.style.whiteSpace="nowrap",i.style.lineHeight="normal",new d(i.clientWidth,i.clientHeight)}function ht(n,t,i,r,u){var e,c;void 0===u&&(u=!1);var s,o,l={id:n.id,x:n.x,y:n.y,fill:i,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":n.anchor,transform:n.transform,opacity:t.opacity,"dominant-baseline":n.baseLine},a="string"==typeof n.text?n.text:u?n.text[n.text.length-1]:n.text[0],h=new st.SvgRenderer(""),f=h.createText(l,a);if(f.style["user-select"]="none",f.style["font-family"]=t.fontFamily,f.style["font-size"]=t.size,f.style["font-weight"]=t.fontWeight,f.style["font-color"]=t.color,f.style["-moz-user-select"]="none",f.style["-webkit-touch-callout"]="none",f.style["-webkit-user-select"]="none",f.style["-khtml-user-select"]="none",f.style["-ms-user-select"]="none",f.style["-o-user-select"]="none","string"!=typeof n.text&&n.text.length>1)for(e=1,c=n.text.length;e<c;e++)o=v(n.text[e],t).height,s=h.createTSpan({x:n.x,id:n.id,y:n.y+(u?-e*o:e*o)},u?n.text[n.text.length-(e+1)]:n.text[e]),f.appendChild(s);return r.appendChild(f),f}function lt(n,t){return t.format&&!isNaN(Number(n))?t.intl.getNumberFormat({format:t.format,useGrouping:t.useGroupingSeparator})(Number(n)):n}function ur(n,t,i,r){for(var h,e,c,o=""===n?t:n,f=""===n?o.split("${"):o.split("{{:"),u=0;u<f.length;u++)if(f[u].indexOf("}}")>-1&&f[u].indexOf(".")>-1||f[u].indexOf("}")>-1&&f[u].search(".")>-1)for(h=""===n?f[u].split("}"):f[u].split("}}"),e=0;e<h.length;e++)h[e].indexOf(".")>-1&&(c=s(i,h[e]).toString(),o=""===n?o.split("${"+h[e]+"}").join(lt(c,r)):o.replace(new RegExp("{{:"+h[e]+"}}","g"),c));return o}function fr(n,t,i,u,f,e,o){var h,c,l,d,s=f.size,g=f.borderColor,nt=parseFloat(f.borderWidth),tt=parseFloat(f.borderOpacity),a=f.fill,v=f.dashArray,it={color:g,width:nt,opacity:tt},p=f.opacity,w=new b(u,a,nt,g,p,tt,v,""),rt,ut;return"Circle"===n?(rt=(s.width+s.height)/4,ut=new kt(u,a,it,p,i.x,i.y,rt,v),h=o.renderer.drawCircle(ut)):"Rectangle"===n?(c=i.x-s.width/2,l=i.y-s.height/2,d=new k(u,a,it,p,new y(c,l,s.width,s.height),null,null,"",v),h=o.renderer.drawRectangle(d)):"Image"===n?(c=i.x-s.width/2,l=i.y-s.height,Object(r.merge)(w,{href:t,height:s.height,width:s.width,x:c,y:l}),h=o.renderer.drawImage(w)):h=function(n,t,i,r,u,f){var o;switch(t){case"Balloon":o=function(n,t,i,r,u){var o=i.width,s=i.height,f;r.x-=o/2;r.y-=s;t.d="M15,0C8.8,0,3.8,5,3.8,11.2C3.8,17.5,9.4,24.4,15,30c5.6-5.6,11.2-12.5,11.2-18.8C26.2,5,21.2,0,15,0z M15,16c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5S17.8,16,15,16z";var e=n.renderer.drawPath(t),h=i.width/30,c=i.height/30;return e.setAttribute("transform","translate("+r.x+", "+r.y+") scale("+h+", "+c+")"),f=n.renderer.createGroup({id:t.id}),ii(e,f),ii(f,u)}(n,i,r,u,f);break;case"Cross":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" M "+(u.x-r.width/2)+" "+u.y+" L "+(u.x+r.width/2)+" "+u.y;break;case"Diamond":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+u.y+" L "+u.x+" "+(u.y+r.height/2)+" L "+(u.x-r.width/2)+" "+u.y+" Z";break;case"Star":i.d="M "+(u.x+r.width/3)+" "+(u.y-r.height/2)+" L "+(u.x-r.width/2)+" "+(u.y+r.height/6)+" L "+(u.x+r.width/2)+" "+(u.y+r.height/6)+" L "+(u.x-r.width/3)+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" L "+(u.x+r.width/3)+" "+(u.y-r.height/2)+" Z";break;case"Triangle":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+(u.y+r.height/2)+" L "+(u.x-r.width/2)+" "+(u.y+r.height/2)+" Z";break;case"HorizontalLine":i.d=" M "+(u.x-r.width/2)+" "+u.y+" L "+(u.x+r.width/2)+" "+u.y;break;case"VerticalLine":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2);break;case"InvertedTriangle":i.d="M "+(u.x-r.width/2)+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" Z";break;case"Pentagon":for(var s=void 0,h=void 0,e=0;e<5;e++)s=r.width/2*Math.cos(Math.PI/180*72*e),h=r.height/2*Math.sin(Math.PI/180*72*e),i.d+=(0===e?"M ":"L ")+(u.x+s)+" "+(u.y+h);i.d+=" Z"}return"Cross"!==t&&"HorizontalLine"!==t&&"VerticalLine"!==t||(i.stroke="transparent"===i.stroke?i.fill:i.stroke),"Balloon"===t?o:n.renderer.drawPath(i)}(o,n,w,s,i,e),h}function s(n,t){var i,u;if(!Object(r.isNullOrUndefined)(n)&&!Object(r.isNullOrUndefined)(t))if(i=t.replace(/\[/g,".").replace(/\]/g,"").split("."),1===i.length)n=n[i[0]];else for(u=0;u<i.length&&!Object(r.isNullOrUndefined)(n);u++)n=n[i[u]];return n}function dt(n,t){var i=Object(r.isNullOrUndefined)(n.colorValuePath)?t[n.colorValuePath]:n.colorValuePath.indexOf(".")>-1?s(t,n.colorValuePath).toString():t[n.colorValuePath];return n.fill=Object(r.isNullOrUndefined)(n.colorValuePath)||Object(r.isNullOrUndefined)(i)?n.fill:n.colorValuePath.indexOf(".")>-1?s(t,n.colorValuePath).toString():t[n.colorValuePath],n}function gt(n,t){var i,u,f;return Object(r.isNullOrUndefined)(n.shapeValuePath)||Object(r.isNullOrUndefined)(t[n.shapeValuePath])?(i=Object(r.isNullOrUndefined)(n.shapeValuePath)?n.shape:n.shapeValuePath.indexOf(".")>-1?s(t,n.shapeValuePath).toString():n.shape,n.shape=i,u=Object(r.isNullOrUndefined)(n.imageUrlValuePath)?n.imageUrl:n.imageUrlValuePath.indexOf(".")>-1?s(t,n.imageUrlValuePath).toString():n.imageUrl,n.imageUrl=u):(f=n.shapeValuePath.indexOf(".")>-1?s(t,n.shapeValuePath).toString():t[n.shapeValuePath],n.shape=f,"Image"===t[n.shapeValuePath]&&(n.imageUrl=Object(r.isNullOrUndefined)(n.imageUrlValuePath)||Object(r.isNullOrUndefined)(t[n.imageUrlValuePath])?n.imageUrl:n.imageUrlValuePath.indexOf(".")>-1?s(t,n.imageUrlValuePath).toString():t[n.imageUrlValuePath])),n}function ni(n,t,i,u,f,h,c,l){var y,b,lt,at,ot,a,k,st=[],g=[],tt=0,rt=0,vt=n.markerClusterSettings.labelStyle,ct=0,nt=[],ft=n.markerClusterSettings,v=i.renderer.createGroup({id:i.element.id+"_LayerIndex_"+u+"_markerCluster"}),p={cancel:!1,name:se,fill:ft.fill,height:ft.height,width:ft.width,imageUrl:ft.imageUrl,shape:ft.shape,data:void 0,maps:i,cluster:ft,border:ft.border};i.trigger("markerClusterRendering",p,function(){for(var pt,kt,ft,oi,si,hi,ni,bt,ri,yt=0;yt<t.childElementCount;yt++)if(nt=[],"hidden"!==t.childNodes[yt].style.visibility){if(k=t.childNodes[yt],y=k.getBoundingClientRect(),nt.push(yt),!Object(r.isNullOrUndefined)(y)){for(pt=yt+1;pt<t.childElementCount;pt++)"hidden"!==t.childNodes[pt].style.visibility&&(k=t.childNodes[pt],b=k.getBoundingClientRect(),Object(r.isNullOrUndefined)(b)||y.left>b.right||y.right<b.left||y.top>b.bottom||y.bottom<b.top||(st.push(b),t.childNodes[pt].style.visibility="hidden",nt.push(pt)));if(tt=y.left+y.width/2,rt=y.top+y.height,st.length>0){nt=nt.filter(function(n,t,i){return i.indexOf(n)===t});kt=i.element.getBoundingClientRect();tt-=kt.left;rt-=i.availableSize.height<=kt.height?kt.top:kt.bottom-kt.top;var ci=i.isTileMap?{}:et(i,n,!1),ui=i.isTileMap?{x:0,y:0}:0!==i.translatePoint.x?i.translatePoint:ci.location,ti=parseInt(t.childNodes[yt].id.split("_dataIndex_")[1].split("_")[0],10),ii=parseInt(t.childNodes[yt].id.split("_MarkerIndex_")[1].split("_")[0],10),gt=n.markerSettings[ii],wt=gt.dataSource[ti],dt=void 0,fi=Object(r.isNullOrUndefined)(gt.longitudeValuePath)?Object(r.isNullOrUndefined)(wt.longitude)?Object(r.isNullOrUndefined)(wt.Latitude)?0:parseFloat(wt.Latitude):parseFloat(wt.longitude):Number(s(wt,gt.longitudeValuePath)),ei=Object(r.isNullOrUndefined)(gt.latitudeValuePath)?Object(r.isNullOrUndefined)(wt.latitude)?Object(r.isNullOrUndefined)(wt.Latitude)?0:parseFloat(wt.Latitude):parseFloat(wt.latitude):Number(s(wt,gt.latitudeValuePath));i.isTileMap?i.isTileMap&&!i.zoomSettings.enable&&(dt=ut(new o(fi,ei),i.tileZoomLevel,i.tileTranslatePoint,!0)):dt=w(ei,fi,i.mapLayerPanel.calculateFactor(n),n,i);t.childNodes[yt].style.visibility="hidden";ft=n.markerClusterSettings;p.cancel?((a={size:new d(ft.width,ft.height),fill:ft.fill,borderColor:ft.border.color,borderWidth:ft.border.width,opacity:ft.opacity,dashArray:ft.dashArray}).fill=ft.fill,a.size.width=ft.width,a.size.height=ft.height,a.imageUrl=ft.imageUrl,a.shape=ft.shape,a.borderColor=ft.border.color,a.borderWidth=ft.border.width,a.borderOpacity=Object(r.isNullOrUndefined)(ft.border.opacity)?ft.opacity:ft.border.opacity):((a={size:new d(ft.width,ft.height),fill:ft.fill,borderColor:ft.border.color,borderWidth:ft.border.width,opacity:ft.opacity,dashArray:ft.dashArray}).fill=p.fill,a.size.width=p.width,a.size.height=p.height,a.imageUrl=p.imageUrl,a.shape=p.shape,a.borderColor=p.border.color,a.borderWidth=p.border.width,a.borderOpacity=Object(r.isNullOrUndefined)(p.border.opacity)?ft.opacity:p.border.opacity);tt=i.isTileMap||t.id.indexOf("_Markers_Group")>-1?tt:(dt.x+ui.x+p.width)*i.mapScaleValue;rt=i.isTileMap||t.id.indexOf("_Markers_Group")>-1?rt:(dt.y+ui.y+p.height/2)*i.mapScaleValue;i.isTileMap&&!i.zoomSettings.enable&&(tt=dt.x,rt=dt.y);oi=i.element.id+"_LayerIndex_"+u+"_MarkerIndex_"+ii+"_dataIndex_"+ti+"_cluster_"+ct;si=i.element.id+"_LayerIndex_"+u+"_MarkerIndex_"+ii+"_dataIndex_"+ti+"_cluster_"+ct+"_datalabel_"+ct;ct++;hi="Image"===a.shape?a.size.height/2:0;ni=fr(a.shape,a.imageUrl,{x:0,y:hi},oi,a,f,i);ni.setAttribute("transform","translate( "+tt+" "+rt+" )");"Balloon"===p.shape?ni.children[0].innerHTML=nt.toString():ni.innerHTML=nt.toString();lt=new it(si,0,3.75,"middle",(st.length+1).toString(),"","");(at=ht(lt,vt,vt.color,f)).setAttribute("transform","translate( "+tt+" "+rt+" )");v.appendChild(at);v.appendChild(ni)}}st=[]}for(h.appendChild(v),i.svgObject.appendChild(h),i.element.appendChild(i.svgObject),yt=0;yt<v.childElementCount;yt++)if("hidden"!==v.childNodes[yt].style.visibility&&(k=v.childNodes[yt],y=k.getBoundingClientRect(),!(Object(r.isNullOrUndefined)(y)||k.id.indexOf("_datalabel_")>-1))){for(pt=yt+1;pt<v.childElementCount;pt++)"hidden"!==v.childNodes[pt].style.visibility&&(ot=v.childNodes[pt],b=ot.getBoundingClientRect(),Object(r.isNullOrUndefined)(b)||ot.id.indexOf("_datalabel_")>-1||y.left>b.right||y.right<b.left||y.top>b.bottom||y.bottom<b.top||(g.push(ot),g.push(v.childNodes[pt-1]),v.childNodes[pt].style.visibility="hidden",v.childNodes[pt-1].style.visibility="hidden",nt.push(pt)));if(g.length>0)for(k=v.childNodes[yt],bt=0;bt<g.length;bt++)"g"===k.tagName?k.childNodes[0].textContent=k.childNodes[0].textContent+","+g[bt].textContent:k.textContent=k.textContent+","+g[bt].textContent,v.childNodes[yt-1].textContent=(+v.childNodes[yt-1].textContent+ +g[bt+1].textContent).toString(),bt++;g=[]}for(;0<v.childNodes.length;)f.insertBefore(v.childNodes[0],f.firstChild);c||e(i.element.id+"_Secondary_Element").appendChild(f);h.appendChild(f);ri=document.getElementById(i.element.id+"_LayerIndex_0_markerCluster");Object(r.isNullOrUndefined)(ri)||ri.remove();l&&document.getElementById(i.element.id+"_Layer_Collections").appendChild(h)})}function er(n,t){var r=n[0].layerIndex,u=n[0].targetClusterIndex,f=n[0].markerIndex,h=n[0].dataIndex,e=t.element.id+"_LayerIndex_"+r+"_MarkerIndex_"+f,o=e+"_dataIndex_"+h+"_cluster_"+u,l=c(o),v=c(o+"_datalabel_"+u),s,i;for(l.setAttribute("visibility","visible"),v.setAttribute("visibility","visible"),s=n[0].data.length,i=0;i<s;i++)c(e+"_dataIndex_"+n[0].data[i].index).style.visibility="hidden";a(t.element.id+"_LayerIndex_"+r+"_MarkerIndex_"+f+"_markerClusterConnectorLine")}function or(n,t,i,r){var s=n[0].layerIndex,b=n[0].markerIndex,et=n[0].targetClusterIndex,it=n[0].dataIndex,h=r?c:i.querySelector.bind(i),k=r?"":"#",d=t.element.id+"_LayerIndex_"+s+"_MarkerIndex_"+b,ot=d+"_dataIndex_"+it+"_cluster_"+et,rt=h(k+""+ot),yt=h(k+""+ot+"_datalabel_"+et),e,o,w,vt,ft;rt.setAttribute("visibility","hidden");yt.setAttribute("visibility","hidden");var st=t.layers[s].markerSettings[b],u=h(k+""+d+"_dataIndex_"+it),l=u.parentElement.id.indexOf("Template_Group")>-1?u.getBoundingClientRect().height:st.height,a=u.parentElement.id.indexOf("Template_Group")>-1?u.getBoundingClientRect().width:st.width,ht=+rt.getAttribute("transform").split("translate(")[1].trim().split(" ")[0],ct=+rt.getAttribute("transform").split("translate(")[1].trim().split(" ")[1].split(")")[0].trim(),g=a+5,v=6.28*g,ut=0,f=Math.round(v/a);ut+=f;for(var nt=n[0].data.length,y=Math.round(l/v*100),lt=(y=nt<f?100/nt:y)/100*360,p=nt<f?45:0,pt=1,wt="M "+ht+" "+ct+" ",at="",tt=0;tt<nt;tt++){if(ut===tt||Math.round(p)>=360){for(p=0,v=6.28*(g=(a+5)*++pt),f=Math.round(v/l),y=Math.round(l/v*100);y*f<100;)f++;lt=y/100*360;ut+=f}e=ht+g*Math.sin(2*Math.PI*p/360);o=ct+g*Math.cos(2*Math.PI*p/360);at+=wt+"L "+e+" "+o+" ";(u=h(k+""+d+"_dataIndex_"+n[0].data[tt].index)).parentElement.id.indexOf("Template_Group")>-1?(u.style.transform="",u.style.left=t.isTileMap?e-a/2+"px":e-a/2-10+"px",u.style.top=t.isTileMap?o-l/2+"px":o-l/2-10+"px",u.setAttribute("transform","translate( "+e+" "+o+")")):u.setAttribute("transform","translate( "+e+" "+o+")");u.style.visibility="visible";p+=lt}w=t.layers[s].markerClusterSettings.connectorLineSettings;vt={d:at,id:t.element.id+"_LayerIndex_"+s+"_MarkerIndex_"+b+"_dataIndex_"+it+"_markerClusterConnectorLine",stroke:w.color,"fill-opacity":w.opacity,"stroke-opacity":w.opacity,"stroke-width":w.width};i=r?h(t.element.id+"_Markers_Group"):i;ft=t.renderer.createGroup({id:t.element.id+"_LayerIndex_"+s+"_MarkerIndex_"+b+"_markerClusterConnectorLine"});ft.appendChild(t.renderer.drawPath(vt));i.insertBefore(ft,i.querySelector("#"+d+"_dataIndex_0"))}function sr(n,t,i,u,f,e,s,h,c,l,a){var k={size:new d(n.width,n.height),fill:n.fill,borderColor:n.border.color,borderWidth:n.border.width,opacity:t.opacity,dashArray:t.dashArray,borderOpacity:Object(r.isNullOrUndefined)(n.border.opacity)?t.opacity:n.border.opacity},v=fr(n.shape,n.imageUrl,{x:0,y:0},s,k,a,l),y=(l.isTileMap?f.x:(f.x+e.x)*c)+h.x,p=(l.isTileMap?f.y:(f.y+e.y)*c)+h.y,w,b;return v.setAttribute("transform","translate( "+y+" "+p+" )"),ti(l.selectedMarkerElementId,l.markerSelectionClass,v,"MarkerselectionMapStyle"),a.appendChild(v),w=i.length-1===u?"marker":null,b=new o(y,p),t.animationDuration>0&&yr(v,t.animationDelay,t.animationDuration,b,l,w),a}function hr(n,t,i,u,f,o,s,h,c,l,a){var v,w,p,y;if((t=ui(n.template))&&t(u,a,n.template,a.element.id+"_MarkerTemplate"+f,!1).length){for(v=function(n,t,i,u,f){for(var s=Object(r.createElement)("div",{id:t,styles:"position: absolute;pointer-events: auto;"}),c=n.length;c>0;)s.appendChild(n[0]),c--;for(var h=s.innerHTML,o=Object.keys(i),e=0;e<o.length;e++)"object"==typeof i[o[e]]?h=ur(h,"",i,f):"latitude"!==o[e].toLowerCase()&&"longitude"!==o[e].toLowerCase()&&(h=h.replace(new RegExp("{{:"+o[e]+"}}","g"),i[o[e].toString()]));return s.innerHTML=h,s}(t(u,a,n.template,a.element.id+"_MarkerTemplate"+f,!1),i,u,0,a),w=0;w<v.children.length;w++)v.children[w].style.pointerEvents="none";(v.style.left=(a.isTileMap?s.x:(s.x+h.x)*c)+l.x-a.mapAreaRect.x+"px",v.style.top=(a.isTileMap?s.y:(s.y+h.y)*c)+l.y-a.mapAreaRect.y+"px",o.appendChild(v),"GoogleStaticMap"===a.layers[a.baseLayerIndex].layerType)&&(p=e(a.element.id+"_StaticGoogleMap").getBoundingClientRect(),y=v.getBoundingClientRect(),(p.x>y.x||p.x+640<y.x+y.width)&&(p.y>y.y||p.y+p.height<y.y+y.height)&&(v.style.display="none"))}return o}function ti(n,t,i,u){if(n)for(var f=0;f<n.length;f++)i.getAttribute("id")===n[f]&&((Object(r.isNullOrUndefined)(c(t.id))||0===f)&&(document.body.appendChild(t),i.id.indexOf("_MarkerIndex_")>-1&&i.childElementCount>0&&i.children[0].setAttribute("class",u)),i.setAttribute("class",u))}function ii(n,t){return t&&t.appendChild(n),n}function ct(n,t,i,u){var f,o,e;if(!Object(r.isNullOrUndefined)(t))for(f=0;f<n.length;f++)if(o=i.indexOf(".")>-1?s(n[f],i):n[f][i],e=ri(o,u,t),(!Object(r.isNullOrUndefined)(o)&&isNaN(t[e])?o.toLowerCase():o)===(!Object(r.isNullOrUndefined)(t[e])&&isNaN(t[e])?t[e].toLowerCase():t[e]))return f;return null}function ri(n,t,i){if(!Object(r.isNullOrUndefined)(n)&&!Object(r.isNullOrUndefined)(i)&&!Object(r.isNullOrUndefined)(t))for(var f="[object Array]"===Object.prototype.toString.call(t)?t:[t],u=0;u<f.length;u++)if((Object(r.isNullOrUndefined)(n)?n:n.toLowerCase())===(!Object(r.isNullOrUndefined)(i[f[u]])&&isNaN(i[f[u]])?i[f[u]].toLowerCase():i[f[u]]))return f[u];return null}function vi(n,t){var i;if(!n.length)return null;for(var c,l,e,o,y=n.length,p=0,r=0,u=0,f=0;f<=y-1;f++)c=n[f].x,l="Mercator"===t?n[f].y:-n[f].y,f===y-1?(e=n[0].x,o="Mercator"===t?n[0].y:-n[0].y):(e=n[f+1].x,o="Mercator"===t?n[f+1].y:-n[f+1].y),p+=Math.abs(c*o-e*l),r+=Math.abs((c+e)*(c*o-e*l)),u+=Math.abs((l+o)*(c*o-e*l));r*=1/(4*(p*=.5));u*=1/(4*p);var w={x:0,y:0},a={x:0,y:0},b={x:0,y:0},v={x:0,y:0},k={x:0,y:0},s={x:0,y:0},d={x:0,y:0},h={x:0,y:0},g=0;for(f=0;f<=y-1;f++)i=n[f],i.y="Mercator"===t?i.y:-i.y,i.y>u?i.x<r&&r-i.x<r-k.x?k={x:i.x,y:i.y}:i.x>r&&(0===s.x||i.x-r<s.x-r)&&(s={x:i.x,y:i.y}):i.x<r&&r-i.x<r-d.x?d={x:i.x,y:i.y}:i.x>r&&(0===h.x||i.x-r<h.x-r)&&(h={x:i.x,y:i.y}),g=s.y-h.y+(s.y-h.y)/4,i.x>r?i.y<u&&u-i.y<u-w.y?w={x:i.x,y:i.y}:i.y>u&&(0===a.y||i.y-u<a.y-u)&&(a={x:i.x,y:i.y}):i.y<u&&u-i.y<u-b.y?b={x:i.x,y:i.y}:i.y>u&&(0===v.y||i.y-u<v.y-u)&&(v={x:i.x,y:i.y});return{x:r,y:u,rightMin:w,rightMax:a,leftMin:b,leftMax:v,points:n,topMax:h,topMin:d,bottomMax:s,bottomMin:k,height:g}}function cr(n){var t=!1;return"[object Array]"===Object.prototype.toString.call(n)&&Array.prototype.forEach.call(n,function(n){Object(r.isNullOrUndefined)(n.geometry)||"Path"!==n.geometry.type||(t=!0)}),t}function nt(n,t,i){var r=t,f=v(t,i).width,u;if(f>n)for(u=t.length-1;u>=0;--u)if((f=v(r=t.substring(0,u)+"...",i).width)<=n||r.length<4)return r.length<4&&(r=" "),r;return r}function a(n){var t=document.getElementById(n);return t?Object(r.remove)(t):null}function lr(n,t){var i=w(n.minLatOfGivenLocation,n.minLongOfGivenLocation,n.mapLayerPanel.calculateFactor(t),t,n),r=w(n.maxLatOfGivenLocation,n.maxLongOfGivenLocation,n.mapLayerPanel.calculateFactor(t),t,n),u=(i.x+r.x)/2,f=(i.y+r.y)/2;return new o(u,f)}function et(n,t,i){var f,v=n.zoomSettings.zoomFactor,p=n.centerPosition,b=p.latitude,k=p.longitude,d=!Object(r.isNullOrUndefined)(n.centerLatOfGivenLocation)&&!Object(r.isNullOrUndefined)(n.centerLongOfGivenLocation)&&n.zoomNotApplied,et,y,tt,it,ot;Object(r.isNullOrUndefined)(n.mapScaleValue)&&(n.mapScaleValue=v);n.zoomSettings.shouldZoomInitially&&n.zoomSettings.enable&&(n.mapScaleValue=f=v=(n.zoomSettings.shouldZoomInitially||n.enablePersistence)&&1===n.scale?n.scale:Object(r.isNullOrUndefined)(n.markerZoomFactor)?1:n.markerZoomFactor,n.mapScaleValue===n.markerZoomFactor||n.enablePersistence||(n.mapScaleValue=v=n.markerZoomFactor),Object(r.isNullOrUndefined)(n.markerCenterLatitude)||Object(r.isNullOrUndefined)(n.markerCenterLongitude)||(b=n.markerCenterLatitude,k=n.markerCenterLongitude));d&&(n.mapScaleValue=f=v=n.scaleOfGivenLocation);var l=n.baseMapRectBounds.min,rt=n.baseMapRectBounds.max,ut=i?1:n.mapScaleValue;Object(r.isNullOrUndefined)(n.currentShapeDataLength)&&(n.currentShapeDataLength=Object(r.isNullOrUndefined)(t.shapeData.features)?t.shapeData.geometries.length:t.shapeData.features.length);var h,c,u=n.totalRect&&n.legendSettings.visible?n.totalRect:n.mapAreaRect,ct=n.availableSize,e=Math.abs(rt.x-l.x),s=Math.abs(l.y-rt.y),ft=i?1:1===n.markerZoomFactor?n.mapScaleValue:v;if(p=n.zoomSettings.shouldZoomInitially&&n.markerZoomedState&&!n.zoomPersistence?n.markerZoomCenterPoint:n.centerPosition,(Object(r.isNullOrUndefined)(k)||Object(r.isNullOrUndefined)(b))&&!d)if(Object(r.isNullOrUndefined)(n.previousProjection)||n.previousProjection!==n.projectionType)e*=f=parseFloat(Math.min(u.width/e,u.height/s).toFixed(2)),s*=f,et=0!==l.x&&"layers"===n.translateType?ct.width-u.width:0,h=u.x+(-l.x+(u.width/2-e/2))-et,c=u.y+(-l.y+(u.height/2-s/2)),n.previousTranslate=new o(h,c);else if(n.zoomSettings.shouldZoomInitially||1!==n.markerZoomFactor||1!==n.mapScaleValue)if(f=n.mapScaleValue<1?n.mapScaleValue+1:n.mapScaleValue,n.mapScaleValue=n.zoomSettings.enable&&1!==n.mapScaleValue?n.mapScaleValue:1,n.currentShapeDataLength!==(Object(r.isNullOrUndefined)(t.shapeData.features)?t.shapeData.geometries.length:t.shapeData.features.length)&&"SubLayer"!==t.type)y=parseFloat(Math.min(u.height/s,u.width/e).toFixed(2)),s*=y,e*=y,c=u.y+(-l.y+(u.height/2-s/2)),f=y,h=u.x+(-l.x+(u.width/2-e/2));else if(n.availableSize.height!==n.heightBeforeRefresh||n.widthBeforeRefresh!==n.availableSize.width){tt=parseFloat(Math.min(u.width/e,u.height/s).toFixed(2));it=e;it*=tt;ot=s*tt;var st=u.x+(-l.x+(u.width/2-it/2)),ht=u.y+(-l.y+(u.height/2-ot/2)),lt=(n.translatePoint.x-n.previousTranslate.x)/n.widthBeforeRefresh,at=(n.translatePoint.y-n.previousTranslate.y)/n.heightBeforeRefresh;h=st+lt*n.availableSize.width;c=ht+at*n.availableSize.height;n.previousTranslate=new o(st,ht);n.zoomTranslatePoint.x=h;n.zoomTranslatePoint.y=c}else Object(r.isNullOrUndefined)(n.previousProjection)||1!==n.mapScaleValue||n.zoomModule.isDragZoom?(h=n.zoomTranslatePoint.x,c=n.zoomTranslatePoint.y,f=n.scale):(e*=f=parseFloat(Math.min(u.width/e,u.height/s).toFixed(2)),h=u.x+(-l.x+(u.width/2-e/2)),s*=f,c=u.y+(-l.y+(u.height/2-s/2)));else s*=f=parseFloat(Math.min(u.width/e,u.height/s).toFixed(2)),e*=f,c=u.y+(-l.y+(u.height/2-s/2)),h=u.x+(-l.x+(u.width/2-e/2));else{var g=((e+Math.abs(n.mapAreaRect.width-e))/2+n.mapAreaRect.x)/ft,nt=((s+Math.abs(n.mapAreaRect.height-s))/2+n.mapAreaRect.y)/ft,a=d?lr(n,t):w(b,k,n.mapLayerPanel.calculateFactor(t),t,n);Object(r.isNullOrUndefined)(n.previousProjection)||n.previousProjection!==n.projectionType?(h=-a.x+g,c=-a.y+nt,f=ut):(1!==Math.floor(n.scale)&&n.zoomSettings.shouldZoomInitially||n.zoomNotApplied?(h=-a.x+g,c=-a.y+nt):n.zoomSettings.shouldZoomInitially||n.zoomNotApplied?(h=-a.x+g,c=-a.y+nt,f=ut):(h=n.zoomTranslatePoint.x,c=n.zoomTranslatePoint.y),f=n.mapScaleValue)}return Object(r.isNullOrUndefined)(n.translatePoint)||(h=n.enablePersistence&&0!==n.translatePoint.x&&!n.zoomNotApplied?n.translatePoint.x:h,c=n.enablePersistence&&0!==n.translatePoint.y&&!n.zoomNotApplied?n.translatePoint.y:c),f=n.enablePersistence?n.mapScaleValue>=1?n.mapScaleValue:1:f,n.widthBeforeRefresh=n.availableSize.width,n.heightBeforeRefresh=n.availableSize.height,{scale:f,location:new o(h,c)}}function at(n,t,i){var f,e=n.zoomSettings.zoomFactor,et=n.centerPosition,g=et.latitude,nt=et.longitude,tt=!Object(r.isNullOrUndefined)(n.centerLongOfGivenLocation)&&!Object(r.isNullOrUndefined)(n.centerLatOfGivenLocation)&&n.zoomNotApplied,v,p,ft,y,d,u;Object(r.isNullOrUndefined)(n.previousCenterLatitude)&&Object(r.isNullOrUndefined)(n.previousCenterLongitude)?(n.previousCenterLatitude=n.centerPosition.latitude,n.previousCenterLongitude=n.centerPosition.longitude):n.previousCenterLatitude!==n.centerPosition.latitude&&n.previousCenterLongitude!==n.centerPosition.longitude?(n.centerPositionChanged=!0,n.previousCenterLatitude=n.centerPosition.latitude,n.previousCenterLongitude=n.centerPosition.longitude):n.centerPositionChanged=!1;(Object(r.isNullOrUndefined)(n.mapScaleValue)||e>n.mapScaleValue)&&(n.mapScaleValue=n.isReset&&1===n.mapScaleValue?n.mapScaleValue:e);n.mapScaleValue=1!==n.zoomSettings.zoomFactor&&n.zoomSettings.zoomFactor===n.mapScaleValue||n.zoomSettings.zoomFactor===n.mapScaleValue||n.centerPositionChanged?n.zoomSettings.zoomFactor:n.mapScaleValue;n.zoomSettings.shouldZoomInitially&&(n.mapScaleValue=e=f=(n.enablePersistence||n.zoomSettings.shouldZoomInitially)&&1===n.scale?n.scale:Object(r.isNullOrUndefined)(n.markerZoomFactor)?n.mapScaleValue:n.markerZoomFactor,e=n.mapScaleValue,Object(r.isNullOrUndefined)(n.markerCenterLatitude)||Object(r.isNullOrUndefined)(n.markerCenterLongitude)||(g=n.markerCenterLatitude,nt=n.markerCenterLongitude));tt&&(n.mapScaleValue=f=e=n.scaleOfGivenLocation);var h,c,it=i?1:n.mapScaleValue,s=n.mapAreaRect,b=n.baseMapRectBounds.min,ot=n.baseMapRectBounds.max,st=i?1:n.mapScaleValue,rt=Math.abs(ot.x-b.x),ut=Math.abs(b.y-ot.y);if((Object(r.isNullOrUndefined)(nt)||Object(r.isNullOrUndefined)(g))&&!tt){if(v=0===n.zoomSettings.zoomFactor?1:n.zoomSettings.zoomFactor,p=n.zoomSettings.maxZoom,f=v=v>p?p:v,ft=0===n.mapScaleValue?1:n.mapScaleValue>p?p:n.mapScaleValue,a=s.x+(-b.x+(s.width/2-rt/2)),l=s.y+(-b.y+(s.height/2-ut/2)),!Object(r.isNullOrUndefined)(n.zoomTranslatePoint)||!Object(r.isNullOrUndefined)(n.previousProjection))if(n.previousProjection!==n.projectionType){for(y=[],d={x:a,y:l},y.push(d),u=1;u<p;u++)d={x:y[u-1].x-(s.width/u-s.width/(u+1))/2,y:y[u-1].y-(s.height/u-s.height/(u+1))/2},y.push(d);a=y[v-1].x;l=y[v-1].y}else a=n.zoomTranslatePoint.x,l=n.zoomTranslatePoint.y,v!==ft&&(f=ft);Object(r.isNullOrUndefined)(n.translatePoint)||(h=n.enablePersistence&&0!==n.translatePoint.x&&!n.zoomNotApplied?n.translatePoint.x:a,c=n.enablePersistence&&0!==n.translatePoint.y&&!n.zoomNotApplied?n.translatePoint.y:l)}else{var l=(ut+Math.abs(n.mapAreaRect.height-ut))/2/st,a=(rt+Math.abs(n.mapAreaRect.width-rt))/2/st,k=tt?lr(n,t):w(g,nt,n.mapLayerPanel.calculateFactor(t),t,n);Object(r.isNullOrUndefined)(n.zoomTranslatePoint)&&Object(r.isNullOrUndefined)(n.previousProjection)||n.zoomNotApplied?(h=-k.x+a+n.mapAreaRect.x/it,c=-k.y+l+n.mapAreaRect.y/it):n.previousProjection!==n.projectionType?(h=-k.x+a,c=-k.y+l):(h=n.zoomTranslatePoint.x,c=n.zoomTranslatePoint.y,e=it);Object(r.isNullOrUndefined)(n.translatePoint)||(c=n.enablePersistence&&0!==n.translatePoint.y&&!n.zoomNotApplied?n.translatePoint.y:c,h=n.enablePersistence&&0!==n.translatePoint.x&&!n.zoomNotApplied?n.translatePoint.x:h);f=0!==e?e:1}return f=n.enablePersistence?0===n.mapScaleValue?1:n.mapScaleValue:f,{scale:i?1:f,location:new o(h,c)}}function e(n){return document.getElementById(n)}function ar(n,t){return n.formatFunction=n.intl.getNumberFormat({format:n.format,useGrouping:n.useGroupingSeparator}),n.formatFunction(t)}function ui(n){var t=null;try{document.querySelectorAll(n).length&&(t=Object(r.compile)(document.querySelector(n).innerHTML.trim()))}catch(i){t=Object(r.compile)(n)}return t}function c(n){return document.getElementById(n)}function ef(n,t,i,u){var e=function(n,t){var r,f=parseInt(n.split("_LayerIndex_")[1].split("_")[0],10),e=parseInt(n.split("_shapeIndex_")[1].split("_")[0],10),i=t.layersCollection[f],u=i.layerData[e].property;return i.dataSource&&(r=i.dataSource[ct(i.dataSource,u,i.shapeDataPath,i.shapePropertyPath)]),{shapeData:u,data:r}}(n,i),o={color:t.border.color,opacity:t.border.opacity,width:t.border.width},f=t.enableMultiSelect?{cancel:!1,name:u,fill:t.fill,opacity:t.opacity,border:o,shapeData:e.shapeData,data:e.data,target:n,maps:i,shapeDataCollection:i.shapeSelectionItem}:{cancel:!1,name:u,fill:t.fill,opacity:t.opacity,border:o,shapeData:e.shapeData,data:e.data,target:n,maps:i};return i.trigger(u,f,function(){f.border.opacity=Object(r.isNullOrUndefined)(f.border.opacity)?f.opacity:f.border.opacity}),f}function fi(n){return document.getElementsByClassName(n)}function h(n,t){var i=null;return document.getElementById(t)&&(i=document.getElementById(t).querySelector("#"+n)),i}function vr(n,t,i,r){for(var f,e=r.layers[n].shapeData.features,u=0;u<e.length;u++)if(e[u].properties.name===t){f=r.element.id+"_LayerIndex_"+n+"_shapeIndex_"+u+"_dataIndex_undefined";break}return c(f)}function ei(n,t,i){return Object(r.createElement)("style",{id:n,innerHTML:"."+t+"{fill:"+i.fill+";fill-opacity:"+i.opacity.toString()+";stroke-opacity:"+i.border.opacity.toString()+";stroke-width:"+i.border.width.toString()+";stroke:"+i.border.color+";}"})}function vt(n,t,i){var u=c(n);Object(r.isNullOrUndefined)(u)||(u.innerHTML="."+t+"{fill:"+i.fill+";fill-opacity:"+i.opacity.toString()+";stroke-width:"+i.border.width.toString()+";stroke-opacity:"+i.border.opacity.toString()+";stroke:"+i.border.color+"}")}function of(n,t,i,u,f){var o={color:n.border.color,width:n.border.width/t.scale,opacity:n.border.opacity},e={opacity:n.opacity,fill:n.fill,border:o,name:bu,target:i.id,cancel:!1,shapeData:u,data:f,maps:t};t.trigger("itemSelection",e,function(){e.border.opacity=Object(r.isNullOrUndefined)(n.border.opacity)?n.opacity:n.border.opacity;t.shapeSelectionItem.push(e.shapeData);c("ShapeselectionMap")?vt("ShapeselectionMap","ShapeselectionMapStyle",e):document.body.appendChild(ei("ShapeselectionMap","ShapeselectionMapStyle",e))})}function p(n){n.removeAttribute("class")}function yr(n,t,i,u,f,e,o){void 0===o&&(o=0);var h=u.x,c=u.y,s=0,l=n.getAttribute("transform")||"";new r.Animation({}).animate(n,{duration:i,delay:t,progress:function(t){t.timeStamp>t.delay&&(s=(t.timeStamp-t.delay)/t.duration,n.setAttribute("transform","translate( "+(h-o*s)+" "+(c-o*s)+" ) scale("+s+")"))},end:function(){if(n.setAttribute("transform",l),e){var t={cancel:!1,name:wu,element:e,maps:f};f.trigger(wu,t)}}})}function sf(n){a(n)}function yi(n,t,i,u,f,e,o,s,h){var b=li(i,u,s),w;Object(r.isNullOrUndefined)(b)||(i=b.x,u=b.y);for(var l=document.getElementById(o),c=v(n,{fontFamily:"Segoe UI",size:"8px",fontStyle:"Normal",fontWeight:"Regular"}).width,a=n.split(" "),y=a[0].length,p=1;p<a.length;p++)y<a[p].length&&(y=a[p].length);l||(l=Object(r.createElement)("div",{id:o,styles:'background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(0, 0, 0); padding-left:5px;font-size:12px; font-family: "Segoe UI"; text-align:center'}));i<f-c?i=i:i>f-c&&i<f-8*y?c=f-i:i>=f-8*y&&(i>c?i-=c:(c=i,i=0));w=t.split("px");pr(l,n,i,u,w,c,f,s);l.clientHeight+2*parseInt(w[0],10)>e&&(c=i,i=0);pr(l,n,i,u,w,c,f,s);h&&setTimeout(sf,5e3,o)}function pr(n,t,i,r,u,f,e,o){n.innerHTML=t;n.style.top=-1!==n.id.indexOf("_Legend")?(parseInt(u[0],10)+r).toString()+"px":(2*parseInt(u[0],10)).toString()+"px";n.style.left=i.toString()+"px";n.style.width=f.toString()+"px";n.style.maxWidth=e.toString()+"px";n.style.wordWrap="break-word";o.appendChild(n)}function hf(n,t,i,u,f){var o=new st.SvgRenderer(""),e=function(n,t,i,u,f){var s,v="Path",c=t.width,o=t.height,h=n.x,e=n.y,l=n.x+-c/2,w=n.y+-o/2;switch(i){case"Circle":case"Bubble":v="Ellipse";Object(r.merge)(u,{rx:c/2,ry:o/2,cx:h,cy:e});break;case"VerticalLine":s="M "+h+" "+(e+o/2)+" L "+h+" "+(e+-o/2);Object(r.merge)(u,{d:s});break;case"Diamond":s="M "+l+" "+e+" L "+h+" "+(e+-o/2)+" L "+(h+c/2)+" "+e+" L "+h+" "+(e+o/2)+" L "+l+" "+e+" z";Object(r.merge)(u,{d:s});break;case"Rectangle":s="M "+l+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+o/2)+" L "+l+" "+(e+o/2)+" L "+l+" "+(e+-o/2)+" z";Object(r.merge)(u,{d:s});break;case"Triangle":s="M "+l+" "+(e+o/2)+" L "+h+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+o/2)+" L "+l+" "+(e+o/2)+" z";Object(r.merge)(u,{d:s});break;case"InvertedTriangle":s="M "+(h+c/2)+" "+(e-o/2)+" L "+h+" "+(e+o/2)+" L "+(h-c/2)+" "+(e-o/2)+" L "+(h+c/2)+" "+(e-o/2)+" z";Object(r.merge)(u,{d:s});break;case"Pentagon":for(var y=void 0,p=void 0,a=0;a<=5;a++)y=c/2*Math.cos(Math.PI/180*72*a),p=c/2*Math.sin(Math.PI/180*72*a),s=0===a?"M "+(h+y)+" "+(e+p)+" ":s.concat("L "+(h+y)+" "+(e+p)+" ");s=s.concat("Z");Object(r.merge)(u,{d:s});break;case"Star":s="M "+(n.x+t.width/3)+" "+(n.y-t.height/2)+" L "+(n.x-t.width/2)+" "+(n.y+t.height/6)+" L "+(n.x+t.width/2)+" "+(n.y+t.height/6)+" L "+(n.x-t.width/3)+" "+(n.y-t.height/2)+" L "+n.x+" "+(n.y+t.height/2)+" L "+(n.x+t.width/3)+" "+(n.y-t.height/2)+" Z";Object(r.merge)(u,{d:s});break;case"Cross":s="M "+l+" "+e+" L "+(h+c/2)+" "+e+" M "+h+" "+(e+o/2)+" L "+h+" "+(e+-o/2);Object(r.merge)(u,{d:s});break;case"Image":v="Image";Object(r.merge)(u,{href:f,height:o,width:c,x:l,y:w})}return{renderOption:u,functionName:v}}(n,i,t,f,u);return o["draw"+e.functionName](e.renderOption)}function wr(n,t,i,r){for(var f,u=0;u<n.childElementCount;u++)if((f=n.childNodes[u]).id.indexOf("_NavigationGroup")>-1)cf(f,t,i,r);else{var e=void 0,o=0,s=r.layersCollection[t].shapeSettings.borderWidthValuePath;r.layersCollection[t].shapeSettings.borderWidthValuePath?null!==(o=ct(r.layersCollection[t].dataSource,r.layersCollection[t].layerData[u].property,r.layersCollection[t].shapeDataPath,r.layersCollection[t].shapePropertyPath,r.layersCollection[t]))&&(e=r.layersCollection[t].dataSource[o][s]?r.layersCollection[t].dataSource[o][s]:r.layersCollection[t].shapeSettings.border.width):e=r.layersCollection[t].shapeSettings.border.width;f.setAttribute("stroke-width",(e/i).toString())}}function cf(n,t,i,r){for(var f,e,u=0;u<n.childElementCount;u++)"path"===(f=n.childNodes[u]).tagName&&(e=r.layersCollection[t].navigationLineSettings[parseFloat(f.id.split("_NavigationIndex_")[1].split("_")[0])].width,f.setAttribute("stroke-width",(e/i).toString()))}function br(n){for(var r=[],i=n.touches,t=0;t<i.length;t++)r.push({pageX:i[t].pageX,pageY:i[t].pageY});return r}function kr(n,t){var i=n.pageX-t.pageX,r=n.pageY-t.pageY;return Math.sqrt(i*i+r*r)}function dr(n,t){return n+t}function gr(n,t,i,r,u){var e,o=this,f=null,s=function(t){f||(f=t);var h=t-f;h<i?(r.call(o,{element:n,delay:0,timeStamp:h,duration:i}),window.requestAnimationFrame(s)):(window.cancelAnimationFrame(e),u.call(o,{element:n}),n.setAttribute("style","visibility:visible"))};e=window.requestAnimationFrame(s)}function wi(n,t,i,r){var o=0,u=n.getAttribute("transform").split(" ");2===u.length&&(u[2]=u[1].split(")")[0],u[1]=u[0].split("(")[1]);var f=new rt(parseInt(u[1],10),parseInt(u[2],10)),s=r.x-f.x,h=r.y-f.y,e=new rt(0,0);gr(n,0,i,function(n){n.timeStamp>n.delay&&(o=(n.timeStamp-n.delay)/n.duration,e.x=f.x+o*s,e.y=f.y+o*h,n.element.setAttribute("transform","translate( "+e.x+" "+e.y+" )"))},function(){n.setAttribute("transform","translate( "+r.x+" "+r.y+" )")})}function uu(n,t){var u=Object(r.isNullOrUndefined)(t.shouldZoomPreviousFactor)?null:t.shouldZoomPreviousFactor,i=Object(r.isNullOrUndefined)(t.shouldZoomCurrentFactor)?null:t.shouldZoomCurrentFactor;Object(r.isNullOrUndefined)(i)?!Object(r.isNullOrUndefined)(u)&&Object(r.isNullOrUndefined)(i)&&t.shouldZoomPreviousFactor!==n?t.shouldZoomCurrentFactor=n:t.shouldZoomPreviousFactor=n:(t.shouldZoomCurrentFactor=null,t.shouldZoomPreviousFactor=null)}function fu(n,t,i,r,u,f,e){var o,h,y=e.zoomSettings.maxZoom,c=Math.sin(t*Math.PI/180),p=Math.log((1+c)/(1-c))/2,b=Math.max(Math.min(p,Math.PI),-Math.PI)/2,l=Math.sin(n*Math.PI/180),k=Math.log((1+l)/(1-l))/2,d=Math.max(Math.min(k,Math.PI),-Math.PI)/2,a,v;e.zoomNotApplied&&!e.isTileMap&&(a=Math.abs((e.baseMapBounds.latitude.max-e.baseMapBounds.latitude.min)/(t-n)),v=Math.abs((e.baseMapBounds.longitude.max-e.baseMapBounds.longitude.min)/(r-i)),h=Math.min(a,v),w(n,i,1,e.layersCollection[0],e),w(t,r,1,e.layersCollection[0],e));var g=(b-d)/Math.PI,s=r-i,nt=(s<0?s+360:s)/360,tt=Math.log(f/256/g)/Math.LN2,it=Math.log(u/256/nt)/Math.LN2,rt=e.zoomNotApplied&&!e.isTileMap?h:Math.min(tt,it);return o=Math.min(rt,y),o=e.isTileMap||!e.zoomNotApplied?Math.floor(o):o,e.isTileMap||uu(o,e),o}function pt(n){var i,t=Object(r.isNullOrUndefined)(n.result)?n.actual:n.result;return Object(r.isNullOrUndefined)(t.length)?Object(r.isNullOrUndefined)(t.Items)||(i=t.Items):i=t,i}var yt,nu,tu,iu,ru,pi,hi,tf;i.r(t);var ci,di=i(4),r=i(0),st=i(2),wt=(ci=function(n,t){return(ci=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ci(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),d=function(){return function(n,t){this.width=n;this.height=t}}();var o=function(){return function(n,t){this.x=n;this.y=t}}(),ir=function(){return function(n,t){this.min=n;this.max=t}}(),rr=function(){return function(n,t){this.latitude=new ir(n.min,n.max);this.longitude=new ir(t.min,t.max)}}();var it=function(){return function(n,t,i,r,u,f,e){void 0===f&&(f="");this.transform="";this.baseLine="auto";this.id=n;this.text=u;this.transform=f;this.anchor=r;this.x=t;this.y=i;this.baseLine=e}}(),b=function(){return function(n,t,i,r,u,f,e,o){this.id=n;this["fill-opacity"]=u;this["stroke-opacity"]=f;this.fill=t;this.stroke=r;this["stroke-width"]=i;this["stroke-dasharray"]=e;this.d=o}}(),uf=function(){return function(n,t,i){this.r=n;this.g=t;this.b=i}}(),k=function(n){function t(t,i,r,u,f,e,o,s,h){var c=n.call(this,t,i,r.width,r.color,u,r.opacity)||this;return c.y=f.y,c.x=f.x,c.height=f.height,c.width=f.width,c.rx=e||0,c.ry=o||0,c.transform=s||"",c["stroke-dasharray"]=h,c["fill-opacity"]=u,c["stroke-opacity"]=r.opacity,c}return wt(t,n),t}(b),kt=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,i,r.width,r.color,u,r.opacity,s)||this;return h.cy=e,h.cx=f,h.r=o,h["stroke-dasharray"]=s,h["fill-opacity"]=u,h["stroke-opacity"]=r.opacity,h}return wt(t,n),t}(b),ff=function(n){function t(t,i,r,u,f,e,o,s){return void 0===e&&(e=1),void 0===o&&(o=1),void 0===s&&(s=""),n.call(this,t,i,r,u,f,e,o,s)||this}return wt(t,n),t}(function(n){function t(t,i,r,u,f,e,o,s){void 0===e&&(e=1);void 0===o&&(o=1);void 0===s&&(s="");var h=n.call(this,t,r,u,f,e,o,s)||this;return h.points=i,h}return wt(t,n),t}(b)),rt=function(){return function(n,t){this.x=n;this.y=t}}(),y=function(){return function(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r}}();pi=function(){return function(n,t,i,r,u){this.dataOptions=n;this.type=t||"GET";this.async=i||!0;this.contentType=r;this.sendData=u}}();!function(n){n.mapsTitleFont={size:"14px",fontWeight:null,color:"#424242",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:null,color:"#424242",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:null,fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:null,fontStyle:"Regular",fontFamily:"Roboto, Noto, Sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:null,fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"}}(yt||(yt={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Semibold",color:"#424242",fontStyle:"Semibold",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Regular",color:"#424242",fontStyle:"Regular",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#757575",fontStyle:"Regular",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#757575",fontStyle:"Medium",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"}}(nu||(nu={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Semibold",color:"#424242",fontStyle:"Semibold",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Regular",color:"#424242",fontStyle:"Regular",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#757575",fontStyle:"Regular",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#757575",fontStyle:"Medium",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"}}(tu||(tu={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#000000",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto, Noto, Sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"}}(iu||(iu={})),function(n){n.mapsTitleFont={fontFamily:"Roboto, Noto, Sans-serif",fontWeight:"Medium",size:"14px",fontStyle:"Medium",color:"#FFFFFF"};n.mapsSubTitleFont={size:"13px",color:"#FFFFFF",fontWeight:"Medium",fontFamily:"Roboto, Noto, Sans-serif",fontStyle:"Medium"};n.tooltipLabelFont={size:"12px",color:"#282727",fontWeight:"Regular",fontFamily:"Roboto",fontStyle:"Regular"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto, Noto, Sans-serif"};n.legendLabelFont={size:"13px",fontFamily:"Roboto, Noto, Sans-serif",fontWeight:"Medium",color:"#DADADA",fontStyle:"Medium"}}(ru||(ru={}));var l=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},lf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)("")],t.prototype,"content",void 0),u([Object(r.Property)("0px")],t.prototype,"x",void 0),u([Object(r.Property)("0px")],t.prototype,"y",void 0),u([Object(r.Property)("None")],t.prototype,"verticalAlignment",void 0),u([Object(r.Property)("None")],t.prototype,"horizontalAlignment",void 0),u([Object(r.Property)("-1")],t.prototype,"zIndex",void 0),t}(r.ChildProperty),af=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)("Start")],t.prototype,"position",void 0),u([Object(r.Property)("false")],t.prototype,"showArrow",void 0),u([Object(r.Property)(2)],t.prototype,"size",void 0),u([Object(r.Property)("black")],t.prototype,"color",void 0),u([Object(r.Property)(0)],t.prototype,"offSet",void 0),t}(r.ChildProperty),ot=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)("12px")],t.prototype,"size",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),u([Object(r.Property)("Roboto, Noto, Sans-serif")],t.prototype,"fontFamily",void 0),u([Object(r.Property)("Medium")],t.prototype,"fontWeight",void 0),u([Object(r.Property)("Medium")],t.prototype,"fontStyle",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),t}(r.ChildProperty),g=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)("")],t.prototype,"color",void 0),u([Object(r.Property)(0)],t.prototype,"width",void 0),u([Object(r.Property)(null)],t.prototype,"opacity",void 0),t}(r.ChildProperty),vf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(null)],t.prototype,"latitude",void 0),u([Object(r.Property)(null)],t.prototype,"longitude",void 0),t}(r.ChildProperty),bi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(!1)],t.prototype,"visible",void 0),u([Object(r.Property)("")],t.prototype,"template",void 0),u([Object(r.Property)("")],t.prototype,"fill",void 0),u([Object(r.Complex)({color:"transparent",width:1},g)],t.prototype,"border",void 0),u([Object(r.Complex)(yt.tooltipLabelFont,ot)],t.prototype,"textStyle",void 0),u([Object(r.Property)(null)],t.prototype,"format",void 0),u([Object(r.Property)(null)],t.prototype,"valuePath",void 0),t}(r.ChildProperty),yf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(10)],t.prototype,"left",void 0),u([Object(r.Property)(10)],t.prototype,"right",void 0),u([Object(r.Property)(10)],t.prototype,"top",void 0),u([Object(r.Property)(10)],t.prototype,"bottom",void 0),t}(r.ChildProperty),pf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)("#000000")],t.prototype,"color",void 0),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),t}(r.ChildProperty),wf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(!1)],t.prototype,"allowClustering",void 0),u([Object(r.Complex)({color:"transparent",width:1},g)],t.prototype,"border",void 0),u([Object(r.Property)("#D2691E")],t.prototype,"fill",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)("Rectangle")],t.prototype,"shape",void 0),u([Object(r.Property)(12)],t.prototype,"width",void 0),u([Object(r.Property)(12)],t.prototype,"height",void 0),u([Object(r.Property)(new o(0,0))],t.prototype,"offset",void 0),u([Object(r.Property)("")],t.prototype,"imageUrl",void 0),u([Object(r.Property)("")],t.prototype,"dashArray",void 0),u([Object(r.Complex)({},ot)],t.prototype,"labelStyle",void 0),u([Object(r.Property)(!1)],t.prototype,"allowClusterExpand",void 0),u([Object(r.Complex)({},pf)],t.prototype,"connectorLineSettings",void 0),t}(r.ChildProperty),eu=(r.ChildProperty,function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(null)],t.prototype,"from",void 0),u([Object(r.Property)(null)],t.prototype,"to",void 0),u([Object(r.Property)(null)],t.prototype,"value",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),u([Object(r.Property)(null)],t.prototype,"minOpacity",void 0),u([Object(r.Property)(null)],t.prototype,"maxOpacity",void 0),u([Object(r.Property)(null)],t.prototype,"label",void 0),u([Object(r.Property)(!0)],t.prototype,"showLegend",void 0),t}(r.ChildProperty)),bf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(null)],t.prototype,"latitude",void 0),u([Object(r.Property)(null)],t.prototype,"longitude",void 0),t}(r.ChildProperty),kf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(null)],t.prototype,"shapePath",void 0),u([Object(r.Property)(null)],t.prototype,"shapeValue",void 0),t}(r.ChildProperty),oi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(!1)],t.prototype,"enable",void 0),u([Object(r.Property)(null)],t.prototype,"fill",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)(!1)],t.prototype,"enableMultiSelect",void 0),u([Object(r.Complex)({color:"transparent",width:0},g)],t.prototype,"border",void 0),t}(r.ChildProperty),si=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(null)],t.prototype,"fill",void 0),u([Object(r.Property)(!1)],t.prototype,"enable",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Complex)({color:"transparent",width:0},g)],t.prototype,"border",void 0),t}(r.ChildProperty),df=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(!1)],t.prototype,"visible",void 0),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)(null)],t.prototype,"longitude",void 0),u([Object(r.Property)(null)],t.prototype,"latitude",void 0),u([Object(r.Property)("")],t.prototype,"dashArray",void 0),u([Object(r.Property)("black")],t.prototype,"color",void 0),u([Object(r.Property)(0)],t.prototype,"angle",void 0),u([Object(r.Complex)({showArrow:!1,position:"Start",size:5,color:"black"},af)],t.prototype,"arrowSettings",void 0),u([Object(r.Complex)({},oi)],t.prototype,"selectionSettings",void 0),u([Object(r.Complex)({},si)],t.prototype,"highlightSettings",void 0),t}(r.ChildProperty),gf=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Complex)({},g)],t.prototype,"border",void 0),u([Object(r.Property)(!1)],t.prototype,"visible",void 0),u([Object(r.Property)([])],t.prototype,"dataSource",void 0),u([Object(r.Property)()],t.prototype,"query",void 0),u([Object(r.Property)(1e3)],t.prototype,"animationDuration",void 0),u([Object(r.Property)(0)],t.prototype,"animationDelay",void 0),u([Object(r.Property)("")],t.prototype,"fill",void 0),u([Object(r.Property)(10)],t.prototype,"minRadius",void 0),u([Object(r.Property)(20)],t.prototype,"maxRadius",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)(null)],t.prototype,"valuePath",void 0),u([Object(r.Property)("Circle")],t.prototype,"bubbleType",void 0),u([Object(r.Property)(null)],t.prototype,"colorValuePath",void 0),u([Object(r.Collection)([],eu)],t.prototype,"colorMapping",void 0),u([Object(r.Complex)({},bi)],t.prototype,"tooltipSettings",void 0),u([Object(r.Complex)({},oi)],t.prototype,"selectionSettings",void 0),u([Object(r.Complex)({},si)],t.prototype,"highlightSettings",void 0),t}(r.ChildProperty),ki=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)("")],t.prototype,"text",void 0),u([Object(r.Property)("")],t.prototype,"description",void 0),t}(r.ChildProperty),ne=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Complex)({size:yt.mapsSubTitleFont.size,fontWeight:null},ot)],t.prototype,"textStyle",void 0),u([Object(r.Property)("Center")],t.prototype,"alignment",void 0),t}(ki),te=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Complex)({size:yt.mapsTitleFont.size,fontWeight:null},ot)],t.prototype,"textStyle",void 0),u([Object(r.Property)("Center")],t.prototype,"alignment",void 0),u([Object(r.Complex)({},ne)],t.prototype,"subtitleSettings",void 0),t}(ki),ie=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(!1)],t.prototype,"enable",void 0),u([Object(r.Property)(!0)],t.prototype,"enablePanning",void 0),u([Object(r.Property)(!0)],t.prototype,"enableSelectionZooming",void 0),u([Object(r.Property)("Horizontal")],t.prototype,"toolBarOrientation",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),u([Object(r.Property)(null)],t.prototype,"highlightColor",void 0),u([Object(r.Property)(null)],t.prototype,"selectionColor",void 0),u([Object(r.Property)("Far")],t.prototype,"horizontalAlignment",void 0),u([Object(r.Property)("Near")],t.prototype,"verticalAlignment",void 0),u([Object(r.Property)(["ZoomIn","ZoomOut","Reset"])],t.prototype,"toolbars",void 0),u([Object(r.Property)(!0)],t.prototype,"mouseWheelZoom",void 0),u([Object(r.Property)(!1)],t.prototype,"doubleClickZoom",void 0),u([Object(r.Property)(!1)],t.prototype,"pinchZooming",void 0),u([Object(r.Property)(!1)],t.prototype,"zoomOnClick",void 0),u([Object(r.Property)(1)],t.prototype,"zoomFactor",void 0),u([Object(r.Property)(10)],t.prototype,"maxZoom",void 0),u([Object(r.Property)(1)],t.prototype,"minZoom",void 0),u([Object(r.Property)(!1)],t.prototype,"shouldZoomInitially",void 0),u([Object(r.Property)(!0)],t.prototype,"resetToInitial",void 0),t}(r.ChildProperty),ou=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(!1)],t.prototype,"enable",void 0),u([Object(r.Property)(!0)],t.prototype,"applyShapeSettings",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)("")],t.prototype,"fill",void 0),u([Object(r.Complex)({color:"",width:0},g)],t.prototype,"border",void 0),t}(r.ChildProperty),re=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(!1)],t.prototype,"toggleVisibility",void 0),u([Object(r.Property)(!1)],t.prototype,"visible",void 0),u([Object(r.Property)("transparent")],t.prototype,"background",void 0),u([Object(r.Property)("Layers")],t.prototype,"type",void 0),u([Object(r.Property)(!1)],t.prototype,"invertedPointer",void 0),u([Object(r.Property)("After")],t.prototype,"labelPosition",void 0),u([Object(r.Property)("None")],t.prototype,"labelDisplayMode",void 0),u([Object(r.Property)("Circle")],t.prototype,"shape",void 0),u([Object(r.Property)("")],t.prototype,"width",void 0),u([Object(r.Property)("")],t.prototype,"height",void 0),u([Object(r.Complex)({},ot)],t.prototype,"textStyle",void 0),u([Object(r.Property)(15)],t.prototype,"shapeWidth",void 0),u([Object(r.Property)(15)],t.prototype,"shapeHeight",void 0),u([Object(r.Property)(10)],t.prototype,"shapePadding",void 0),u([Object(r.Complex)({color:"#000000",width:0},g)],t.prototype,"border",void 0),u([Object(r.Complex)({color:"#000000",width:0},g)],t.prototype,"shapeBorder",void 0),u([Object(r.Complex)({},ki)],t.prototype,"title",void 0),u([Object(r.Complex)({},ot)],t.prototype,"titleStyle",void 0),u([Object(r.Property)("Bottom")],t.prototype,"position",void 0),u([Object(r.Property)("Center")],t.prototype,"alignment",void 0),u([Object(r.Property)("None")],t.prototype,"orientation",void 0),u([Object(r.Property)({x:0,y:0})],t.prototype,"location",void 0),u([Object(r.Property)(null)],t.prototype,"fill",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)("Default")],t.prototype,"mode",void 0),u([Object(r.Property)(null)],t.prototype,"showLegendPath",void 0),u([Object(r.Property)(null)],t.prototype,"valuePath",void 0),u([Object(r.Property)(!1)],t.prototype,"removeDuplicateLegend",void 0),u([Object(r.Complex)({},ou)],t.prototype,"toggleLegendSettings",void 0),t}(r.ChildProperty),ue=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(!1)],t.prototype,"visible",void 0),u([Object(r.Complex)({width:0,color:"transparent"},g)],t.prototype,"border",void 0),u([Object(r.Property)("black")],t.prototype,"fill",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)(5)],t.prototype,"rx",void 0),u([Object(r.Property)(5)],t.prototype,"ry",void 0),u([Object(r.Complex)({},ot)],t.prototype,"textStyle",void 0),u([Object(r.Property)("")],t.prototype,"labelPath",void 0),u([Object(r.Property)("None")],t.prototype,"smartLabelMode",void 0),u([Object(r.Property)("None")],t.prototype,"intersectionAction",void 0),u([Object(r.Property)("")],t.prototype,"template",void 0),t}(r.ChildProperty),fe=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(null)],t.prototype,"fill",void 0),u([Object(r.Property)([])],t.prototype,"palette",void 0),u([Object(r.Property)(5)],t.prototype,"circleRadius",void 0),u([Object(r.Complex)({width:0,color:"#000000"},g)],t.prototype,"border",void 0),u([Object(r.Property)("")],t.prototype,"dashArray",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)(null)],t.prototype,"colorValuePath",void 0),u([Object(r.Property)(null)],t.prototype,"borderColorValuePath",void 0),u([Object(r.Property)(null)],t.prototype,"borderWidthValuePath",void 0),u([Object(r.Property)(null)],t.prototype,"valuePath",void 0),u([Object(r.Collection)([],eu)],t.prototype,"colorMapping",void 0),u([Object(r.Property)(!1)],t.prototype,"autofill",void 0),t}(r.ChildProperty),su=function(n){function t(t,i,r,u){return n.call(this,t,i,r,u)||this}return l(t,n),t}(function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Complex)({color:"transparent",width:1},g)],t.prototype,"border",void 0),u([Object(r.Property)(null)],t.prototype,"dashArray",void 0),u([Object(r.Property)(!1)],t.prototype,"visible",void 0),u([Object(r.Property)("#FF471A")],t.prototype,"fill",void 0),u([Object(r.Property)(10)],t.prototype,"height",void 0),u([Object(r.Property)(10)],t.prototype,"width",void 0),u([Object(r.Property)(1)],t.prototype,"opacity",void 0),u([Object(r.Property)(null)],t.prototype,"colorValuePath",void 0),u([Object(r.Property)(null)],t.prototype,"shapeValuePath",void 0),u([Object(r.Property)(null)],t.prototype,"imageUrlValuePath",void 0),u([Object(r.Property)("Balloon")],t.prototype,"shape",void 0),u([Object(r.Property)("")],t.prototype,"legendText",void 0),u([Object(r.Property)(new o(0,0))],t.prototype,"offset",void 0),u([Object(r.Property)("")],t.prototype,"imageUrl",void 0),u([Object(r.Property)(null)],t.prototype,"template",void 0),u([Object(r.Property)([])],t.prototype,"dataSource",void 0),u([Object(r.Property)()],t.prototype,"query",void 0),u([Object(r.Complex)({},bi)],t.prototype,"tooltipSettings",void 0),u([Object(r.Property)(1e3)],t.prototype,"animationDuration",void 0),u([Object(r.Property)(0)],t.prototype,"animationDelay",void 0),u([Object(r.Complex)({},oi)],t.prototype,"selectionSettings",void 0),u([Object(r.Complex)({},si)],t.prototype,"highlightSettings",void 0),u([Object(r.Property)(null)],t.prototype,"latitudeValuePath",void 0),u([Object(r.Property)(null)],t.prototype,"longitudeValuePath",void 0),u([Object(r.Collection)([],bf)],t.prototype,"initialMarkerSelection",void 0),t}(r.ChildProperty)),hu=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.isBaseLayer=!1,t}return l(t,n),u([Object(r.Property)(null)],t.prototype,"shapeData",void 0),u([Object(r.Property)()],t.prototype,"query",void 0),u([Object(r.Complex)({},fe)],t.prototype,"shapeSettings",void 0),u([Object(r.Property)([])],t.prototype,"dataSource",void 0),u([Object(r.Property)("Layer")],t.prototype,"type",void 0),u([Object(r.Property)("Geographic")],t.prototype,"geometryType",void 0),u([Object(r.Property)("Aerial")],t.prototype,"bingMapType",void 0),u([Object(r.Property)("RoadMap")],t.prototype,"staticMapType",void 0),u([Object(r.Property)("")],t.prototype,"key",void 0),u([Object(r.Property)("Geometry")],t.prototype,"layerType",void 0),u([Object(r.Property)("https://a.tile.openstreetmap.org/level/tileX/tileY.png")],t.prototype,"urlTemplate",void 0),u([Object(r.Property)(!0)],t.prototype,"visible",void 0),u([Object(r.Property)("name")],t.prototype,"shapeDataPath",void 0),u([Object(r.Property)("name")],t.prototype,"shapePropertyPath",void 0),u([Object(r.Property)(0)],t.prototype,"animationDuration",void 0),u([Object(r.Collection)([],su)],t.prototype,"markerSettings",void 0),u([Object(r.Complex)({},wf)],t.prototype,"markerClusterSettings",void 0),u([Object(r.Complex)({},ue)],t.prototype,"dataLabelSettings",void 0),u([Object(r.Collection)([],gf)],t.prototype,"bubbleSettings",void 0),u([Object(r.Collection)([],df)],t.prototype,"navigationLineSettings",void 0),u([Object(r.Complex)({},bi)],t.prototype,"tooltipSettings",void 0),u([Object(r.Complex)({},oi)],t.prototype,"selectionSettings",void 0),u([Object(r.Complex)({},si)],t.prototype,"highlightSettings",void 0),u([Object(r.Complex)({},ou)],t.prototype,"toggleLegendSettings",void 0),u([Object(r.Collection)([],kf)],t.prototype,"initialShapeSelection",void 0),t}(r.ChildProperty),ee=function(){return function(n,t,i,r,u,f,e){void 0===i&&(i=256);void 0===r&&(r=256);void 0===u&&(u=0);void 0===f&&(f=0);void 0===e&&(e=null);this.x=n;this.y=t;this.top=u;this.left=f;this.height=i;this.width=r;this.src=e}}(),oe=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return l(t,n),u([Object(r.Property)(null)],t.prototype,"background",void 0),u([Object(r.Complex)({color:"transparent",width:1},g)],t.prototype,"border",void 0),t}(r.ChildProperty),cu=function(){function n(n){this.maps=n;this.trackElements=[];this.sameMarkerData=[]}return n.prototype.markerRender=function(n,t,i,u){var f=this,c=0,l=0,a=0,o,h;this.maps.translateType="marker";o=this.maps.layersCollection[t];this.markerSVGObject=this.maps.renderer.createGroup({id:this.maps.element.id+"_Markers_Group","class":"GroupElement",style:"pointer-events: auto;"});h=Object(r.createElement)("div",{id:this.maps.element.id+"_LayerIndex_"+t+"_Markers_Template_Group",className:this.maps.element.id+"_template",styles:"overflow: hidden; position: absolute;pointer-events: none;top:"+this.maps.mapAreaRect.y+"px;left:"+this.maps.mapAreaRect.x+"px;height:"+this.maps.mapAreaRect.height+"px;width:"+this.maps.mapAreaRect.width+"px;"});o.markerSettings.map(function(v,y){var p=v.dataSource;Array.prototype.forEach.call(p,function(b,k){f.maps.markerNullCount=y>0&&0===k?0:f.maps.markerNullCount;var d={cancel:!1,name:lu,fill:v.fill,height:v.height,width:v.width,imageUrl:v.imageUrl,shape:v.shape,template:v.template,data:b,maps:f.maps,marker:v,border:v.border,colorValuePath:v.colorValuePath,shapeValuePath:v.shapeValuePath,imageUrlValuePath:v.imageUrlValuePath};d=gt(d=dt(d,b),b);f.maps.trigger("markerRendering",d,function(){var lt;v.colorValuePath!==d.colorValuePath&&(d=dt(d,b));v.shapeValuePath!==d.shapeValuePath&&(d=gt(d,b));var nt=Object(r.isNullOrUndefined)(v.longitudeValuePath)?Object(r.isNullOrUndefined)(b.longitude)?Object(r.isNullOrUndefined)(b.Longitude)?0:parseFloat(b.Longitude):parseFloat(b.longitude):Number(s(b,v.longitudeValuePath)),tt=Object(r.isNullOrUndefined)(v.latitudeValuePath)?Object(r.isNullOrUndefined)(b.latitude)?Object(r.isNullOrUndefined)(b.Latitude)?0:parseFloat(b.Latitude):parseFloat(b.latitude):Number(s(b,v.latitudeValuePath)),it=v.offset;if(!d.cancel&&v.visible&&!Object(r.isNullOrUndefined)(nt)&&!Object(r.isNullOrUndefined)(tt)){var ft=f.maps.element.id+"_LayerIndex_"+t+"_MarkerIndex_"+y+"_dataIndex_"+k,g=f.maps.isTileMap?ut(new rt(nt,tt),i,f.maps.tileTranslatePoint,!0):w(tt,nt,i,o,f.maps),ot=0!==o.animationDuration||Object(r.isNullOrUndefined)(f.maps.zoomModule),st=f.maps.isTileMap?"SubLayer"===o.type&&Object(r.isNullOrUndefined)(f.maps.zoomModule)?g=ut(new rt(nt,tt),f.maps.tileZoomLevel,f.maps.tileTranslatePoint,!0):{}:!Object(r.isNullOrUndefined)(f.maps.zoomModule)&&f.maps.zoomSettings.zoomFactor>1?at(f.maps,o,ot):et(f.maps,o,ot),ht="AddMarker"===u?f.maps.scale:st.scale,ct="AddMarker"===u?f.maps.translatePoint:st.location;!d.template||isNaN(g.x)||isNaN(g.y)?d.template||isNaN(g.x)||isNaN(g.y)||(c++,sr(d,v,p,k,g,ct,ft,it,ht,f.maps,f.markerSVGObject)):(a++,hr(d,void 0,ft,b,y,h,g,ct,ht,it,f.maps),f.maps.renderReactTemplates())}l+=isNaN(tt)||isNaN(nt)?1:0;a+=d.cancel?1:0;c+=d.cancel?1:0;f.maps.markerNullCount=Object(r.isNullOrUndefined)(nt)||Object(r.isNullOrUndefined)(tt)?f.maps.markerNullCount+1:f.maps.markerNullCount;lt=p.length-f.maps.markerNullCount;f.markerSVGObject.childElementCount===lt-a-l&&"Template"!==u&&(n.appendChild(f.markerSVGObject),o.markerClusterSettings.allowClustering&&(f.maps.svgObject.appendChild(f.markerSVGObject),f.maps.element.appendChild(f.maps.svgObject),"OSM"===o.layerType&&f.maps.zoomSettings.enable?n.appendChild(f.markerSVGObject):ni(o,f.markerSVGObject,f.maps,t,f.markerSVGObject,n,!0,!1),f.maps.renderReactTemplates()));h.childElementCount===p.length-c-l&&e(f.maps.element.id+"_Secondary_Element")&&(e(f.maps.element.id+"_Secondary_Element").appendChild(h),f.maps.checkInitialRender&&o.markerClusterSettings.allowClustering&&(ni(o,h,f.maps,t,f.markerSVGObject,n,!1,!1),f.maps.renderReactTemplates()))})})})},n.prototype.calculateIndividualLayerMarkerZoomLevel=function(n,t,i){var r,u,o=Math.abs(this.maps.baseMapBounds.latitude.max-this.maps.baseMapBounds.latitude.min),s=Math.abs(this.maps.baseMapBounds.longitude.max-this.maps.baseMapBounds.longitude.min),e,f;return r=(r=Math.floor(Math.log(t/o)))>i?i:r,u=(u=Math.floor(Math.log(n/s)))>i?i:u,e=Math.min(r,u),f=Math.min(e,i-1),this.maps.isTileMap||uu(f,this.maps),f},n.prototype.calculateZoomCenterPositionAndFactor=function(n){var o;if(this.maps.zoomSettings.shouldZoomInitially&&this.maps.markerModule){var i,u,f,e,t=void 0,s=void 0,h=void 0,a=this.maps.zoomSettings.maxZoom,c=this.maps.mapAreaRect.width,l=this.maps.mapAreaRect.height;(this.maps.markerZoomedState=this.maps.markerZoomedState?this.maps.markerZoomedState:Object(r.isNullOrUndefined)(this.maps.markerZoomFactor)?!this.maps.markerZoomedState:this.maps.markerZoomFactor>1?this.maps.markerZoomedState:!this.maps.markerZoomedState,this.maps.defaultState=this.maps.markerZoomedState?!this.maps.markerZoomedState:this.maps.defaultState,Array.prototype.forEach.call(n,function(n){0!==n.markerSettings.length&&Array.prototype.forEach.call(n.markerSettings,function(n){var t=n.dataSource;Array.prototype.forEach.call(t,function(n,t){var o=Object(r.isNullOrUndefined)(n.latitude)?Object(r.isNullOrUndefined)(n.Latitude)?null:parseFloat(n.Latitude):parseFloat(n.latitude),s=Object(r.isNullOrUndefined)(n.longitude)?Object(r.isNullOrUndefined)(n.Longitude)?null:parseFloat(n.Longitude):parseFloat(n.longitude);i=Object(r.isNullOrUndefined)(i)&&0===t?s:i;u=Object(r.isNullOrUndefined)(u)&&0===t?o:u;f=Object(r.isNullOrUndefined)(f)&&0===t?o:f;e=Object(r.isNullOrUndefined)(e)&&0===t?s:e;i>s&&(i=s);f>o&&(f=o);e<s&&(e=s);u<o&&(u=o)})})}),Object(r.isNullOrUndefined)(f)||Object(r.isNullOrUndefined)(i)||Object(r.isNullOrUndefined)(e)||Object(r.isNullOrUndefined)(u))||(s=(f+u)/2,h=(i+e)/2,this.maps.markerCenterLatitude=s,this.maps.markerCenterLongitude=h,(Object(r.isNullOrUndefined)(this.maps.markerZoomCenterPoint)||this.maps.markerZoomedState)&&(this.maps.markerZoomCenterPoint={latitude:s,longitude:h}),o=void 0,this.maps.isTileMap||0===this.maps.baseMapRectBounds.min.x?(t=fu(f,u,i,e,c,l,this.maps),this.maps.isTileMap?o=Object(r.isNullOrUndefined)(this.maps.markerZoomFactor)||Object(r.isNullOrUndefined)(this.maps.mapScaleValue)?t:this.maps.mapScaleValue>1&&1!==this.maps.markerZoomFactor?this.maps.mapScaleValue:t:(o=Object(r.isNullOrUndefined)(this.maps.mapScaleValue)?t:1!==Math.floor(this.maps.scale)&&this.maps.mapScaleValue!==t&&Object(r.isNullOrUndefined)(this.maps.shouldZoomCurrentFactor)?this.maps.mapScaleValue:t)!==this.maps.mapScaleValue||1!==this.maps.markerZoomFactor&&1!==this.maps.mapScaleValue||this.maps.enablePersistence||(o=t)):(t=this.calculateIndividualLayerMarkerZoomLevel(c,l,a),o=Object(r.isNullOrUndefined)(this.maps.mapScaleValue)?t:this.maps.mapScaleValue!==t?this.maps.mapScaleValue:t),this.maps.markerZoomFactor=o)}else this.maps.markerZoomedState=!1,this.maps.markerZoomFactor>1&&(this.maps.markerCenterLatitude=null,this.maps.markerCenterLongitude=null,this.maps.markerZoomFactor=1,this.maps.enablePersistence||(this.maps.mapScaleValue=1)),this.maps.isTileMap&&!this.maps.enablePersistence&&this.maps.mapScaleValue<=1&&(this.maps.tileZoomLevel=0===this.maps.mapScaleValue?1:this.maps.mapScaleValue,1===this.maps.mapScaleValue&&1===this.maps.markerZoomFactor&&(this.maps.tileTranslatePoint.x=0,this.maps.tileTranslatePoint.y=0))},n.prototype.markerClick=function(n){var i=n.target.id,t,u;-1===i.indexOf("_LayerIndex_")||i.indexOf("_cluster_")>0||(t=this.getMarker(i),Object(r.isNullOrUndefined)(t)||(u={cancel:!1,name:au,data:t.data,maps:this.maps,marker:t.marker,target:i,x:n.clientX,y:n.clientY,latitude:t.data.latitude||t.data.Latitude,longitude:t.data.longitude||t.data.Longitude,value:t.data.name},this.maps.trigger(au,u)))},n.prototype.markerClusterClick=function(n){var i=n.target.id,t,u;-1!==i.indexOf("_LayerIndex_")&&-1!==i.indexOf("_cluster_")&&(t=this.getMarker(i),Object(r.isNullOrUndefined)(t)||(t.clusterCollection.length>0&&this.maps.markerClusterExpand&&(c(this.maps.element.id+"_mapsTooltip")&&this.maps.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")>-1&&a(this.maps.element.id+"_mapsTooltip"),this.sameMarkerData.length>0&&!this.maps.markerClusterExpandCheck?(this.maps.markerClusterExpandCheck=!0,er(this.sameMarkerData,this.maps,this.markerSVGObject)):(this.sameMarkerData=t.clusterCollection,this.maps.markerClusterExpandCheck=!1,or(this.sameMarkerData,this.maps,this.markerSVGObject,!0))),u={cancel:!1,name:vu,data:t,maps:this.maps,target:i,x:n.clientX,y:n.clientY,latitude:t.data.latitude||t.data.Latitude,longitude:t.data.longitude||t.data.Longitude,markerClusterCollection:t.markCollection},this.maps.trigger(vu,u)))},n.prototype.getMarker=function(n){var i,t,o=n.split("_LayerIndex_"),s=parseInt(o[1].split("_")[0],10),l=this.maps.layers[s],a=[],v=[],u,h,r,y,f,c,e;if((this.maps.markerClusterExpand=l.markerClusterSettings.allowClusterExpand,n.indexOf("_MarkerIndex_")>-1)&&(u=parseInt(o[1].split("_MarkerIndex_")[1].split("_")[0],10),h=parseInt(o[1].split("_dataIndex_")[1].split("_")[0],10),t=l.markerSettings[u],!isNaN(u))){if(i=t.dataSource[h],r=[],!t.template&&n.indexOf("_cluster_")>-1&&this.maps.layers[s].markerClusterSettings.allowClusterExpand&&Array.prototype.forEach.call(t.dataSource,function(n,t){n.latitude===i.latitude&&n.longitude===i.longitude&&r.push({data:i,index:t})}),n.indexOf("_cluster_")>-1){for(y=document.getElementById(n.indexOf("_datalabel_")>-1?n.split("_datalabel_")[0]:n).innerHTML.split(",").map(Number),r=[],f=0,c=y;f<c.length;f++)e=c[f],r.push({data:t.dataSource[e],index:e}),a.push(t.dataSource[e]);v.push({data:r,layerIndex:s,markerIndex:u,dataIndex:h,targetClusterIndex:+(n.split("_cluster_")[1].indexOf("_datalabel_")>-1?n.split("_cluster_")[1].split("_datalabel_")[0]:n.split("_cluster_")[1]),isClusterSame:!1})}return{marker:t,data:i,clusterCollection:v,markCollection:a}}return null},n.prototype.markerMove=function(n){var t=n.target.id,i,u;-1===t.indexOf("_LayerIndex_")||t.indexOf("_cluster_")>0||(i=this.getMarker(t),Object(r.isNullOrUndefined)(i)||(u={cancel:!1,name:yu,data:i.data,maps:this.maps,target:t,x:n.clientX,y:n.clientY},this.maps.trigger(yu,u)))},n.prototype.markerClusterMouseMove=function(n){var t=n.target.id,i,u;-1!==t.indexOf("_LayerIndex_")&&-1!==t.indexOf("_cluster_")&&(i=this.getMarker(t),(this.maps.markerClusterExpand&&n.target.setAttribute("style","cursor: pointer"),Object(r.isNullOrUndefined)(i))||(u={cancel:!1,name:pu,data:i.data,maps:this.maps,target:t,x:n.clientX,y:n.clientY},this.maps.trigger(pu,u)))},n.prototype.getModuleName=function(){return"Marker"},n.prototype.destroy=function(){},n}(),ft="click",lu="markerRendering",se="markerClusterRendering",au="markerClick",vu="markerClusterClick",yu="markerMouseMove",pu="markerClusterMouseMove",wu="animationComplete",bu="itemSelection",ku=function(){function n(n){this.maps=n}return n.prototype.getBingMap=function(n,t,i,r,u,f){for(var s,h,c,e="",o=Math.min(this.maps.tileZoomLevel,parseInt(this.maxZoom,10));o>0;o--)s=0,h=1<<o-1,0!=(n.x&h)&&s++,0!=(n.y&h)&&(s+=2),e=e+""+s;return c=f[Math.min(parseInt(e.substr(e.length-1,1),10),f.length)],(u=u.replace("{quadkey}",e).replace("{subdomain}",c))+"&mkt="+r+"&ur=IN&Key="+t},n}(),du=function(){function n(n){this.maps=n}return n.prototype.getShapeColorMapping=function(n,t,i){var u=n.colorValuePath?n.colorValuePath:n.valuePath,f=Object(r.isNullOrUndefined)(u)?t[u]:u.indexOf(".")>-1?s(t,u):t[u],o=Number(f),e=this.getColorByValue(n.colorMapping,o,f);return Object(r.isNullOrUndefined)(e)?i:e},n.prototype.getColorByValue=function(n,t,i){var u;if(isNaN(t)&&Object(r.isNullOrUndefined)(i))return null;for(var o,f="",e=0,s=n;e<s.length;e++)u=s[e],(!Object(r.isNullOrUndefined)(u.from)&&!Object(r.isNullOrUndefined)(u.to)&&t>=u.from&&t<=u.to||u.value===i)&&(f="[object Array]"===Object.prototype.toString.call(u.color)?Object(r.isNullOrUndefined)(u.value)?this.getColor(u,t):u.color[0]:u.color),(t>=u.from&&t<=u.to||u.value===i)&&!Object(r.isNullOrUndefined)(u.minOpacity)&&!Object(r.isNullOrUndefined)(u.maxOpacity)&&f&&(o=this.deSaturationColor(u,f,t,i)),(""===f||Object(r.isNullOrUndefined)(f))&&Object(r.isNullOrUndefined)(u.from)&&Object(r.isNullOrUndefined)(u.to)&&Object(r.isNullOrUndefined)(u.minOpacity)&&Object(r.isNullOrUndefined)(u.maxOpacity)&&Object(r.isNullOrUndefined)(u.value)&&(f="[object Array]"===Object.prototype.toString.call(u.color)?u.color[0]:u.color);return{fill:f||(n.length?null:i),opacity:o}},n.prototype.deSaturationColor=function(n,t,i,r){var u=1;return(i>=n.from&&i<=n.to||n.value===r)&&(u=(isNaN(i)?n.from/(n.to-n.from):(i-n.from)/(n.to-n.from))*(n.maxOpacity-n.minOpacity)+n.minOpacity),u},n.prototype.rgbToHex=function(n,t,i){return"#"+this.componentToHex(n)+this.componentToHex(t)+this.componentToHex(i)},n.prototype.componentToHex=function(n){var t=n.toString(16);return 1===t.length?"0"+t:t},n.prototype.getColor=function(n,t){var i,r="";return Number(t)===n.from?r=n.color[0]:Number(t)===n.to?r=n.color[n.color.length-1]:(i=this.getGradientColor(Number(t),n),r=this.rgbToHex(i.r,i.g,i.b)),r},n.prototype.getGradientColor=function(n,t){var f,e,s=t.from,c=t.to,o=0,l=c-s,i;if(o=(n-s)/l,t.color.length<=2)f="#"===t.color[0].charAt(0)?t.color[0]:this._colorNameToHex(t.color[0]),e="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:this._colorNameToHex(t.color[t.color.length-1]);else{f="#"===t.color[0].charAt(0)?t.color[0]:this._colorNameToHex(t.color[0]);e="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:this._colorNameToHex(t.color[t.color.length-1]);for(var u=l/(t.color.length-1),v=t.color.length-1,r=[],a={},h=1;h<v;h++)a={b:s+h*u,color:t.color[h]},r.push(a);for(i=0;i<r.length;i++)s<=n&&n<=r[i].b&&0===i?(e="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),o=n<r[i].b?1-Math.abs((n-r[i].b)/u):(n-r[i].b)/u):r[i].b<=n&&n<=c&&i===r.length-1&&(f="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),o=n<r[i].b?1-Math.abs((n-r[i].b)/u):(n-r[i].b)/u),i!==r.length-1&&i<r.length&&r[i].b<=n&&n<=r[i+1].b&&(f="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),e="#"===r[i+1].color.charAt(0)?r[i+1].color:this._colorNameToHex(r[i+1].color),o=Math.abs(n-r[i+1].b)/u)}return this.getPercentageColor(o,f,e)},n.prototype.getPercentageColor=function(n,t,i){var r=i.split("#")[1],u=t.split("#")[1],f=this.getPercentage(n,parseInt(u.substr(0,2),16),parseInt(r.substr(0,2),16)),e=this.getPercentage(n,parseInt(u.substr(2,2),16),parseInt(r.substr(2,2),16)),o=this.getPercentage(n,parseInt(u.substr(4,2),16),parseInt(r.substr(4,2),16));return new uf(f,e,o)},n.prototype.getPercentage=function(n,t,i){var r=i-t;return Math.round(t+r*n)},n.prototype._colorNameToHex=function(n){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",orchid:"#da70d6",papayawhip:"#ffefd5",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"[object Array]"===Object.prototype.toString.call(n)?n:void 0!==t[n.toLowerCase()]?t[n.toLowerCase()]:n},n}(),he=function(){function n(n){this.isMapCoordinates=!0;this.horizontalPan=!1;this.horizontalPanXCount=0;this.mapObject=n;this.ajaxModule=new r.Ajax;this.ajaxResponse=[]}return n.prototype.measureLayerPanel=function(){var i=this,f=this.mapObject.layersCollection,n=this.mapObject.mapAreaRect,u=e(this.mapObject.element.id+"_Secondary_Element"),t;this.mapObject.isTileMap&&u&&(this.tileSvgObject=this.mapObject.renderer.createSvg({id:this.mapObject.element.id+"_Tile_SVG",width:n.width,height:n.height}),t=Object(r.createElement)("div",{id:this.mapObject.element.id+"_Tile_SVG_Parent",styles:"position: absolute; height: "+n.height+"px; width: "+n.width+"px;"}),t.appendChild(this.tileSvgObject),u.appendChild(t));this.clipRectElement=(this.layerGroup=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_Layer_Collections","clip-path":"url(#"+this.mapObject.element.id+"_MapArea_ClipRect)"}),"GoogleStaticMap"===this.mapObject.layers[this.mapObject.baseLayerIndex].layerType)?this.mapObject.renderer.drawClipPath(new k(this.mapObject.element.id+"_MapArea_ClipRect","transparent",{width:1,color:"Gray"},1,{x:(n.width-640)/2,y:0,width:640,height:n.height})):this.mapObject.renderer.drawClipPath(new k(this.mapObject.element.id+"_MapArea_ClipRect","transparent",{width:1,color:"Gray"},1,{x:this.mapObject.isTileMap?0:n.x,y:this.mapObject.isTileMap?0:n.y,width:n.width,height:n.height<0?0:n.height}));this.layerGroup.appendChild(this.clipRectElement);this.mapObject.baseMapBounds=null;this.mapObject.baseMapRectBounds=null;this.mapObject.baseSize=null;Array.prototype.forEach.call(f,function(n,t){i.currentLayer=n;i.processLayers(n,t)})},n.prototype.renderTileLayer=function(n,t,i,u){var s,e,f,c,l,h;n.currentFactor=n.calculateFactor(t);n.mapObject.defaultState=!(1!==n.mapObject.zoomSettings.zoomFactor&&!Object(r.isNullOrUndefined)(n.mapObject.tileZoomLevel)&&1!==n.mapObject.tileZoomLevel);Object(r.isNullOrUndefined)(n.mapObject.previousCenterLatitude)&&Object(r.isNullOrUndefined)(n.mapObject.previousCenterLongitude)?(n.mapObject.previousCenterLatitude=n.mapObject.centerPosition.latitude,n.mapObject.previousCenterLongitude=n.mapObject.centerPosition.longitude):n.mapObject.previousCenterLatitude!==n.mapObject.centerPosition.latitude&&n.mapObject.previousCenterLongitude!==n.mapObject.centerPosition.longitude?(n.mapObject.centerPositionChanged=!0,n.mapObject.previousCenterLatitude=n.mapObject.centerPosition.latitude,n.mapObject.previousCenterLongitude=n.mapObject.centerPosition.longitude):n.mapObject.centerPositionChanged=!1;s=new o(n.mapObject.centerPosition.longitude,n.mapObject.centerPosition.latitude);e=s;this.mapObject.isTileMap&&n.mapObject.markerModule&&n.mapObject.zoomSettings.enable&&(n.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection),Object(r.isNullOrUndefined)(this.mapObject.markerCenterLatitude)||Object(r.isNullOrUndefined)(this.mapObject.markerCenterLongitude)||(e=new o(n.mapObject.markerCenterLongitude,n.mapObject.markerCenterLatitude)));s=!n.mapObject.zoomSettings.shouldZoomInitially&&n.mapObject.centerPosition.longitude&&n.mapObject.centerPosition.latitude&&!n.mapObject.zoomPersistence&&n.mapObject.defaultState?new o(n.mapObject.centerPosition.longitude,n.mapObject.centerPosition.latitude):n.mapObject.zoomSettings.shouldZoomInitially&&n.mapObject.markerZoomedState&&!n.mapObject.zoomPersistence&&!Object(r.isNullOrUndefined)(n.mapObject.markerZoomCenterPoint)?new o(n.mapObject.markerZoomCenterPoint.longitude,n.mapObject.markerZoomCenterPoint.latitude):{x:null,y:null};f=n.mapObject.zoomSettings.shouldZoomInitially?Object(r.isNullOrUndefined)(n.mapObject.markerZoomFactor)?1:n.mapObject.markerZoomFactor:n.mapObject.zoomSettings.zoomFactor;(f=n.mapObject.enablePersistence?Object(r.isNullOrUndefined)(n.mapObject.mapScaleValue)?Object(r.isNullOrUndefined)(n.mapObject.markerZoomFactor)?n.mapObject.zoomSettings.zoomFactor:n.mapObject.markerZoomFactor:n.mapObject.mapScaleValue:f,f=(f=n.mapObject.zoomSettings.enable?f:n.mapObject.zoomSettings.zoomFactor)>0?f:1,n.mapObject.defaultState=1===f,!n.mapObject.markerZoomedState&&n.mapObject.zoomSettings.shouldZoomInitially&&1===n.mapObject.zoomSettings.zoomFactor&&(n.mapObject.defaultState=!0),Object(r.isNullOrUndefined)(n.mapObject.tileZoomLevel))?(n.mapObject.tileZoomLevel=f,n.mapObject.previousZoomFactor=f):this.mapObject.isReset&&1===n.mapObject.tileZoomLevel&&!n.mapObject.zoomSettings.shouldZoomInitially?(c=n.mapObject.tileZoomLevel,n.mapObject.tileZoomLevel=c):1!==n.mapObject.zoomSettings.zoomFactor||n.mapObject.zoomSettings.shouldZoomInitially?(n.mapObject.previousZoomFactor=n.mapObject.tileZoomLevel,n.mapObject.tileZoomLevel=n.mapObject.defaultState&&n.mapObject.zoomSettings.enable?n.mapObject.tileZoomLevel:n.mapObject.zoomSettings.shouldZoomInitially||n.mapObject.centerPositionChanged?f:n.mapObject.previousZoomFactor!==n.mapObject.zoomSettings.zoomFactor?n.mapObject.zoomSettings.zoomFactor:n.mapObject.tileZoomLevel,n.mapObject.tileZoomLevel=1===f&&0===n.mapObject.zoomSettings.zoomFactor?f:n.mapObject.tileZoomLevel,!Object(r.isNullOrUndefined)(n.mapObject.tileTranslatePoint)&&(n.mapObject.markerZoomFactor!==n.mapObject.mapScaleValue||Object(r.isNullOrUndefined)(n.mapObject.markerZoomFactor)&&Object(r.isNullOrUndefined)(n.mapObject.mapScaleValue))&&(n.mapObject.zoomSettings.zoomFactor<=1||n.mapObject.previousZoomFactor!==n.mapObject.zoomSettings.zoomFactor)&&(n.mapObject.tileTranslatePoint.x=0,n.mapObject.tileTranslatePoint.y=0)):n.mapObject.defaultState&&(n.mapObject.previousZoomFactor=n.mapObject.tileZoomLevel,n.mapObject.tileZoomLevel=f,n.mapObject.tileTranslatePoint.x=0,n.mapObject.tileTranslatePoint.y=0);(f<=1&&!Object(r.isNullOrUndefined)(n.mapObject.height)&&!n.mapObject.zoomSettings.shouldZoomInitially&&n.mapObject.tileZoomLevel===n.mapObject.tileZoomScale&&this.mapObject.initialCheck&&function(n){n.tileZoomScale=n.tileZoomLevel=Math.floor(n.availableSize.height/512)+1;var i="GoogleStaticMap"!==n.layers[n.baseLayerIndex].layerType?20:0,t=256*Math.pow(2,n.tileZoomLevel);n.tileTranslatePoint.x=n.availableSize.width/2-t/2;n.tileTranslatePoint.y=n.availableSize.height/2-t/2+i;n.previousTileWidth=n.availableSize.width;n.previousTileHeight=n.availableSize.height}(this.mapObject),Object(r.isNullOrUndefined)(n.mapObject.centerLatOfGivenLocation)||Object(r.isNullOrUndefined)(n.mapObject.centerLongOfGivenLocation)||!n.mapObject.zoomNotApplied||(e.y=n.mapObject.centerLatOfGivenLocation,e.x=n.mapObject.centerLongOfGivenLocation,n.mapObject.tileZoomLevel=n.mapObject.mapScaleValue=n.mapObject.scaleOfGivenLocation),n.mapObject.tileTranslatePoint=n.panTileMap(n.mapObject.availableSize.width,n.mapObject.availableSize.height,e),this.mapObject.zoomSettings.resetToInitial&&this.mapObject.initialCheck&&!Object(r.isNullOrUndefined)(n.mapObject.height)&&this.mapObject.availableSize.height>512)&&(this.mapObject.applyZoomReset=!0,this.mapObject.initialZoomLevel=Math.floor(this.mapObject.availableSize.height/512)+1,l="GoogleStaticMap"!==this.mapObject.layers[this.mapObject.baseLayerIndex].layerType?20:0,h=256*Math.pow(2,this.mapObject.initialZoomLevel),this.mapObject.initialTileTranslate.x=this.mapObject.availableSize.width/2-h/2,this.mapObject.initialTileTranslate.y=this.mapObject.availableSize.height/2-h/2+l);n.generateTiles(n.mapObject.tileZoomLevel,n.mapObject.tileTranslatePoint,null,u);Object(r.isNullOrUndefined)(n.mapObject.previousZoomFactor)||n.mapObject.previousZoomFactor===n.mapObject.zoomSettings.zoomFactor||(n.mapObject.previousZoomFactor=n.mapObject.zoomSettings.zoomFactor);n.mapObject.navigationLineModule&&n.layerObject.appendChild(n.mapObject.navigationLineModule.renderNavigation(n.currentLayer,n.mapObject.tileZoomLevel,i));n.mapObject.markerModule&&n.mapObject.markerModule.markerRender(n.layerObject,i,n.mapObject.tileZoomLevel,null);n.translateLayerElements(n.layerObject,i);n.layerGroup.appendChild(n.layerObject)},n.prototype.processLayers=function(n,t){var i=this,e,u,f;if((this.layerObject=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_LayerIndex_"+t}),!this.mapObject.enablePersistence)&&(e=this.mapObject.getModuleName()+this.mapObject.element.id,-1===navigator.userAgent.indexOf("Edge"))){u=void 0;try{u=window.localStorage}catch(n){u=null}!Object(r.isNullOrUndefined)(u)&&window.localStorage.getItem(e)&&window.localStorage.removeItem(e)}f={cancel:!1,name:"layerRendering",index:t,layer:n,maps:this.mapObject,visible:n.visible};this.mapObject.trigger("layerRendering",f,function(){var s,e;if(!f.cancel&&f.visible)if("Geometry"!==n.layerType){if("Bing"!==n.layerType||i.bing)i.renderTileLayer(i,n,t);else if(n.key&&n.key.length>1){var o=i,u=new ku(i.mapObject),c="https://dev.virtualearth.net/REST/V1/Imagery/Metadata/"+("AerialWithLabel"===n.bingMapType?"AerialWithLabelsOnDemand":n.bingMapType),h=new r.Ajax({url:c+"?output=json&include=ImageryProviders&urischeme=https&key="+n.key});h.onSuccess=function(r){var f=JSON.parse(r).resourceSets[0].resources[0],e=f.imageUrl,s=f.imageUrlSubdomains,h=f.zoomMax;document.getElementById(o.mapObject.element.id+"_Markers_Group");null!=e&&e!==u.imageUrl&&(u.imageUrl=e);null!=s&&s!==u.subDomains&&(u.subDomains=s);null!=h&&h!==u.maxZoom&&(u.maxZoom=h);o.mapObject.bingMap=u;o.renderTileLayer(o,n,t,u);i.mapObject.arrangeTemplate()};h.send()}}else Object(r.isNullOrUndefined)(n.shapeData)||Object(r.isNullOrUndefined)(n.shapeData.geometries)&&Object(r.isNullOrUndefined)(n.shapeData.features)||(s=!Object(r.isNullOrUndefined)(n.shapeData.geometries)&&n.shapeData.geometries.length>0?n.shapeData.geometries:n.shapeData.features,n.layerData=[],e=n.shapeData.bbox,!Object(r.isNullOrUndefined)(e)&&n.isBaseLayer?i.mapObject.baseMapBounds=new rr({min:e[0][1],max:e[1][1]},{min:e[0][0],max:e[1][0]}):Object(r.isNullOrUndefined)(i.mapObject.baseMapBounds)&&!cr(s)&&i.calculateRectBounds(s),i.calculatePathCollection(t,s))});this.mapObject.isTileMap?this.tileSvgObject&&(this.tileSvgObject.appendChild(this.layerGroup),this.mapObject.baseMapBounds=null):this.mapObject.svgObject.appendChild(this.layerGroup)},n.prototype.bubbleCalculation=function(n,t){var f,i,u;if(null!=n.dataSource&&null!=n)for(f=n.dataSource,i=0;i<f.length;i++)u=Object(r.isNullOrUndefined)(n.valuePath)?parseFloat(n.dataSource[i][n.valuePath]):n.valuePath.indexOf(".")>-1?Number(s(n.dataSource[i],n.valuePath)):parseFloat(n.dataSource[i][n.valuePath]),0!==i?u>t.max?t.max=u:u<t.min&&(t.min=u):t.max=t.min=u},n.prototype.calculatePathCollection=function(n,t){var i=this,u,e,o;if(this.groupElements=[],cr(t)||(this.currentFactor=this.calculateFactor(this.currentLayer)),this.rectBounds=null,u=this.currentLayer.shapeSettings,this.currentLayer.bubbleSettings,Array.prototype.forEach.call(t,function(n){if(!Object(r.isNullOrUndefined)(n.geometry)||!Object(r.isNullOrUndefined)(n.coordinates)){var t=Object(r.isNullOrUndefined)(n.geometry)?n.type:n.geometry.type,u=Object(r.isNullOrUndefined)(n.geometry)?n.coordinates:n.geometry.coordinates,f=n.geometry,e=n.properties;"LineString"!==t&&i.generatePoints(t,u,f,e)}}),this.currentLayer.rectBounds=this.rectBounds,Object(r.isNullOrUndefined)(this.mapObject.baseMapRectBounds)&&this.currentLayer.isBaseLayer&&(this.mapObject.baseMapRectBounds=this.rectBounds),e=u.palette.length>1?u.palette:function(n){var t;switch(n.toLowerCase()){case"tailwind":t=["#0369A1","#14B8A6","#15803D","#334155","#5A61F6","#65A30D","#8B5CF6","#9333EA","#F59E0B","#F97316"];break;case"tailwinddark":t=["#10B981","#22D3EE","#2DD4BF","#4ADE80","#8B5CF6","#E879F9","#F472B6","#F87171","#F97316","#FCD34D"];break;case"bootstrap5":t=["#262E0B","#668E1F","#AF6E10","#862C0B","#1F2D50","#64680B","#311508","#4C4C81","#0C7DA0","#862C0B"];break;case"bootstrap5dark":t=["#5ECB9B","#A860F1","#EBA844","#557EF7","#E9599B","#BFC529","#3BC6CF","#7A68EC","#74B706","#EA6266"];break;default:t=["#B5E485","#7BC1E8","#DF819C","#EC9B79","#78D0D3","#D6D572","#9178E3","#A1E5B4","#87A4B4","#E4C16C"]}return t}(this.mapObject.theme),o=Object(r.createElement)("div",{id:this.mapObject.element.id+"_LayerIndex_"+n+"_Label_Template_Group",className:this.mapObject.element.id+"_template",styles:"pointer-events: none; overflow: hidden; position: absolute;top:"+this.mapObject.mapAreaRect.y+"px;left:"+this.mapObject.mapAreaRect.x+"px;height:"+this.mapObject.mapAreaRect.height+"px;width:"+this.mapObject.mapAreaRect.width+"px;"}),0!==this.currentLayer.layerData.length)for(var c=function(h){var g,nt,tt,p,l=void 0,w={color:u.border.color,width:u.border.width,opacity:u.border.opacity},c=f.currentLayer.layerData[h],v="",it="",a=u.autofill?e[h%e.length]:u.fill||f.mapObject.themeStyle.shapeFill,k,y;null===u.colorValuePath||Object(r.isNullOrUndefined)(c.property)||(null!==(l=ct(f.currentLayer.dataSource,c.property,f.currentLayer.shapeDataPath,f.currentLayer.shapePropertyPath,f.currentLayer))&&0===u.colorMapping.length?a=f.currentLayer.shapeSettings.colorValuePath.indexOf(".")>-1?s(f.currentLayer.dataSource[l],u.colorValuePath):f.currentLayer.dataSource[l][u.colorValuePath]:c.property[u.colorValuePath]&&0===f.currentLayer.dataSource.length&&0===u.colorMapping.length&&(a=f.currentLayer.shapeSettings.colorValuePath.indexOf(".")>-1?s(c.property,u.colorValuePath):c.property[u.colorValuePath]),a=Object(r.isNullOrUndefined)(a)?u.fill||f.mapObject.themeStyle.shapeFill:a);k=f.mapObject.element.id+"_LayerIndex_"+n+"_shapeIndex_"+h+"_dataIndex_"+l;y=f.getShapeColorMapping(f.currentLayer,c.property,a);(a="[object Object]"!==Object.prototype.toString.call(y)||Object(r.isNullOrUndefined)(y.fill)?a:y.fill,f.currentLayer.shapeSettings.borderColorValuePath||f.currentLayer.shapeSettings.borderWidthValuePath)&&(f.currentLayer.shapeSettings.borderColorValuePath,f.currentLayer.shapeSettings.borderWidthValuePath,null!==(l=ct(f.currentLayer.dataSource,c.property,f.currentLayer.shapeDataPath,f.currentLayer.shapePropertyPath,f.currentLayer))&&(f.currentLayer.dataSource[l][u.borderColorValuePath]&&(w.color=f.currentLayer.dataSource[l][u.borderColorValuePath]),f.currentLayer.dataSource[l][u.borderWidthValuePath]&&(w.width=f.currentLayer.dataSource[l][u.borderWidthValuePath])));var d="[object Object]"!==Object.prototype.toString.call(y)||Object(r.isNullOrUndefined)(y.opacity)?u.opacity:y.opacity,ut={cancel:!1,name:"shapeRendering",index:h,data:f.currentLayer.dataSource?f.currentLayer.dataSource[l]:null,maps:f.mapObject,shape:u,fill:a,border:{width:w.width,color:w.color,opacity:w.opacity}},rt=function(f){var s,l=Object(r.isNullOrUndefined)(c._isMultiPolygon)?Object(r.isNullOrUndefined)(c.type)?c[0].type:c.type:"MultiPolygon",rt,ut,ft,y;if(l="Polygon"===l||"MultiPolygon"===l?"Polygon":l,f.cancel?(f.fill=a,f.border.color=u.border.color,f.border.width=u.border.width,i.mapObject.layers[n].shapeSettings.border=u.border):(f.fill="#A6A6A6"===f.fill?f.shape.fill||i.mapObject.themeStyle.shapeFill:f.fill,f.border.color="#000000"===f.border.color?f.shape.border.color:f.border.color,f.border.width=0===f.border.width?f.shape.border.width:f.border.width,Object(r.isNullOrUndefined)(u.borderColorValuePath)?i.mapObject.layers[n].shapeSettings.border.color=f.border.color:Object(r.isNullOrUndefined)(u.borderWidthValuePath)&&(i.mapObject.layers[n].shapeSettings.border.width=f.border.width)),f.border.opacity=Object(r.isNullOrUndefined)(f.border.opacity)?d:f.border.opacity,i.groupElements.length<1)p=i.mapObject.renderer.createGroup({id:i.mapObject.element.id+"_LayerIndex_"+n+"_"+l+"_Group",transform:""}),i.groupElements.push(p);else for(rt=0;rt<i.groupElements.length;rt++){if(ut=i.groupElements[rt],ut.id.indexOf(l)>-1){p=ut;break}if(rt>=i.groupElements.length-1){p=i.mapObject.renderer.createGroup({id:i.mapObject.element.id+"_LayerIndex_"+n+"_"+l+"_Group"});i.groupElements.push(p);break}}switch(l){case"Polygon":c._isMultiPolygon?v=i.generateMultiPolygonPath(c):(v+="M"+c[0].point.x+" "+c[0].point.y,c.map(function(n){v+=" L "+n.point.x+" "+n.point.y}));(v+=" z ").length>3&&(g=new b(k,f.fill,f.border.width,f.border.color,d,f.border.opacity,u.dashArray,v),s=i.mapObject.renderer.drawPath(g));break;case"LineString":c.map(function(n){it+=n.point.x+" , "+n.point.y+" "});nt=new ff(k,it,f.fill,f.border.width,f.border.color,d,f.border.opacity,u.dashArray);s=i.mapObject.renderer.drawPolyline(nt);break;case"Point":ft=c.point;tt=new kt(k,f.fill,f.border,d,ft.x,ft.y,u.circleRadius,null);s=i.mapObject.renderer.drawCircle(tt);break;case"Path":v=c.point;g=new b(k,f.fill,f.border.width,f.border.color,d,f.border.opacity,u.dashArray,v);s=i.mapObject.renderer.drawPath(g)}if(!Object(r.isNullOrUndefined)(s)){for(var et="[object Array]"===Object.prototype.toString.call(i.currentLayer.shapePropertyPath)?i.currentLayer.shapePropertyPath:[i.currentLayer.shapePropertyPath],ot=void 0,w=0;w<et.length;w++)if(!Object(r.isNullOrUndefined)(c.property)){ot=et[w];break}if(s.setAttribute("aria-label",Object(r.isNullOrUndefined)(c.property)?"":c.property[ot]),s.setAttribute("tabindex",(i.mapObject.tabIndex+h+2).toString()),ti(i.mapObject.selectedElementId,i.mapObject.shapeSelectionClass,s,"ShapeselectionMapStyle"),i.mapObject.toggledShapeElementId)for(w=0;w<i.mapObject.toggledShapeElementId.length;w++)y=i.mapObject.legendSettings.toggleLegendSettings.applyShapeSettings?i.currentLayer.shapeSettings:i.mapObject.legendSettings.toggleLegendSettings,i.mapObject.toggledShapeElementId[w]===s.id&&(s.setAttribute("fill",y.fill),s.setAttribute("stroke",y.border.color),s.setAttribute("fill-opacity",y.opacity.toString()),s.setAttribute("stroke-opacity",(Object(r.isNullOrUndefined)(y.border.opacity)?y.opacity:y.border.opacity).toString()),s.setAttribute("stroke-width",y.border.width.toString()));p.appendChild(s)}h===i.currentLayer.layerData.length-1&&i.layerFeatures(n,e,t,o)};rt.bind(f);f.mapObject.trigger("shapeRendering",ut,rt)},f=this,h=0;h<this.currentLayer.layerData.length;h++)c(h);else this.layerFeatures(n,e,t,o)},n.prototype.layerFeatures=function(n,t,i,r){var o,u=this,h,c;if(this.currentLayer.bubbleSettings.length&&this.mapObject.bubbleModule)for(var e,l=this.currentLayer.bubbleSettings.length,a=function(i){e=f.currentLayer.bubbleSettings[i];o=f.mapObject.renderer.createGroup({id:f.mapObject.element.id+"_LayerIndex_"+n+"_bubble_Group_"+i});var r={min:0,max:0};f.bubbleCalculation(e,r);e.dataSource.map(function(f,s){u.renderBubble(u.currentLayer,f,t[s%t.length],r,i,s,o,n,e)});f.groupElements.push(o)},f=this,s=0;s<l;s++)a(s);this.mapObject.markerModule&&!this.mapObject.isTileMap&&this.mapObject.zoomSettings.enable&&this.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection);h=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_LayerIndex_"+n+"_dataLableIndex_Group",style:"pointer-events: none;"});this.mapObject.dataLabelModule&&this.currentLayer.dataLabelSettings.visible&&(c=[],i.map(function(t,i){u.renderLabel(u.currentLayer,n,t,h,i,r,c)}),this.groupElements.push(h));this.mapObject.navigationLineModule&&this.groupElements.push(this.mapObject.navigationLineModule.renderNavigation(this.currentLayer,this.currentFactor,n));this.groupElements.map(function(n){u.layerObject.appendChild(n)});this.mapObject.markerModule&&this.mapObject.markerModule.markerRender(this.layerObject,n,this.mapObject.isTileMap?Math.floor(this.currentFactor):this.currentFactor,null);this.translateLayerElements(this.layerObject,n);this.layerGroup.appendChild(this.layerObject)},n.prototype.renderLabel=function(n,t,i,r,u,f,e){this.mapObject.dataLabelModule.renderLabel(n,t,i,n.layerData,r,f,u,e)},n.prototype.generateMultiPolygonPath=function(n){for(var i="",t=0;t<n.length;t++)i+="M"+n[t][0].point.x+" "+n[t][0].point.y,n[t].map(function(n){i+=" L "+n.point.x+" "+n.point.y});return i},n.prototype.renderBubble=function(n,t,i,u,f,e,o,s,h){if(Object(r.isNullOrUndefined)(this.mapObject.bubbleModule)||!h.visible)return null;i=h.fill?h.fill:i;this.mapObject.bubbleModule.id=this.mapObject.element.id+"_LayerIndex_"+s+"_BubbleIndex_"+f+"_dataIndex_"+e;this.mapObject.bubbleModule.renderBubble(h,t,i,u,f,e,s,n,o,this.mapObject.bubbleModule.id)},n.prototype.getShapeColorMapping=function(n,t,i){if(i=i||n.shapeSettings.fill,0===n.shapeSettings.colorMapping.length&&Object(r.isNullOrUndefined)(n.dataSource))return i;var u=ct(n.dataSource,t,n.shapeDataPath,n.shapePropertyPath),f=new du(this.mapObject);return Object(r.isNullOrUndefined)(n.dataSource[u])?i:f.getShapeColorMapping(n.shapeSettings,n.dataSource[u],i)},n.prototype.generatePoints=function(n,t,i,r){var f,e,o=this,u=[],s,h,c,l;switch(n.toLowerCase()){case"polygon":(u=this.calculatePolygonBox(t[0],i,r)).length>0&&(u.property=r,u.type=n,u._isMultiPolygon=!1,this.currentLayer.layerData.push(u));break;case"multipolygon":for(s=[],h=0;h<t.length;h++)(u=this.calculatePolygonBox(t[h][0],i,r)).length>0&&s.push(u);s.property=r;s.type=n;s._isMultiPolygon=!0;this.currentLayer.layerData.push(s);break;case"linestring":t.map(function(n){f=n[1];e=n[0];var t=w(f,e,o.currentFactor,o.currentLayer,o.mapObject);u.push({point:t,lat:f,lng:e})});u.property=r;u.type=n;this.currentLayer.layerData.push(u);break;case"point":c=!1;(t.map(function(t){if("[object Array]"===Object.prototype.toString.call(t)){f=t[1];e=t[0];c=!0;var i=w(f,e,o.currentFactor,o.currentLayer,o.mapObject);o.currentLayer.layerData.push({point:i,type:n,lat:f,lng:e,property:r})}}),c)||(f=t[1],e=t[0],l=w(f,e,this.currentFactor,this.currentLayer,this.mapObject),this.currentLayer.layerData.push({point:l,type:n,lat:f,lng:e,property:r}));break;case"path":this.currentLayer.layerData.push({point:i.d,type:n,property:r})}},n.prototype.calculateFactor=function(n){var o,i,r,s=1,u=this.mapObject.baseMapBounds,t=new d(this.mapObject.mapAreaRect.width,this.mapObject.mapAreaRect.height-5),f,e;return u?(f=w(u.latitude.min,u.longitude.min,null,n,this.mapObject),e=w(u.latitude.max,u.longitude.max,null,n,this.mapObject),i=e.y-f.y,r=e.x-f.x):i=r=500,o=i<t.height?parseFloat(Math.abs(100*Number(t.height/Number(i.toString()+"e+1"))).toString().split(".")[0])/10:t.height/i,s=r<t.width?parseFloat(Math.abs(100*Number(t.width/Number(r.toString()+"e+1"))).toString().split(".")[0])/10:t.width/r,Math.min(s,o)},n.prototype.translateLayerElements=function(n){var t,u,s,h,i,c,f,e,o;if(this.mapObject.translateType="layer",Object(r.isNullOrUndefined)(this.mapObject.baseMapRectBounds)){if(this.mapObject.isTileMap&&!Object(r.isNullOrUndefined)(this.mapObject.scale))for(u=0;u<n.childElementCount;u++)(t=n.childNodes[u]).id.indexOf("_Markers_Group")>-1||t.id.indexOf("_bubble_Group")>-1||t.id.indexOf("_dataLableIndex_Group")>-1||t.id.indexOf("_line_Group")>-1||(o="scale( "+this.mapObject.scale+" ) translate( "+this.mapObject.translatePoint.x+" "+this.mapObject.translatePoint.y+" ) ",t.setAttribute("transform",o))}else for(s=this.currentLayer.animationDuration,h=0!==s||Object(r.isNullOrUndefined)(this.mapObject.zoomModule),this.mapObject.baseTranslatePoint=this.mapObject.zoomTranslatePoint,i=void 0,i=this.mapObject.zoomSettings.zoomFactor>1&&!Object(r.isNullOrUndefined)(this.mapObject.zoomModule)?at(this.mapObject,this.currentLayer,h):et(this.mapObject,this.currentLayer,h),c=this.mapObject.previousScale=i.scale,f=this.mapObject.previousPoint=i.location,this.mapObject.baseTranslatePoint=this.mapObject.translatePoint=f,this.mapObject.baseScale=this.mapObject.scale=c,e=0;e<n.childElementCount;e++)(t=n.childNodes[e]).id.indexOf("_Markers_Group")>-1||t.id.indexOf("_bubble_Group")>-1||t.id.indexOf("_dataLableIndex_Group")>-1||(o="scale( "+c+" ) translate( "+f.x+" "+f.y+" ) ",t.setAttribute("transform",o),s>0&&!Object(r.isNullOrUndefined)(this.mapObject.zoomModule)&&(i=this.mapObject.zoomSettings.zoomFactor>1?at(this.mapObject,this.currentLayer):et(this.mapObject,this.currentLayer),this.mapObject.scale=i.scale,this.mapObject.zoomTranslatePoint=this.mapObject.translatePoint=i.location))},n.prototype.calculateRectBounds=function(n){var t=this;Array.prototype.forEach.call(n,function(n){if(!Object(r.isNullOrUndefined)(n.geometry)||!Object(r.isNullOrUndefined)(n.coordinates)){var u=Object(r.isNullOrUndefined)(n.geometry)?n.type:n.geometry.type,i=Object(r.isNullOrUndefined)(n.geometry)?n.coordinates:n.geometry.coordinates;switch(u.toLowerCase()){case"polygon":t.calculateRectBox(i[0]);break;case"multipolygon":i.map(function(n){t.calculateRectBox(n[0])})}}})},n.prototype.calculatePolygonBox=function(n){var t=this,u=[],i=this.mapObject.baseMapBounds;return n.map(function(n){var e=n[1],o=n[0],f;o>=i.longitude.min&&o<=i.longitude.max&&e>=i.latitude.min&&e<=i.latitude.max&&(f=w(e,o,t.currentFactor,t.currentLayer,t.mapObject),Object(r.isNullOrUndefined)(t.rectBounds)?t.rectBounds={min:{x:f.x,y:f.y},max:{x:f.x,y:f.y}}:(t.rectBounds.min.x=Math.min(t.rectBounds.min.x,f.x),t.rectBounds.min.y=Math.min(t.rectBounds.min.y,f.y),t.rectBounds.max.x=Math.max(t.rectBounds.max.x,f.x),t.rectBounds.max.y=Math.max(t.rectBounds.max.y,f.y)),u.push({point:f,lat:e,lng:o}))}),u},n.prototype.calculateRectBox=function(n){var t=this;Array.prototype.forEach.call(n,function(n){Object(r.isNullOrUndefined)(t.mapObject.baseMapBounds)?t.mapObject.baseMapBounds=new rr({min:n[1],max:n[1]},{min:n[0],max:n[0]}):(t.mapObject.baseMapBounds.latitude.min=Math.min(t.mapObject.baseMapBounds.latitude.min,n[1]),t.mapObject.baseMapBounds.latitude.max=Math.max(t.mapObject.baseMapBounds.latitude.max,n[1]),t.mapObject.baseMapBounds.longitude.min=Math.min(t.mapObject.baseMapBounds.longitude.min,n[0]),t.mapObject.baseMapBounds.longitude.max=Math.max(t.mapObject.baseMapBounds.longitude.max,n[0]))})},n.prototype.generateTiles=function(n,t,i,u,f){var e,a,rt=this.mapObject.locale,h=this.mapObject.availableSize,y,p,v,c,l,w,b,k,o,ut,s,d,it,g,nt;this.tiles=[];e=a=Math.pow(2,n);y=0;p=0;t.x+256*e<h.width&&(y=t.x>0?Math.ceil(t.x/256):0,p=t.x+256*e<h.width?Math.ceil((h.width-(t.x+256*e))/256):0);e+=y+p;"Pan"===i?(e=this.horizontalPanXCount>=e?this.horizontalPanXCount:e,this.horizontalPan=!1):(this.horizontalPanXCount=e,this.horizontalPan=!0);v=this.mapObject.layers[this.mapObject.baseLayerIndex];this.urlTemplate=v.urlTemplate;var et=Math.min(a,(-t.y+h.height)/256+1),ot=Math.min(e,(-t.x+h.width+256*p)/256+1),st=-(t.x+256*y+256)/256,ht=-(t.y+256)/256;for(u=u||this.bing||this.mapObject.bingMap,c=Math.round(st);c<Math.round(ot);c++)for(l=Math.round(ht);l<Math.round(et);l++)w=256*c+t.x,b=256*l+t.y,w>-256&&w<=h.width&&b>-256&&b<h.height&&l>=0&&(k=c,c<0&&(k=k%a+a),o=new ee(k%a,l),(o.left=w,o.top=b,"Bing"===v.layerType)?(ut=v.key,o.src=u.getBingMap(o,ut,v.bingMapType,rt,u.imageUrl,u.subDomains)):o.src=this.urlTemplate.replace("level",n.toString()).replace("tileX",o.x.toString()).replace("tileY",o.y.toString()),this.tiles.push(o));Object(r.isNullOrUndefined)(i)||(i.indexOf("wheel")>1?(this.animateToZoomX=this.mapObject.availableSize.width/2-f.x-10,this.animateToZoomY=-f.y):(this.animateToZoomX=-10,this.animateToZoomY=10-(this.mapObject.availableSize.height/2+11.5)));for(var ct=Object(r.extend)([],this.tiles,[],!0),tt=0,ft=this.mapObject.layers;tt<ft.length;tt++)if(s=ft[tt],"SubLayer"===s.type&&s.visible&&("OSM"===s.layerType||"Bing"===s.layerType))for(d=0,it=ct;d<it.length;d++)g=it[d],nt=Object(r.extend)({},g,{},!0),nt.src="Bing"===s.layerType?u.getBingMap(nt,s.key,s.bingMapType,rt,u.imageUrl,u.subDomains):s.urlTemplate.replace("level",n.toString()).replace("tileX",g.x.toString()).replace("tileY",g.y.toString()),this.tiles.push(nt);this.arrangeTiles(i,this.animateToZoomX,this.animateToZoomY)},n.prototype.arrangeTiles=function(n,t,i){var o,u=this,f=document.getElementById(this.mapObject.element.id+"_tile_parent"),e=document.getElementById(this.mapObject.element.id+"_tiles");Object(r.isNullOrUndefined)(n)||"Pan"===n||"Reset"===n||-1!==n.indexOf("ZoomOut")?o=0:(this.tileAnimation(n,t,i),o=250);"GoogleStaticMap"===this.mapObject.layers[this.mapObject.baseLayerIndex].layerType?this.renderGoogleMap(this.mapObject.layers[0].key,this.mapObject.staticMapZoom):setTimeout(function(){var t;f&&(f.style.zIndex="1");e&&(e.style.zIndex="0",e.style.visibility="hidden");!document.getElementById(u.mapObject.element.id+"_animated_tiles")&&f?(t=Object(r.createElement)("div",{id:u.mapObject.element.id+"_animated_tiles"}),f.appendChild(t)):"Pan"!==n&&e&&f?(e.appendChild(f.children[0]),Object(r.isNullOrUndefined)(document.getElementById(u.mapObject.element.id+"_animated_tiles"))||(document.getElementById(u.mapObject.element.id+"_animated_tiles").id=u.mapObject.element.id+"_animated_tiles_old"),t=Object(r.createElement)("div",{id:u.mapObject.element.id+"_animated_tiles"}),f.appendChild(t)):t=f?f.children[0]:null;for(var i=0,h=function(f){var o=Object(r.createElement)("img"),e;o.setAttribute("src",f.src);e=u.mapObject.element.id;o.onload=function(){document.getElementById(e+"_tile_"+i)&&"Pan"===n&&a(e+"_tile_"+i);var s=Object(r.createElement)("div",{id:e+"_tile_"+i});s.style.position="absolute";s.style.left=f.left+"px";s.style.top=f.top+"px";s.style.height=f.height+"px";s.style.width=f.width+"px";s.appendChild(o);t&&t.appendChild(s);++i===u.tiles.length&&document.getElementById(u.mapObject.element.id+"_animated_tiles_old")&&a(u.mapObject.element.id+"_animated_tiles_old")}},o=0,s=u.tiles;o<s.length;o++)h(s[o])},o)},n.prototype.tileAnimation=function(n,t,i){var o=document.getElementById(this.mapObject.element.id+"_tile_parent"),f=document.getElementById("animated_tiles"),u=document.getElementById(this.mapObject.element.id+"_tiles"),e="2";if(0===n.indexOf("ZoomOut")){for(u.style.zIndex="1",o.style.zIndex="0";u.childElementCount>=1;)u.removeChild(u.children[0]);t=0;i=105;e="0.5"}else if("Reset"===n){for(u.style.zIndex="1",o.style.zIndex="0";1!==u.childElementCount&&0!==u.childElementCount;)u.removeChild(u.children[1]);f=u.children[0];t=0;i=0;e="1"}Object(r.isNullOrUndefined)(f)||(f.style.transition="250ms",f.style.transform="translate("+t+"px, "+i+"px) scale("+e+")")},n.prototype.renderGoogleMap=function(n,t){var i=this.mapObject,u,f,e;t=this.mapObject.tileZoomLevel;var s=256*Math.pow(2,t),a=i.mapAreaRect.width/2-s/2,v=i.mapAreaRect.height/2-s/2,h=0,c=0,l=ut(new o(null,null),t,{x:a,y:v},this.isMapCoordinates);i.zoomModule&&i.zoomSettings.enable&&(h=i.zoomModule.mouseDownLatLong.x-i.zoomModule.mouseMoveLatLong.x,c=i.zoomModule.mouseDownLatLong.y-i.zoomModule.mouseMoveLatLong.y);e=i.pointToLatLong(l.x-h,l.y-c);i.centerPosition.latitude=e.latitude;i.centerPosition.longitude=e.longitude;var y=(u=Object(r.isNullOrUndefined)(parseInt(i.width,10))?parseInt(i.width,10)-22:Math.round(i.mapAreaRect.width))>640?(u-640)/2:0,p=(f=Object(r.isNullOrUndefined)(parseInt(i.height,10))?parseInt(i.height,10)-22:Math.round(i.mapAreaRect.height))>640?(f-640)/2:0,w=i.layers[i.layers.length-1].staticMapType.toString().toLowerCase(),b="https://maps.googleapis.com/maps/api/staticmap?size="+u+"x"+f+"&zoom="+t+"&center="+(i.centerPosition.latitude&&i.centerPosition.longitude?i.centerPosition.latitude.toString()+","+i.centerPosition.longitude.toString():"0,0")+"&maptype="+w+"&key="+n;document.getElementById(this.mapObject.element.id+"_tile_parent").innerHTML='<div id="'+this.mapObject.element.id+'_StaticGoogleMap"style="position:absolute; left:'+y+"px; top:"+p+'px"><img src="'+b+'"><\/div>'},n.prototype.panTileMap=function(n,t,i){var l,a;this.mapObject.tileZoomLevel<=this.mapObject.tileZoomScale&&this.mapObject.initialCheck&&(this.mapObject.tileZoomLevel=this.mapObject.tileZoomScale);var f,u,e=this.mapObject.tileZoomLevel,s="GoogleStaticMap"!==this.mapObject.layers[this.mapObject.layers.length-1].layerType?20:0,h=256*Math.pow(2,e),c=ut(i,e,{x:f=n/2-h/2,y:u=t/2-h/2},this.isMapCoordinates);return(s=this.mapObject.zoomNotApplied?0:s,f-=c.x-n/2,u=u-(c.y-t/2)+s,this.mapObject.scale=Math.pow(2,e-1),(Object(r.isNullOrUndefined)(this.mapObject.tileTranslatePoint)||0===this.mapObject.tileTranslatePoint.y&&0===this.mapObject.tileTranslatePoint.x||Object(r.isNullOrUndefined)(this.mapObject.previousTileWidth)||Object(r.isNullOrUndefined)(this.mapObject.previousTileHeight))&&(this.mapObject.previousTileWidth=n,this.mapObject.previousTileHeight=t),Object(r.isNullOrUndefined)(this.mapObject.tileTranslatePoint)||!Object(r.isNullOrUndefined)(i.x)||1!==this.mapObject.zoomSettings.zoomFactor&&this.mapObject.zoomSettings.zoomFactor===e&&this.mapObject.defaultState||n===this.mapObject.previousTileWidth&&t===this.mapObject.previousTileHeight)||(l=f-(this.mapObject.previousTileWidth/2-h/2),a=u-(this.mapObject.previousTileHeight/2-h/2+s),this.mapObject.tileTranslatePoint.x=this.mapObject.tileTranslatePoint.x+l,this.mapObject.tileTranslatePoint.y=this.mapObject.tileTranslatePoint.y+a),Object(r.isNullOrUndefined)(this.mapObject.tileTranslatePoint)||this.mapObject.zoomNotApplied||(0===this.mapObject.tileTranslatePoint.x||this.mapObject.tileTranslatePoint.x===f||this.mapObject.centerPositionChanged||(f=this.mapObject.tileTranslatePoint.x),0===this.mapObject.tileTranslatePoint.y||this.mapObject.tileTranslatePoint.y===u||this.mapObject.centerPositionChanged||(u=this.mapObject.tileTranslatePoint.y)),this.mapObject.translatePoint=new o((f-.01*this.mapObject.zoomSettings.zoomFactor)/this.mapObject.scale,(u-.01*this.mapObject.zoomSettings.zoomFactor)/this.mapObject.scale),this.mapObject.previousTileWidth=n,this.mapObject.previousTileHeight=t,new o(f,u)},n}(),gu=function(){function n(n){this.map=n}return n.prototype.renderAnnotationElements=function(){var i=this,t=this.map.element.id+"_Secondary_Element",n=Object(r.createElement)("div",{id:this.map.element.id+"_Annotations_Group"});n.style.position="absolute";n.style.top="0px";n.style.left="0px";this.map.annotations.map(function(t,r){null!==t.content&&i.createAnnotationTemplate(n,t,r)});n.childElementCount>0&&!Object(r.isNullOrUndefined)(e(t))&&e(t).appendChild(n);this.map.renderReactTemplates()},n.prototype.createAnnotationTemplate=function(n,t,i){var u,f,y,p,e=this,o=this.map,w=o.availableSize,s=(o.element.id,Object(r.createElement)("div",{id:o.element.id+"_Annotation_"+i,styles:"position: absolute; z-index:"+t.zIndex+";"})),h={cancel:!1,name:"annotationRendering",content:t.content,annotation:t},l,a;this.map.trigger("annotationRendering",h,function(){if(!h.cancel)if((y=ui(h.content))&&y(e.map,e.map,h.content,e.map.element.id+"_ContentTemplate_"+i).length)for(var t=(p=Array.prototype.slice.call(y(e.map,e.map,h.content,e.map.element.id+"_ContentTemplate_"+i))).length,n=0;n<t;n++)s.appendChild(p[n]);else s.appendChild(Object(r.createElement)("div",{innerHTML:h.content}))});var v=function(n,t){t.appendChild(n);var i=n.offsetWidth,r=n.offsetHeight;return t.removeChild(n),new d(i,r)}(s.cloneNode(!0),o.element),b=o.element.getBoundingClientRect(),c=o.svgObject.getBoundingClientRect();u=Math.abs(c.left-b.left);f=Math.abs(c.top-b.top);l=t.x.indexOf("%")>-1?w.width/100*parseFloat(t.x):parseFloat(t.x);a=t.y.indexOf("%")>-1?w.height/100*parseFloat(t.y):parseFloat(t.y);switch(u="None"===t.horizontalAlignment?u+l:u,f="None"===t.verticalAlignment?f+a:f,t.verticalAlignment){case"Near":f+=a;break;case"Center":f=f+a+(c.height/2-v.height/2);break;case"Far":f=f+c.height+a-v.height}switch(t.horizontalAlignment){case"Near":u+=l;break;case"Center":u=u+l+(c.width/2-v.width/2);break;case"Far":u=u+c.width+l-v.width}s.style.left=u+"px";s.style.top=f+"px";n.appendChild(s)},n.prototype.getModuleName=function(){return"Annotations"},n.prototype.destroy=function(){},n}(),tt=i(1),ce=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),f=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},nf=function(n){function t(t,i){var u=n.call(this,t,i)||this;return u.isTileMap=!1,u.isResize=!1,u.baseSize=new d(0,0),u.translatePoint=new o(0,0),u.baseTranslatePoint=new o(0,0),u.zoomTranslatePoint=new o(0,0),u.markerZoomedState=!0,u.zoomPersistence=!1,u.defaultState=!0,u.centerPositionChanged=!1,u.isTileMapSubLayer=!1,u.markerNullCount=0,u.tileTranslatePoint=new o(0,0),u.baseTileTranslatePoint=new o(0,0),u.isDevice=!1,u.staticMapZoom=u.zoomSettings.enable?u.zoomSettings.zoomFactor:0,u.zoomNotApplied=!1,u.dataLabelShape=[],u.zoomShapeCollection=[],u.zoomLabelPositions=[],u.mouseDownEvent={x:null,y:null},u.mouseClickEvent={x:null,y:null},u.selectedElementId=[],u.selectedMarkerElementId=[],u.selectedBubbleElementId=[],u.selectedNavigationElementId=[],u.selectedLegendElementId=[],u.legendSelectionCollection=[],u.shapeSelections=!0,u.legendSelection=!0,u.toggledLegendId=[],u.toggledShapeElementId=[],u.checkInitialRender=!0,u.initialTileTranslate=new o(0,0),u.initialCheck=!0,u.applyZoomReset=!1,u.markerClusterExpandCheck=!1,u.markerClusterExpand=!1,u.shapeSelectionItem=[],Object(r.setValue)("mergePersistData",u.mergePersistMapsData,u),u}return ce(t,n),Object.defineProperty(t.prototype,"isShapeSelected",{get:function(){return this.mapSelect},enumerable:!0,configurable:!0}),t.prototype.mergePersistMapsData=function(){var t,f,i,o,u,e,n;try{f=window.localStorage}catch(t){f=null}if(Object(r.isNullOrUndefined)(f)||(t=window.localStorage.getItem(this.getModuleName()+this.element.id)),!Object(r.isNullOrUndefined)(t)&&""!==t){for(i=JSON.parse(t),o=Object.keys(i),this.isProtectedOnChange=!0,u=0,e=o;u<e.length;u++)n=e[u],"object"!=typeof this[n]||Object(r.isNullOrUndefined)(this[n])?this[n]=i[n]:Object(r.extend)(this[n],i[n]);this.isProtectedOnChange=!1}},t.prototype.getLocalizedLabel=function(n){return this.localeObject.getConstant(n)},t.prototype.preRender=function(){this.isDevice=r.Browser.isDevice;this.initPrivateVariable();this.allowServerDataBinding=!1;this.unWireEVents();this.wireEVents();this.setCulture()},t.prototype.renderElements=function(){this.trigger("load",{maps:this});this.createSVG();this.findBaseAndSubLayers();this.createSecondaryElement();this.addTabIndex();this.themeStyle=function(n){var t,i;switch(n.toLowerCase()){case"materialdark":i="#303030";break;case"fabricdark":i="#201F1F";break;case"bootstrapdark":i="#1A1A1A"}switch(n.toLowerCase()){case"materialdark":case"fabricdark":case"bootstrapdark":t={backgroundColor:i,areaBackgroundColor:i,titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#DADADA",legendTextColor:"#DADADA",dataLabelFontColor:"#DADADA",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#363F4C",zoomFillColor:"#FFFFFF",labelFontFamily:"Roboto, Noto, Sans-serif",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6"};break;case"highcontrast":t={backgroundColor:"#000000",areaBackgroundColor:"#000000",titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#FFFFFF",legendTextColor:"#FFFFFF",dataLabelFontColor:"#000000",tooltipFontColor:"#000000",tooltipFillColor:"#ffffff",zoomFillColor:"#FFFFFF",labelFontFamily:"Roboto, Noto, Sans-serif",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6"};break;case"bootstrap4":t={backgroundColor:"#FFFFFF",areaBackgroundColor:"#FFFFFF",titleFontColor:"#212529",subTitleFontColor:"#212529",legendTitleFontColor:"#212529",legendTextColor:"#212529",dataLabelFontColor:"#212529",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#000000",zoomFillColor:"#5B6269",fontFamily:"HelveticaNeue-Medium",titleFontSize:"16px",legendFontSize:"14px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"HelveticaNeue-Medium",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6"};break;case"tailwind":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#374151",subTitleFontColor:"#374151",legendTitleFontColor:"#374151",legendTextColor:"#6B7280",dataLabelFontColor:"#505967",tooltipFontColor:"#F9FAFB",tooltipFillColor:"#111827",zoomFillColor:"#6b7280",fontFamily:"Inter",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"Inter",titleFontWeight:"500",zoomSelectionColor:"#374151",shapeFill:"#E5E7EB"};break;case"tailwinddark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#D1D5DB",subTitleFontColor:"#D1D5DB",legendTitleFontColor:"#D1D5DB",legendTextColor:"#D1D5DB",dataLabelFontColor:"#D1D5DB",tooltipFontColor:"#1F2937",tooltipFillColor:"#F9FAFB",zoomFillColor:"#D1D5DB",fontFamily:"Inter",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"Inter",titleFontWeight:"500",zoomSelectionColor:"#F3F4F6",shapeFill:"#374151"};break;case"bootstrap5":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#212529",subTitleFontColor:"#212529",legendTitleFontColor:"#212529",legendTextColor:"#212529",dataLabelFontColor:"#212529",tooltipFontColor:"#F9FAFB",tooltipFillColor:"#212529",zoomFillColor:"#6C757D",fontFamily:"Helvetica Neue",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Helvetica Neue",titleFontWeight:"normal",zoomSelectionColor:"#343A40",shapeFill:"#E9ECEF"};break;case"bootstrap5dark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#FFFFFF",legendTextColor:"#FFFFFF",dataLabelFontColor:"#FFFFFF",tooltipFontColor:"#212529",tooltipFillColor:"#E9ECEF",zoomFillColor:"#B5BABE",fontFamily:"Helvetica Neue",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Helvetica Neue",titleFontWeight:"normal",zoomSelectionColor:"#DEE2E6",shapeFill:"#495057"};break;default:t={backgroundColor:"#FFFFFF",areaBackgroundColor:"#FFFFFF",titleFontColor:"#424242",subTitleFontColor:"#424242",legendTitleFontColor:"#757575",legendTextColor:"#757575",dataLabelFontColor:"#000000",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#000000",zoomFillColor:"#737373",labelFontFamily:"Roboto, Noto, Sans-serif",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6"}}return t}(this.theme);this.renderBorder();this.renderTitle(this.titleSettings,"title",null,null);this.renderArea();this.processRequestJsonData();this.renderComplete()},t.prototype.render=function(){this.renderElements()},t.prototype.processRequestJsonData=function(){var t,i,n=this,u=this.layersCollection.length-1;this.serverProcess={request:0,response:0};Array.prototype.forEach.call(this.layersCollection,function(f,e){var s,o,h;if(f.shapeData instanceof tt.DataManager?(n.serverProcess.request++,i=f.shapeData,t=f.query instanceof tt.Query?f.query:new tt.Query,i.executeQuery(t).then(function(t){n.processResponseJsonData("DataManager",t,f,"ShapeData")})):(f.shapeData instanceof pi||f.shapeData)&&(Object(r.isNullOrUndefined)(f.shapeData.dataOptions)||n.processAjaxRequest(f,f.shapeData,"ShapeData")),f.dataSource instanceof tt.DataManager&&(n.serverProcess.request++,i=f.dataSource,t=f.query instanceof tt.Query?f.query:new tt.Query,i.executeQuery(t).then(function(n){f.dataSource=pt(n)})),f.markerSettings.length>0)for(s=function(r){f.markerSettings[r].dataSource instanceof tt.DataManager&&(n.serverProcess.request++,i=f.markerSettings[r].dataSource,t=f.markerSettings[r].query instanceof tt.Query?f.markerSettings[r].query:new tt.Query,i.executeQuery(t).then(function(n){f.markerSettings[r].dataSource=pt(n)}))},o=0;o<f.markerSettings.length;o++)s(o);if(f.bubbleSettings.length>0)for(h=function(r){f.bubbleSettings[r].dataSource instanceof tt.DataManager&&(n.serverProcess.request++,i=f.bubbleSettings[r].dataSource,t=f.bubbleSettings[r].query instanceof tt.Query?f.bubbleSettings[r].query:new tt.Query,i.executeQuery(t).then(function(n){f.bubbleSettings[r].dataSource=pt(n)}))},o=0;o<f.bubbleSettings.length;o++)h(o);(f.dataSource instanceof pi||!Object(r.isNullOrUndefined)(f.dataSource.dataOptions))&&n.processAjaxRequest(f,f.dataSource,"DataSource");n.serverProcess.request===n.serverProcess.response&&u===e&&n.processResponseJsonData(null)})},t.prototype.processAjaxRequest=function(n,t,i){var f=this,u;this.serverProcess.request++;u=new r.Ajax(t.dataOptions,t.type,t.async,t.contentType);u.onSuccess=function(t){f.processResponseJsonData("Ajax",t,n,i)};u.send(t.sendData)},t.prototype.processResponseJsonData=function(n,t,i,u){var f,e,o;if(this.serverProcess.response++,n&&("ShapeData"===u?i.shapeData="DataManager"===n?pt(t):JSON.parse(t):i.dataSource="DataManager"===n?pt(t):JSON.parse("["+t+"]")[0]),Object(r.isNullOrUndefined)(n)||this.serverProcess.request!==this.serverProcess.response)Object(r.isNullOrUndefined)(n)&&this.renderMap();else{for(f=this.layersCollection,this.layersCollection=[],e=0;e<f.length;e++)f[e].isBaseLayer&&this.layersCollection.push(f[e]);for(o=0;o<f.length;o++)f[o].isBaseLayer||this.layersCollection.push(f[o]);this.renderMap()}},t.prototype.renderMap=function(){var p,n,l,a,t,i,h,s,c;for(this.legendModule&&this.legendSettings.visible&&(this.isTileMap?(p=this.layersCollection.length-1,this.layersCollection[p].isBaseLayer||(this.isTileMapSubLayer=!0,this.legendModule.renderLegend())):this.legendModule.renderLegend()),this.createTile(),this.zoomSettings.enable&&this.zoomModule&&this.zoomModule.createZoomingToolbars(),Object(r.isNullOrUndefined)(this.dataLabelModule)||(this.dataLabelModule.dataLabelCollections=[],this.dataLabelShape=[]),this.mapLayerPanel.measureLayerPanel(),this.element.appendChild(this.svgObject),n=0;n<this.layers.length;n++){if(this.layers[n].selectionSettings&&this.layers[n].selectionSettings.enable&&this.layers[n].initialShapeSelection.length>0&&this.checkInitialRender){for(l=this.layers[n].selectionSettings.enableMultiSelect,this.layers[n].selectionSettings.enableMultiSelect=l||!0,a=this.layers[n].initialShapeSelection,t=0;t<this.layers[n].initialShapeSelection.length;t++)this.shapeSelection(n,a[t].shapePath,a[t].shapeValue,!0);this.layers[n].selectionSettings.enableMultiSelect=l;n===this.layers.length-1&&(this.checkInitialRender=!1)}for(i=0;i<this.layers[n].markerSettings.length;i++)if(this.layers[n].markerSettings[i].selectionSettings&&this.layers[n].markerSettings[i].selectionSettings.enable&&this.layers[n].markerSettings[i].initialMarkerSelection.length>0)for(h=this.layers[n].markerSettings[i].initialMarkerSelection,t=0;t<h.length;t++)this.markerInitialSelection(n,i,this.layers[n].markerSettings[i],h[t].latitude,h[t].longitude)}if(!Object(r.isNullOrUndefined)(document.getElementById(this.element.id+"_tile_parent"))){var f,b=this.svgObject.getBoundingClientRect(),e=document.getElementById(this.element.id),u=document.getElementById(this.element.id+"_tile_parent"),w=document.getElementById(this.element.id+"_tiles"),k=u.getBoundingClientRect(),y=void 0,o=void 0;o=parseFloat(u.style.left)+e.offsetLeft;s=v(this.titleSettings.text,this.titleSettings.textStyle);c=v(this.titleSettings.subtitleSettings.text,this.titleSettings.subtitleSettings.textStyle);this.isTileMap&&this.isTileMapSubLayer&&"Bottom"===this.legendSettings.position&&this.legendSettings.visible?"Default"!==this.legendSettings.mode?f=0!==s.width&&0!==s.height?parseFloat(u.style.top)+e.offsetTop+c.height/2-this.legendModule.legendBorderRect.height/2:parseFloat(u.style.top)+e.offsetTop-this.mapAreaRect.y:(o=this.legendModule.legendBorderRect.x,f=0!==s.width&&0!==s.height?parseFloat(u.style.top)+e.offsetTop+c.height/2-this.legendModule.legendBorderRect.y:parseFloat(u.style.top)+e.offsetTop+c.height/2):(y=b.bottom-k.bottom-e.offsetTop,f=parseFloat(u.style.top)+e.offsetTop);f=y<=11?f:2*f;o=y<=11?o:2*o;u.style.top=f+"px";u.style.left=o+"px";w.style.top=f+"px";w.style.left=o+"px"}for(this.arrangeTemplate(),this.annotationsModule&&"0px"!==this.width&&"0px"!==this.height&&"0%"!==this.width&&"0%"!==this.height&&this.annotationsModule.renderAnnotationElements(),this.element.style.outline="none",n=0;n<document.getElementsByTagName("path").length-1;n++)document.getElementsByTagName("path")[n].id.indexOf("shapeIndex")>-1&&(document.getElementsByTagName("path")[n].style.outline="none");this.zoomingChange();this.trigger("loaded",{maps:this,isResized:this.isResize});this.isResize=!1},t.prototype.markerSelection=function(n,t,i,r){var f={color:n.border.color,width:n.border.width/t.scale},u={opacity:n.opacity,fill:n.fill,border:f,target:i.id,cancel:!1,data:r,maps:t};c("MarkerselectionMap")?vt("MarkerselectionMap","MarkerselectionMapStyle",u):document.body.appendChild(ei("MarkerselectionMap","MarkerselectionMapStyle",u));(0===this.selectedMarkerElementId.length||n.enableMultiSelect)&&("g"===i.tagName?i.children[0].setAttribute("class","MarkerselectionMapStyle"):i.setAttribute("class","MarkerselectionMapStyle"))},t.prototype.markerInitialSelection=function(n,t,i,r,u){var o=i.selectionSettings,f,e,s;if(o.enable)for(f=0;f<i.dataSource.length;f++)e=i.dataSource[f],e.latitude===r&&e.longitude===u&&(s=this.element.id+"_LayerIndex_"+n+"_MarkerIndex_"+t+"_dataIndex_"+f,this.markerSelection(o,this,c(s),e))},t.prototype.renderArea=function(){var u=this.mapsArea.border.width,n=this.mapsArea.background,t,i;(u>0||n||this.themeStyle.areaBackgroundColor)&&(t={opacity:Object(r.isNullOrUndefined)(this.mapsArea.border.opacity)?1:this.mapsArea.border.opacity,color:this.mapsArea.border.color,width:this.mapsArea.border.width},i=new k(this.element.id+"_MapAreaBorder",n||this.themeStyle.areaBackgroundColor,t,1,this.mapAreaRect),this.svgObject.appendChild(this.renderer.drawRectangle(i)))},t.prototype.addTabIndex=function(){this.element.setAttribute("aria-label",this.description||"Maps Element");this.element.setAttribute("tabindex",this.tabIndex.toString())},t.prototype.zoomingChange=function(){var s,h,c,l,t,n,a,i,u,v,o,f;if((e(this.element.id+"_Layer_Collections")&&this.zoomModule&&(this.zoomModule.layerCollectionEle=e(this.element.id+"_Layer_Collections")),this.isTileMap&&e(this.element.id+"_Tile_SVG")&&e(this.element.id+"_tile_parent"))&&(c=e(this.element.id+"_tile_parent").getBoundingClientRect(),l=e(this.element.id+"_Tile_SVG").getBoundingClientRect(),s=c.left-l.left,h=c.top-l.top,e(this.element.id+"_Tile_SVG_Parent").style.left=s+"px",e(this.element.id+"_Tile_SVG_Parent").style.top=h+"px",t=document.getElementsByClassName("template"),!Object(r.isNullOrUndefined)(t)&&t.length>0))for(n=0;n<t.length;n++)a=t[n],a.style.left=s+"px",a.style.top=h+"px";if(this.zoomSettings.zoomFactor>=0){if(this.zoomModule&&this.zoomModule.toolBarGroup&&this.zoomSettings.enable&&this.zoomModule.alignToolBar(),i=document.getElementById(this.element.id+"_Layer_Collections"),!Object(r.isNullOrUndefined)(i)&&i.childElementCount>0)for(n=0;n<i.childNodes.length;n++)if(u=i.childNodes[n],"g"===u.tagName)for(v=parseFloat(u.id.split("_LayerIndex_")[1].split("_")[0]),o=0;o<u.childNodes.length;o++)f=u.childNodes[o],f.id.indexOf("_Markers_Group")>-1||f.id.indexOf("_bubble_Group")>-1||f.id.indexOf("_dataLableIndex_Group")>-1||wr(f,v,this.scale,this);this.zoomModule&&this.previousScale!==this.scale&&this.zoomModule.applyTransform(!0)}},t.prototype.createSecondaryElement=function(){if(Object(r.isNullOrUndefined)(document.getElementById(this.element.id+"_Secondary_Element"))){var n=Object(r.createElement)("div",{id:this.element.id+"_Secondary_Element",styles:"position: absolute;z-index:2;"});this.element.appendChild(n)}},t.prototype.arrangeTemplate=function(){var f,o,t,i,s,n,h;if(document.getElementById(this.element.id+"_Legend_Border")&&(document.getElementById(this.element.id+"_Legend_Border").style.pointerEvents="none"),f=document.getElementsByClassName(this.element.id+"_template"),!Object(r.isNullOrUndefined)(f)&&f.length>0&&e(this.element.id+"_Layer_Collections")&&"OSM"!==this.layers[this.layers.length-1].layerType)for(o=0;o<f.length;o++){var c=0,l=0,u=f[o];if(!Object(r.isNullOrUndefined)(u)&&u.childElementCount>0)for(t=e(this.element.id+"_Layer_Collections").getBoundingClientRect(),i=e(u.id).getBoundingClientRect(),-1===u.id.indexOf("Marker")&&(c=this.isTileMap?0:t.left<i.left?-Math.abs(i.left-t.left):Math.abs(i.left-t.left),l=this.isTileMap?0:t.top<i.top?-Math.abs(i.top-t.top):Math.abs(i.top-t.top)),s=0;s<u.childElementCount;s++)n=u.childNodes[s],-1!==n.id.indexOf("Marker")?(h=e(n.id).getBoundingClientRect(),n.style.left=parseFloat(n.style.left)-(this.isTileMap?0:h.width/2)+"px",n.style.top=parseFloat(n.style.top)-(this.isTileMap?0:h.height/2)+"px"):(n.style.left=parseFloat(n.style.left)+c+"px",n.style.top=parseFloat(n.style.top)+l+"px",n.style.transform="translate(-50%, -50%)")}},t.prototype.createTile=function(){var n=this.layersCollection[0],t,i;n.isBaseLayer&&("OSM"===n.layerType||"Bing"===n.layerType||"GoogleStaticMap"===n.layerType||"Google"===n.layerType)&&("Google"===n.layerType&&(n.urlTemplate="https://mt1.google.com/vt/lyrs=m@129&hl=en&x=tileX&y=tileY&z=level"),a(this.element.id+"_tile_parent"),a(this.element.id+"_tiles"),a("animated_tiles"),t=Object(r.createElement)("div",{id:this.element.id+"_tile_parent",styles:"position: absolute; left: "+this.mapAreaRect.x+"px; right: "+this.margin.right+"px; top: "+(this.mapAreaRect.y+0)+"px; height: "+this.mapAreaRect.height+"px; width: "+this.mapAreaRect.width+"px; overflow: hidden;"}),i=Object(r.createElement)("div",{id:this.element.id+"_tiles",styles:"position: absolute; left: "+this.mapAreaRect.x+"px;  right: "+this.margin.right+"px; top: "+(this.mapAreaRect.y+0)+"px; height: "+this.mapAreaRect.height+"px; width: "+this.mapAreaRect.width+"px; overflow: hidden;"}),this.element.appendChild(t),this.element.appendChild(i))},t.prototype.initPrivateVariable=function(){if(""===this.element.id){var n=document.getElementsByClassName("e-maps").length;this.element.id="maps_control_"+n}this.renderer=new st.SvgRenderer(this.element.id);this.mapLayerPanel=new he(this)},t.prototype.findBaseAndSubLayers=function(){var u=this,f=this.baseLayerIndex,t=[],r=[],n,i;for(this.layersCollection=[],Array.prototype.forEach.call(this.layers,function(n){"Layer"===n.type?t.push(n):r.push(n)}),n=0;n<t.length;n++){if(i=t[n],i.visible&&f===n){i.isBaseLayer=!0;this.isTileMap="Geometry"!==i.layerType;this.layersCollection.push(i);break}if(n===t.length-1){this.layersCollection.push(t[0]);break}}r.map(function(n){n.visible&&u.layersCollection.push(n)})},t.prototype.renderBorder=function(){var n=this.border.width,t=this.svgObject.querySelector("#"+this.element.id+"_MapBorder"),i,u;(n>0||this.background||this.themeStyle.backgroundColor)&&Object(r.isNullOrUndefined)(t)?(i={opacity:Object(r.isNullOrUndefined)(this.border.opacity)?1:this.border.opacity,color:this.border.color,width:this.border.width},u=new k(this.element.id+"_MapBorder",this.background||this.themeStyle.backgroundColor,i,1,new y(n/2,n/2,this.availableSize.width-n,this.availableSize.height-n)),this.svgObject.appendChild(this.renderer.drawRectangle(u))):t.setAttribute("fill",this.background||this.themeStyle.backgroundColor)},t.prototype.renderTitle=function(n,t,i,u){var e,f=n.textStyle,h=Math.abs(this.margin.left+this.margin.right-this.availableSize.width);if(f.fontFamily=this.themeStyle.fontFamily||f.fontFamily,f.fontWeight=f.fontWeight||this.themeStyle.titleFontWeight,f.size=this.themeStyle.titleFontSize||f.size,n.text){Object(r.isNullOrUndefined)(u)&&(u=this.renderer.createGroup({id:this.element.id+"_Title_Group"}));var a=nt(h,n.text,f),c=v(a,f),s=function(n,t,i,r){var u,f;switch(t){case"Near":u=n.x;break;case"Center":u="title"===r?n.width/2-i.width/2:n.x+n.width/2-i.width/2;break;case"Far":u="title"===r?n.width-n.y-i.width:n.x+n.width-i.width}return f="title"===r?n.y+i.height/2:n.y+n.height/2+i.height/2,new o(u,f)}(Object(r.isNullOrUndefined)(i)?new y(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height):i,n.alignment,c,t),w=new it(this.element.id+"_Map_"+t,s.x,s.y,"start",a),l=new y(s.x,s.y,c.width,c.height),p=ht(w,f,f.color||("title"===t?this.themeStyle.titleFontColor:this.themeStyle.subTitleFontColor),u);p.setAttribute("aria-label",this.description||n.text);p.setAttribute("tabindex",(this.tabIndex+("title"===t?1:2)).toString());("title"===t&&!n.subtitleSettings.text||"subtitle"===t)&&(e=Math.abs(l.y+this.margin.bottom-this.availableSize.height),this.mapAreaRect=new y(this.margin.left,l.y+10,h,e-10));"subtitle"!==t&&n.subtitleSettings.text?this.renderTitle(n.subtitleSettings,"subtitle",l,u):this.svgObject.appendChild(u)}else e=Math.abs(this.margin.top+this.margin.bottom-this.availableSize.height),this.mapAreaRect=new y(this.margin.left,this.margin.top,h,e)},t.prototype.createSVG=function(){this.removeSvg();rf(this)},t.prototype.removeSvg=function(){if(a(this.element.id+"_Secondary_Element"),a(this.element.id+"_tile_parent"),a(this.element.id+"_tiles"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&Object(r.remove)(this.svgObject)}this.clearTemplate()},t.prototype.wireEVents=function(){r.EventHandler.add(this.element,"click",this.mapsOnClick,this);r.EventHandler.add(this.element,"dblclick",this.mapsOnDoubleClick,this);r.EventHandler.add(this.element,r.Browser.touchStartEvent,this.mouseDownOnMap,this);r.EventHandler.add(this.element,r.Browser.touchMoveEvent,this.mouseMoveOnMap,this);r.EventHandler.add(this.element,r.Browser.touchEndEvent,this.mouseEndOnMap,this);r.EventHandler.add(this.element,"pointerleave mouseleave",this.mouseLeaveOnMap,this);window.addEventListener(r.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.mapsOnResize.bind(this))},t.prototype.unWireEVents=function(){r.EventHandler.remove(this.element,"click",this.mapsOnClick);r.EventHandler.remove(this.element,"dblclick",this.mapsOnDoubleClick);r.EventHandler.remove(this.element,r.Browser.touchStartEvent,this.mouseDownOnMap);r.EventHandler.remove(this.element,r.Browser.touchMoveEvent,this.mouseMoveOnMap);r.EventHandler.remove(this.element,r.Browser.touchEndEvent,this.mouseEndOnMap);r.EventHandler.remove(this.element,"pointerleave mouseleave",this.mouseLeaveOnMap);window.removeEventListener(r.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.mapsOnResize)},t.prototype.mouseLeaveOnMap=function(){document.getElementsByClassName("highlightMapStyle").length>0&&this.legendModule&&(this.legendModule.removeShapeHighlightCollection(),p(document.getElementsByClassName("highlightMapStyle")[0]))},t.prototype.SelectedElement=function(n){var t=!1;return"ShapeselectionMapStyle"===n.getAttribute("class")&&(t=!0),t},t.prototype.mapsOnClick=function(n){var t=this,i=n.target,e=i.id,o=null,s=null,u,f;(this.mouseClickEvent={x:n.x,y:n.y},-1===i.id.indexOf("_ToolBar"))&&(u=this.getClickLocation(e,n.pageX,n.pageY,i,n.layerX,n.layerY),Object(r.isNullOrUndefined)(u)||(o=u.latitude,s=u.longitude),f={cancel:!1,name:ft,target:e,x:n.clientX,y:n.clientY,latitude:o,longitude:s,isShapeSelected:this.SelectedElement(i)},this.trigger("click",f,function(){if(i.id.indexOf("shapeIndex")>-1&&(t.mergeCluster(),c(t.element.id+"_mapsTooltip")&&t.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")>-1&&a(t.element.id+"_mapsTooltip")),t.markerModule&&(t.markerModule.markerClick(n),t.markerModule.markerClusterClick(n)),t.bubbleModule&&t.bubbleModule.bubbleClick(n),f.cancel||t.notify(ft,i),!f.cancel&&-1!==i.id.indexOf("shapeIndex")){var o=parseInt(i.id.split("_LayerIndex_")[1].split("_")[0],10),u=ef(e,t.layers[o].selectionSettings,t,"shapeSelected");u.cancel||!t.selectionModule||Object(r.isNullOrUndefined)(t.shapeSelected)?u.cancel&&t.selectionModule&&Object(r.isNullOrUndefined)(u.data)&&(p(i),t.selectionModule.removedSelectionList(i)):vt(t.selectionModule.selectionType+"selectionMap",t.selectionModule.selectionType+"selectionMapStyle",u)}}))},t.prototype.getClickLocation=function(n,t,i,r,u,f){var e,o=0,h,c,l;if(-1===n.indexOf("_LayerIndex_")||this.isTileMap||parseInt(this.mouseDownEvent.x)!==parseInt(this.mouseClickEvent.x)||parseInt(this.mouseDownEvent.y)!==parseInt(this.mouseClickEvent.y))this.isTileMap&&parseInt(this.mouseDownEvent.x)===parseInt(this.mouseClickEvent.x)&&parseInt(this.mouseDownEvent.y)===parseInt(this.mouseClickEvent.y)&&(e=this.getTileGeoLocation(u,f));else if(o=parseFloat(n.split("_LayerIndex_")[1].split("_")[0]),"Normal"===this.layers[o].geometryType)if(n.indexOf("_shapeIndex_")>-1){var s=li(t,i,r.parentElement),a=Math.abs(-this.baseMapBounds.longitude.min*this.mapLayerPanel.currentFactor),v=Math.abs(this.baseMapBounds.latitude.max*this.mapLayerPanel.currentFactor);e={latitude:Math.abs(this.baseMapBounds.latitude.max-s.y/this.mapLayerPanel.currentFactor),longitude:Math.abs(s.x/this.mapLayerPanel.currentFactor+this.baseMapBounds.longitude.min)};this.baseMapBounds.longitude.min<0&&a>s.x&&(e.longitude=-e.longitude);this.baseMapBounds.latitude.min<0&&v>s.y&&(e.latitude=-e.latitude)}else n.indexOf("_MarkerIndex_")>-1&&this.markerModule?(h=parseInt(n.split("_MarkerIndex_")[1].split("_")[0],10),c=parseInt(n.split("_dataIndex_")[1].split("_")[0],10),isNaN(h)||isNaN(c)?e={latitude:null,longitude:null}:(l=this.layers[o].markerSettings[h].dataSource[c],e={latitude:l.latitude,longitude:l.longitude})):e={latitude:null,longitude:null};else e=this.getGeoLocation(o,u,f);return e},t.prototype.mouseEndOnMap=function(n){var t,i,e,u=n.target,o=u.id,s=null,h=null,f,c;return this.element.getBoundingClientRect(),n.target,(-1!==n.type.indexOf("touch")?(this.isTouch=!0,t=(e=n).changedTouches[0].pageX,i=e.changedTouches[0].pageY,e.target,this.mouseClickEvent={x:t,y:i}):(this.isTouch="touch"===n.pointerType,t=n.pageX,i=n.pageY,n.target),this.isTouch)&&(-1===u.id.indexOf("_ToolBar")&&(f=this.getClickLocation(o,t,i,u,t,i),Object(r.isNullOrUndefined)(f)||(s=f.latitude,h=f.longitude),c={cancel:!1,name:ft,target:o,x:n.clientX,y:n.clientY,latitude:s,longitude:h,isShapeSelected:this.SelectedElement(u)},this.trigger("click",c,function(){})),this.titleTooltip(n,t,i,!0),Object(r.isNullOrUndefined)(this.legendModule)||this.legendTooltip(n,n.pageX,n.pageY,!0)),this.notify(r.Browser.touchEndEvent,n),n.preventDefault(),!1},t.prototype.mouseDownOnMap=function(n){var t,i;this.mouseDownEvent={x:n.x,y:n.y};-1!==n.type.indexOf("touch")&&n.changedTouches&&(this.mouseDownEvent={x:n.changedTouches[0].pageX,y:n.changedTouches[0].pageY});this.element.getBoundingClientRect();t=n.target;-1===t.id.indexOf("_ToolBar")&&(i=this.markerModule,(t.id.indexOf("shapeIndex")>-1||t.id.indexOf("Tile")>-1)&&this.mergeCluster(),i&&(i.markerClick(n),i.markerClusterClick(n)),this.bubbleModule&&this.bubbleModule.bubbleClick(n));this.notify(r.Browser.touchStartEvent,n)},t.prototype.mergeCluster=function(){this.markerModule&&this.markerModule.sameMarkerData.length>0&&(!this.zoomModule||this.zoomModule.isSingleClick)&&(er(this.markerModule.sameMarkerData,this,c(this.element.id+"_Markers_Group")),this.markerModule.sameMarkerData=[])},t.prototype.mapsOnDoubleClick=function(n){var e;this.notify("dblclick",n);var t,i=n.target,o=i.id,f=0,r=null,u=null;-1===i.id.indexOf("_ToolBar")&&(-1===i.id.indexOf("_LayerIndex_")||this.isTileMap||this.mouseDownEvent.x!==n.clientX||this.mouseDownEvent.y!==n.clientY?this.isTileMap&&this.mouseDownEvent.x===n.clientX&&this.mouseDownEvent.y===n.clientY&&(r=(t=this.getTileGeoLocation(n.layerX,n.layerY)).latitude,u=t.longitude):(f=parseFloat(i.id.split("_LayerIndex_")[1].split("_")[0]),r=(t=this.getGeoLocation(f,n.layerX,n.layerY)).latitude,u=t.longitude),e={cancel:!1,name:"doubleClick",x:n.clientX,y:n.clientY,target:o,latitude:r,longitude:u,isShapeSelected:null},this.trigger("doubleClick",e))},t.prototype.mouseMoveOnMap=function(n){"touchmove"===n.type?n.target:n.target;this.markerModule&&(this.markerModule.markerMove(n),this.markerModule.markerClusterMouseMove(n));this.bubbleModule&&this.bubbleModule.bubbleMove(n);this.onMouseMove(n);this.notify(r.Browser.touchMoveEvent,n)},t.prototype.onMouseMove=function(n){return n.target,this.isTouch||(this.titleTooltip(n,n.pageX,n.pageY),Object(r.isNullOrUndefined)(this.legendModule)||this.legendTooltip(n,n.pageX,n.pageY,!0)),!1},t.prototype.legendTooltip=function(n,t,i,r){var s,h,e=n.target.id,o=this.legendModule.currentPage,u=n.target.id.split("_Index_")[1],l,f;for(o=this.legendModule.totalPages.length<=this.legendModule.currentPage?this.legendModule.totalPages.length-1:this.legendModule.currentPage<0?0:this.legendModule.currentPage,l=0!==this.legendModule.totalPages.length?this.legendModule.totalPages[o].Collection.length:this.legendModule.totalPages.length,f=0;f<l;f++)s=(h=this.legendModule.totalPages[o].Collection[f]).DisplayText,e=n.target.id,u=n.target.id.split("_Index_")[1],e===this.element.id+"_Legend_Text_Index_"+u&&n.target.textContent.indexOf("...")>-1&&h.idIndex===parseInt(u,10)&&yi(s,this.legendSettings.textStyle.size,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_Legend_Text_Tooltip",c(this.element.id+"_Secondary_Element"),r);e!==this.element.id+"_Legend_Text_Index_"+u&&a(this.element.id+"_EJ2_Legend_Text_Tooltip")},t.prototype.titleTooltip=function(n,t,i,r){var u=n.target.id;u===this.element.id+"_LegendTitle"&&n.target.textContent.indexOf("...")>-1?yi(this.legendSettings.title.text,this.legendSettings.titleStyle.size,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_LegendTitle_Tooltip",c(this.element.id+"_Secondary_Element"),r):a(this.element.id+"_EJ2_LegendTitle_Tooltip");u===this.element.id+"_Map_title"&&n.target.textContent.indexOf("...")>-1?yi(this.titleSettings.text,this.titleSettings.textStyle.size,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_Title_Tooltip",c(this.element.id+"_Secondary_Element"),r):a(this.element.id+"_EJ2_Title_Tooltip")},t.prototype.mapsOnResize=function(){var n=this,t;return this.isResize=!0,t={name:"resize",previousSize:this.availableSize,currentSize:new d(0,0),maps:this},this.resizeTo&&clearTimeout(this.resizeTo),!Object(r.isNullOrUndefined)(this.element)&&this.element.classList.contains("e-maps")&&(this.resizeTo=setTimeout(function(){n.unWireEVents();n.createSVG();n.refreshing=!0;n.wireEVents();t.currentSize=n.availableSize;n.trigger("resize",t);n.render()},500)),!1},t.prototype.zoomByPosition=function(n,t){var i,o=this.mapLayerPanel.calculateFactor(this.layersCollection[0]),u=this.mapAreaRect;if(!this.isTileMap&&this.zoomModule)if(Object(r.isNullOrUndefined)(n))i={x:u.width/2,y:u.height/2},this.zoomModule.performZooming(i,t,t>this.scale?"ZoomIn":"ZoomOut");else{i=w(n.latitude,n.longitude,o,this.layersCollection[0],this);var f=document.getElementById(this.element.id+"_Layer_Collections").getBoundingClientRect(),e=this.svgObject.getBoundingClientRect(),s=Math.abs(f.left-e.left)/this.scale,h=Math.abs(f.top-e.top)/this.scale,c=this.translatePoint.x+s,l=this.translatePoint.y+h;this.scale=t;this.translatePoint.x=((f.left<e.left?c:0)+u.width/2-i.x*t)/t;this.translatePoint.y=((f.top<e.top?l:0)+u.height/2-i.y*t)/t;this.zoomModule.applyTransform()}else this.zoomModule&&(this.tileZoomLevel=t,this.tileTranslatePoint=this.mapLayerPanel.panTileMap(this.availableSize.width,this.availableSize.height,{x:n.longitude,y:n.latitude}),this.mapLayerPanel.generateTiles(t,this.tileTranslatePoint,null,new ku(this)))},t.prototype.panByDirection=function(n,t){var i=0,r=0;switch(n){case"Left":i=-this.mapAreaRect.width/7;break;case"Right":i=this.mapAreaRect.width/7;break;case"Top":r=-this.mapAreaRect.height/7;break;case"Bottom":r=this.mapAreaRect.height/7}this.zoomModule&&this.zoomModule.panning(n,i,r,t)},t.prototype.addLayer=function(n){this.layers.push(new hu(this.layers[0],"layers",n));this.refresh()},t.prototype.removeLayer=function(n){this.layers.splice(n,1);this.refresh()},t.prototype.addMarker=function(n,t){var u=document.getElementById(this.element.id+"_LayerIndex_"+n),i,r,f;if(t.length>0&&u){for(i=0,r=t;i<r.length;i++)f=r[i],this.layersCollection[n].markerSettings.push(new su(this,"markerSettings",f));new cu(this).markerRender(u,n,this.mapLayerPanel.currentFactor,"AddMarker");this.arrangeTemplate()}},t.prototype.shapeSelection=function(n,t,i,u){var f,d,l=Array.isArray(t)?t:Array(t),o,e,s,v,nt,k;if(Object(r.isNullOrUndefined)(u)&&(u=!0),o=this.layers[n].selectionSettings,!o.enableMultiSelect&&this.legendSelection&&u&&this.removeShapeSelection(),"SubLayer"===this.layers[n].type)for(e=0;e<this.layersCollection.length;e++)if(this.layersCollection[e].shapeData===this.layers[n].shapeData){d=e;break}if(o.enable){var y=void 0,w=void 0,b=void 0,g=void 0,a=void 0,h=this.layers[n].shapeData.features;for(e=0;e<h.length;e++)for(s=0;s<l.length;s++)if(v=void 0,(!Object(r.isNullOrUndefined)(h[e].properties[l[s]])&&isNaN(h[e].properties[l[s]])?h[e].properties[l[s]].toLowerCase():h[e].properties[l[s]])===(Object(r.isNullOrUndefined)(i)?i:i.toLowerCase()))if(Object(r.isNullOrUndefined)(this.layers[n].shapeSettings.colorValuePath)||(v=ct(this.layers[n].dataSource,h[e].properties,this.layers[n].shapeDataPath,this.layers[n].shapePropertyPath,this.layers[n])),nt=this.layers[n],this.baseLayerIndex>=0&&nt.isBaseLayer?b=0:"SubLayer"===this.layers[n].type&&(b=d),f=c(this.element.id+"_LayerIndex_"+b+"_shapeIndex_"+e+"_dataIndex_"+v),Object(r.isNullOrUndefined)(v)&&Object(r.isNullOrUndefined)(f)&&(f=c(this.element.id+"_LayerIndex_"+n+"_shapeIndex_"+e+"_dataIndex_null")),w=parseInt(f.id.split("_shapeIndex_")[1].split("_")[0],10),g=this.layers[n].shapeData.features.length>w?this.layers[n].shapeData.features[w].properties:null,y=parseInt(f.id.split("_dataIndex_")[1].split("_")[0],10),a=Object(r.isNullOrUndefined)(y)?null:this.layers[n].dataSource[y],u){if(of(o,this,f,g,a),this.shapeSelectionClass=c("ShapeselectionMap"),this.legendSettings.visible&&-1===f.id.indexOf("_MarkerIndex_")&&this.legendModule.shapeHighLightAndSelection(f,a,o,"selection",n),(!this.legendSettings.visible||this.legendModule.shapeToggled)&&(f.setAttribute("class","ShapeselectionMapStyle"),-1===this.selectedElementId.indexOf(f.getAttribute("id"))&&this.selectedElementId.push(f.getAttribute("id")),!o.enableMultiSelect))return}else(this.legendSelection=!o.enableMultiSelect&&!this.legendSelection||this.legendSelection,this.legendSettings.visible&&-1===f.id.indexOf("_MarkerIndex_")&&"ShapeselectionMapStyle"===f.getAttribute("class")&&this.legendModule.shapeHighLightAndSelection(f,a,o,"selection",n),!this.legendSettings.visible||this.legendModule.shapeToggled)&&(p(f),k=this.selectedElementId.indexOf(f.getAttribute("id")),-1!==k&&(this.selectedElementId.splice(k,1),!o.enableMultiSelect&&this.legendSelection&&this.selectedElementId.length>0&&this.removeShapeSelection()))}},t.prototype.zoomToCoordinates=function(n,t,i,u){var o,s,f,e,h=!1,c;(Object(r.isNullOrUndefined)(i)&&Object(r.isNullOrUndefined)(u)||Object(r.isNullOrUndefined)(n)&&Object(r.isNullOrUndefined)(t))&&(n=Object(r.isNullOrUndefined)(n)?0:n,t=Object(r.isNullOrUndefined)(n)?0:t,i=Object(r.isNullOrUndefined)(i)?n:i,u=Object(r.isNullOrUndefined)(u)?t:u,h=!0);n>i&&(n=(o=[i,n])[0],i=o[1]);t>u&&(t=(s=[u,t])[0],u=s[1]);h?(f=n+i,e=t+u):(f=(n+i)/2,e=(t+u)/2);this.centerLatOfGivenLocation=f;this.centerLongOfGivenLocation=e;this.minLatOfGivenLocation=n;this.minLongOfGivenLocation=t;this.maxLatOfGivenLocation=i;this.maxLongOfGivenLocation=u;this.zoomNotApplied=!0;this.scaleOfGivenLocation=fu(n,i,t,u,this.mapAreaRect.width,this.mapAreaRect.height,this);c={cancel:!1,name:"zoom",type:"zoomIn",maps:this,tileTranslatePoint:{},translatePoint:{},tileZoomLevel:this.isTileMap?{previous:this.tileZoomLevel,current:this.scaleOfGivenLocation}:{},scale:this.isTileMap?{previous:this.tileZoomLevel,current:this.scaleOfGivenLocation}:{previous:this.scale,current:this.scaleOfGivenLocation}};this.trigger("zoom",c);this.refresh()},t.prototype.removeShapeSelection=function(){for(var i,t=this.selectedElementId.length,n=0;n<t;n++)p(e(this.selectedElementId[0])),this.selectedElementId.splice(0,1);if(this.legendSettings.visible)for(i=this.legendSelectionCollection.length,n=0;n<i;n++)p(e(this.legendSelectionCollection[n].legendElement.id)),this.selectedLegendElementId.splice(0,1);this.shapeSelectionItem=[];this.legendSelectionCollection=[]},t.prototype.setCulture=function(){this.intl=new r.Internationalization;this.setLocaleConstants();this.localeObject=new r.L10n(this.getModuleName(),this.defaultLocalConstants,this.locale)},t.prototype.setLocaleConstants=function(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset"}},t.prototype.destroy=function(){this.unWireEVents();this.shapeSelectionItem=[];this.toggledShapeElementId=[];this.toggledLegendId=[];this.legendSelectionCollection=[];this.selectedLegendElementId=[];this.selectedNavigationElementId=[];this.selectedBubbleElementId=[];this.selectedMarkerElementId=[];this.selectedElementId=[];this.dataLabelShape=[];this.zoomShapeCollection=[];this.zoomLabelPositions=[];this.mouseDownEvent={x:null,y:null};this.mouseClickEvent={x:null,y:null};document.getElementById("mapsmeasuretext")&&document.getElementById("mapsmeasuretext").remove();this.removeSvg();n.prototype.destroy.call(this)},t.prototype.getModuleName=function(){return"maps"},t.prototype.getPersistData=function(){return this.addOnPersist(["translatePoint","zoomSettings","mapScaleValue","tileTranslatePoint","baseTranslatePoint","scale","zoomPersistence","defaultState","markerZoomedState","initialCheck","initialZoomLevel","initialTileTranslate","applyZoomReset","markerZoomFactor"])},t.prototype.onPropertyChanged=function(t,i){var u=!1,v=!1,y=!1,p,e,s,h,w,f,o,c,l;for(t.layers&&(p=Object.keys(t.layers).length,document.getElementById(this.element.id+"_LayerIndex_"+(p-1))),e=0,s=Object.keys(t);e<s.length;e++){h=s[e];switch(h){case"background":this.renderBorder();break;case"height":case"width":case"layers":case"projectionType":case"centerPosition":case"legendSettings":case"baseLayerIndex":if("layers"===h)for(w=Object.keys(t.layers).length,f=0;f<w;f++)if(!Object(r.isNullOrUndefined)(t.layers[f]))for(o=0,c=Object.keys(t.layers[f]);o<c.length;o++)l=c[o],"markerSettings"===l?v=!0:"staticMapType"===l&&(y=!0);u=!0;break;case"zoomSettings":t.zoomSettings.zoomFactor!==i.zoomSettings.zoomFactor?u=!1:t.zoomSettings.shouldZoomInitially!==i.zoomSettings.shouldZoomInitially||t.zoomSettings.enable!==i.zoomSettings.enable?(this.zoomSettings.zoomFactor=1,u=!0):u=!0;break;case"locale":case"currencyCode":n.prototype.refresh.call(this)}}u&&(t.layers&&v?(a(this.element.id+"_Markers_Group"),this.isTileMap?this.mapLayerPanel.renderTileLayer(this.mapLayerPanel,this.layers.currentFactor,this.layers.length-1):this.render()):t.layers&&y?this.mapLayerPanel.renderGoogleMap(this.layers[this.layers.length-1].key,this.staticMapZoom):(this.createSVG(),this.renderElements()))},t.prototype.requiredModules=function(){var n=[],t=this.findVisibleLayers(this.layers),i=!1;return this.annotations.map(function(n){i=null!=n.content}),this.isBubbleVisible()&&n.push({member:"Bubble",args:[this]}),t.highlight&&n.push({member:"Highlight",args:[this]}),t.selection&&n.push({member:"Selection",args:[this]}),this.legendSettings.visible&&n.push({member:"Legend",args:[this]}),(this.zoomSettings.enable||this.zoomSettings.zoomFactor>this.zoomSettings.minZoom)&&n.push({member:"Zoom",args:[this]}),this.isMarkersVisible()&&n.push({member:"Marker",args:[this]}),this.isDataLabelVisible()&&n.push({member:"DataLabel",args:[this]}),this.isNavigationVisible()&&n.push({member:"NavigationLine",args:[this]}),t.tooltip&&n.push({member:"MapsTooltip",args:[this]}),i&&n.push({member:"Annotations",args:[this,gu]}),this.allowPrint&&n.push({member:"Print",args:[this]}),this.allowImageExport&&n.push({member:"ImageExport",args:[this]}),this.allowPdfExport&&n.push({member:"PdfExport",args:[this]}),n},t.prototype.isMarkersVisible=function(){var n=!1;return Array.prototype.forEach.call(this.layers,function(t){for(var i=0;i<t.markerSettings.length;i++)if(t.markerSettings[i].visible){n=!0;break}}),n},t.prototype.isDataLabelVisible=function(){for(var t=!1,n=0;n<this.layers.length;n++)if(this.layers[n].dataLabelSettings.visible){t=!0;break}return t},t.prototype.isNavigationVisible=function(){var n=!1;return Array.prototype.forEach.call(this.layers,function(t){for(var i=0;i<t.navigationLineSettings.length;i++)if(t.navigationLineSettings[i].visible){n=!0;break}}),n},t.prototype.isBubbleVisible=function(){for(var r,t=!1,n=0,i=this.layers;n<i.length;n++)if(r=i[n],this.getBubbleVisible(r)){t=!0;break}return t},t.prototype.getBubbleVisible=function(n){for(var i=!1,t=0,r=n.bubbleSettings;t<r.length;t++)if(r[t].visible){i=!0;break}return i},t.prototype.print=function(n){this.allowPrint&&this.printModule&&this.printModule.print(n)},t.prototype.export=function(n,t,i,u){var f=this;return Object(r.isNullOrUndefined)(u)&&(u=!0),"PDF"!==n&&this.allowImageExport&&this.imageExportModule?new Promise(function(i){i(f.imageExportModule.export(n,t,u))}):this.allowPdfExport&&this.pdfExportModule?new Promise(function(r){r(f.pdfExportModule.export(n,t,u,i))}):null},t.prototype.findVisibleLayers=function(n,t,i,r,u,f){var k,d,h,y,e,c,p,l,a,w,o,v,b,s;for(void 0===t&&(t=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===u&&(u=!1),void 0===f&&(f=!1),h=0,y=n;h<y.length;h++){if(e=y[h],t=e.visible||t,e.visible){for(k=e.bubbleSettings,d=e.markerSettings,c=0,p=e.navigationLineSettings;c<p.length;c++)l=p[c],l.visible&&(u=l.highlightSettings.enable||u,f=l.selectionSettings.enable||f);for(a=0,w=d;a<w.length;a++)if(o=w[a],o.visible&&(r=o.tooltipSettings.visible||r,u=o.selectionSettings.enable||u,f=o.highlightSettings.enable||f),r)break;for(v=0,b=k;v<b.length;v++)if(s=b[v],s.visible&&(r=s.tooltipSettings.visible||r,u=s.selectionSettings.enable||u,f=s.highlightSettings.enable||f),r)break;r=e.tooltipSettings.visible||r;u=e.selectionSettings.enable||u;f=e.highlightSettings.enable||f}if(t&&i&&r)break}return{layer:t,bubble:i,tooltip:r,selection:u,highlight:f}},t.prototype.getGeoLocation=function(n,t,i){var u=document.getElementById(this.element.id),e=t-u.offsetLeft,o=i-u.offsetTop,f=et(this,this.layersCollection[n],!1).location,s=f.x*this.scale,h=f.y*this.scale,r=Math.min(this.mapAreaRect.height,this.mapAreaRect.width)*this.mapLayerPanel.currentFactor*this.scale,c=this.clip(e-s,0,r-1)/r-.5,l=.5-this.clip(o-h,0,r-1)/r;return{latitude:90-360*Math.atan(Math.exp(2*-l*Math.PI))/Math.PI,longitude:360*c}},t.prototype.clip=function(n,t,i){return Math.min(Math.max(n,t),i)},t.prototype.getTileGeoLocation=function(n,t){var i=document.getElementById(this.element.id),r=document.getElementById(this.element.id+"_tile_parent"),u=this.pointToLatLong(n+this.mapAreaRect.x-(r.offsetLeft-i.offsetLeft),t+this.mapAreaRect.y-(r.offsetTop-i.offsetTop));return{latitude:u.latitude,longitude:u.longitude}},t.prototype.pointToLatLong=function(n,t){var r="GoogleStaticMap"===this.layers[this.layers.length-1].layerType?0:10;t=this.zoomSettings.enable?t+r:t;var i=256*Math.pow(2,this.tileZoomLevel),u=this.clip(n-this.translatePoint.x*this.scale,0,i-1)/i-.5,f=.5-this.clip(t-this.translatePoint.y*this.scale,0,i-1)/i;return{latitude:90-360*Math.atan(Math.exp(2*-f*Math.PI))/Math.PI,longitude:360*u}},f([Object(r.Property)(null)],t.prototype,"background",void 0),f([Object(r.Property)(!1)],t.prototype,"useGroupingSeparator",void 0),f([Object(r.Property)(null)],t.prototype,"format",void 0),f([Object(r.Property)(null)],t.prototype,"width",void 0),f([Object(r.Property)(null)],t.prototype,"height",void 0),f([Object(r.Property)("MouseMove")],t.prototype,"tooltipDisplayMode",void 0),f([Object(r.Property)(!1)],t.prototype,"allowPrint",void 0),f([Object(r.Property)(!1)],t.prototype,"allowImageExport",void 0),f([Object(r.Property)(!1)],t.prototype,"allowPdfExport",void 0),f([Object(r.Complex)({},te)],t.prototype,"titleSettings",void 0),f([Object(r.Complex)({},ie)],t.prototype,"zoomSettings",void 0),f([Object(r.Complex)({},re)],t.prototype,"legendSettings",void 0),f([Object(r.Collection)([],hu)],t.prototype,"layers",void 0),f([Object(r.Collection)([],lf)],t.prototype,"annotations",void 0),f([Object(r.Complex)({},yf)],t.prototype,"margin",void 0),f([Object(r.Complex)({color:"#DDDDDD",width:0},g)],t.prototype,"border",void 0),f([Object(r.Property)("Material")],t.prototype,"theme",void 0),f([Object(r.Property)("Mercator")],t.prototype,"projectionType",void 0),f([Object(r.Property)(0)],t.prototype,"baseLayerIndex",void 0),f([Object(r.Property)(null)],t.prototype,"description",void 0),f([Object(r.Property)(1)],t.prototype,"tabIndex",void 0),f([Object(r.Complex)({latitude:null,longitude:null},vf)],t.prototype,"centerPosition",void 0),f([Object(r.Complex)({},oe)],t.prototype,"mapsArea",void 0),f([Object(r.Event)()],t.prototype,"load",void 0),f([Object(r.Event)()],t.prototype,"beforePrint",void 0),f([Object(r.Event)()],t.prototype,"loaded",void 0),f([Object(r.Event)()],t.prototype,"click",void 0),f([Object(r.Event)()],t.prototype,"doubleClick",void 0),f([Object(r.Event)()],t.prototype,"rightClick",void 0),f([Object(r.Event)()],t.prototype,"resize",void 0),f([Object(r.Event)()],t.prototype,"tooltipRender",void 0),f([Object(r.Event)()],t.prototype,"legendRendering",void 0),f([Object(r.Event)()],t.prototype,"tooltipRenderComplete",void 0),f([Object(r.Event)()],t.prototype,"shapeSelected",void 0),f([Object(r.Event)()],t.prototype,"itemSelection",void 0),f([Object(r.Event)()],t.prototype,"itemHighlight",void 0),f([Object(r.Event)()],t.prototype,"shapeHighlight",void 0),f([Object(r.Event)()],t.prototype,"layerRendering",void 0),f([Object(r.Event)()],t.prototype,"shapeRendering",void 0),f([Object(r.Event)()],t.prototype,"markerRendering",void 0),f([Object(r.Event)()],t.prototype,"markerClusterRendering",void 0),f([Object(r.Event)()],t.prototype,"markerClick",void 0),f([Object(r.Event)()],t.prototype,"markerClusterClick",void 0),f([Object(r.Event)()],t.prototype,"markerClusterMouseMove",void 0),f([Object(r.Event)()],t.prototype,"markerMouseMove",void 0),f([Object(r.Event)()],t.prototype,"dataLabelRendering",void 0),f([Object(r.Event)()],t.prototype,"bubbleRendering",void 0),f([Object(r.Event)()],t.prototype,"bubbleClick",void 0),f([Object(r.Event)()],t.prototype,"bubbleMouseMove",void 0),f([Object(r.Event)()],t.prototype,"animationComplete",void 0),f([Object(r.Event)()],t.prototype,"annotationRendering",void 0),f([Object(r.Event)()],t.prototype,"zoom",void 0),f([Object(r.Event)()],t.prototype,"pan",void 0),t=f([r.NotifyPropertyChanges],t)}(r.Component),le=function(){function n(n){this.id="";this.maps=n;this.bubbleCollection=[]}return n.prototype.renderBubble=function(n,t,i,u,f,e,o,h,c,l){var ot,yt,p=this,nt=h.layerData,b=n.colorValuePath,ni=Object(r.isNullOrUndefined)(b)?t[b]:b.indexOf(".")>-1?s(t,n.colorValuePath):t[b],ui=Object(r.isNullOrUndefined)(b)?Number(t[b]):b.indexOf(".")>-1?Number(s(t,n.colorValuePath)):Number(t[b]),fi=Object(r.isNullOrUndefined)(n.valuePath)?Number(t[n.valuePath]):n.valuePath.indexOf(".")>-1?Number(s(t,n.valuePath)):Number(t[n.valuePath]),it,pt,ei,st,wt,bt,w,tt,v,g,ut,gt,lt,ft;if(isNaN(fi)&&isNaN(ui)&&Object(r.isNullOrUndefined)(ni))return null;w=(it=n.minRadius,pt=n.maxRadius,ei=fi,st=u.min,wt=u.max,bt=(pt-it)/100*100/(wt-st)*(ei-st)+it,wt===st&&(bt=(pt-it)/100+it),bt);tt=new du(this.maps).getColorByValue(n.colorMapping,ui,ni);yt="[object Object]"!==Object.prototype.toString.call(tt)||Object(r.isNullOrUndefined)(tt.fill)?i:tt.fill;ot="[object Object]"!==Object.prototype.toString.call(tt)||Object(r.isNullOrUndefined)(tt.opacity)?n.opacity:tt.opacity;v=[[]];this.maps.translateType="bubble";for(var dt=0,ht=0,ct=0,d=0,hi=nt.length;d<hi;d++)if(g=nt[d],g=g.property,ut=ri(t[h.shapeDataPath],h.shapePropertyPath,g),(!Object(r.isNullOrUndefined)(t[h.shapeDataPath])&&isNaN(t[h.shapeDataPath])?t[h.shapeDataPath].toLowerCase():t[h.shapeDataPath])===(!Object(r.isNullOrUndefined)(g[ut])&&isNaN(g[ut])?g[ut].toLowerCase():g[ut]))if("Point"===nt[d].type)v.push(this.getPoints(nt[d],[]));else if(nt[d]._isMultiPolygon)for(gt=nt[d],lt=0;lt<gt.length;lt++)v.push(this.getPoints(gt[lt],[])),ht<(ct=v[v.length-1].length)&&(ht=ct,dt=v.length-1);else v.push(this.getPoints(nt[d],[])),ht<(ct=v[v.length-1].length)&&(ht=ct,dt=v.length-1);var oi,a,ci=this.maps.projectionType,si={color:n.border.color,opacity:n.border.opacity,width:n.border.width},vt=vi(v[dt],ci);if(n.visible){if(Object(r.isNullOrUndefined)(vt)){if(ft=v.length-1,!v[ft].x||!v[ft].y)return;a={cancel:!1,name:"bubbleRendering",border:si,cx:v[ft].x,cy:v[ft].y,data:t,fill:yt,maps:this.maps,radius:w}}else oi="Mercator"===this.maps.projectionType?vt.y:-vt.y,a={cancel:!1,name:"bubbleRendering",border:si,cx:vt.x,cy:oi,data:t,fill:yt,maps:this.maps,radius:w};this.maps.trigger("bubbleRendering",a,function(){var t,v,b,d,u,g,nt,tt,s,ft;if(!a.cancel){(a.border.opacity=Object(r.isNullOrUndefined)(a.border.opacity)?ot:a.border.opacity,"Circle"===n.bubbleType)?(g=new kt(l,a.fill,a.border,ot,0,0,a.radius,null),v=p.maps,b=g,d=c,t=ii(v.renderer.drawCircle(b),d)):(nt="Mercator"===p.maps.projectionType?a.cy-w:a.cy+w,tt=new k(l,a.fill,a.border,ot,new y(0,0,2*w,2*w),2,2),a.cx-=w,a.cy=nt,t=function(n,t,i){return ii(n.renderer.drawRectangle(t),i)}(p.maps,tt,c));ti(p.maps.selectedBubbleElementId,p.maps.bubbleSelectionClass,t,"BubbleselectionMapStyle");p.bubbleCollection.push({LayerIndex:o,BubbleIndex:f,DataIndex:e,element:t,center:{x:a.cx,y:a.cy}});s=0!==h.animationDuration||Object(r.isNullOrUndefined)(p.maps.zoomModule);u=p.maps.zoomSettings.zoomFactor>1&&!Object(r.isNullOrUndefined)(p.maps.zoomModule)?at(p.maps,h,s):et(p.maps,h,s);var st=n.dataSource,it=u.scale,ut=u.location,i=new rt(p.maps.isTileMap?a.cx:(a.cx+ut.x)*it,p.maps.isTileMap?a.cy:(a.cy+ut.y)*it);t.setAttribute("transform","translate( "+i.x+" "+i.y+" )");ft=st.length-1===e?"bubble":null;"Square"===n.bubbleType?(i.x+=w,i.y+=w*("Mercator"===p.maps.projectionType?1:-1)):w=0;n.animationDuration>0&&yr(t,n.animationDelay,n.animationDuration,i,p.maps,ft,w)}})}},n.prototype.getPoints=function(n,t){return Object(r.isNullOrUndefined)(n.map)?t=n.point:n.map(function(n){t.push(new o(n.point.x,n.point.y))}),t},n.prototype.bubbleClick=function(n){var t=n.target.id,i,u;-1!==t.indexOf("_LayerIndex_")&&(i=this.getbubble(t),Object(r.isNullOrUndefined)(i)||(u={cancel:!1,name:"bubbleClick",data:i,maps:this.maps,target:t,x:n.clientX,y:n.clientY},this.maps.trigger("bubbleClick",u)))},n.prototype.getbubble=function(n){var t=n.split("_LayerIndex_"),u=parseInt(t[1].split("_")[0],10),f=this.maps.layers[u],i,r;return n.indexOf("_BubbleIndex_")>-1&&(i=parseInt(t[1].split("_BubbleIndex_")[1],10),r=parseInt(t[1].split("_BubbleIndex_")[1].split("_dataIndex_")[1],10),!isNaN(i))?f.bubbleSettings[i].dataSource[r]:null},n.prototype.bubbleMove=function(n){var t=n.target.id,i,u;-1!==t.indexOf("_LayerIndex_")&&(i=this.getbubble(t),Object(r.isNullOrUndefined)(i)||(u={cancel:!1,name:"bubbleMouseMove",data:i,maps:this.maps,target:t,x:n.clientX,y:n.clientY},this.maps.trigger("bubbleMouseMove",u)))},n.prototype.getModuleName=function(){return"Bubble"},n.prototype.destroy=function(){},n}(),ae=function(){function n(n){this.value={rightWidth:0,leftWidth:0,heightTop:0,heightBottom:0};this.maps=n;this.dataLabelCollections=[]}return n.prototype.getDataLabel=function(n,t,i,u){for(var o,f,s,e=0;e<n.length;e++)if(f=n[e],s=!Object(r.isNullOrUndefined)(f[u])&&isNaN(f[u])?f[u].toLowerCase():f[u],i=Object(r.isNullOrUndefined)(i)?i:i.toString(),s===(Object(r.isNullOrUndefined)(i)?i:i.toLowerCase())){o=f;break}return o},n.prototype.renderLabel=function(n,t,i,u,f,e,s,h){var ri,ot,kt,d,fi,l,ei,ai,c=this,lt=n.dataLabelSettings,tt=n.dataLabelSettings.textStyle,ut=n.dataLabelSettings,ni=n.dataLabelSettings.labelPath,p=[[]],st=0,yt=0,rt=i,a="",pt=0,oi=!1,gi=i.properties,vt=this.maps.element.id+"_LayerIndex_"+t+"_shapeIndex_"+s+"_LabelIndex_"+s,g=new o(0,0),yi=u[s],ft,ii,li,dt,gt,b;tt.fontFamily="material"!==this.maps.theme.toLowerCase()?this.maps.themeStyle.labelFontFamily:tt.fontFamily;i=yi.property;var si,pi,hi="[object Array]"===Object.prototype.toString.call(n.shapePropertyPath)?n.shapePropertyPath:[n.shapePropertyPath],ci=!1,wi=0!==n.animationDuration||Object(r.isNullOrUndefined)(this.maps.zoomModule),bi=this.maps.isTileMap?{}:this.maps.zoomSettings.zoomFactor>1&&!Object(r.isNullOrUndefined)(this.maps.zoomModule)?at(this.maps,n,wi):et(this.maps,n,wi),w=this.maps.isTileMap?this.maps.scale:bi.scale,ct=this.maps.isTileMap?this.maps.translatePoint:bi.location,ti=this.maps.zoomTranslatePoint,wt=Object(r.isNullOrUndefined)(this.maps.scale)?1:Math.floor(this.maps.scale),bt=this.maps.zoomSettings.enable?!Object(r.isNullOrUndefined)(this.maps.zoomShapeCollection)&&this.maps.zoomShapeCollection.length>0:this.maps.zoomSettings.enable;for(this.maps.translateType="labels",ft=0;ft<hi.length&&!(gi[hi[ft]]&&(si=hi[ft],d=this.getDataLabel(n.dataSource,n.shapeDataPath,rt.properties[si],n.shapeDataPath)));ft++);if(d=this.getDataLabel(n.dataSource,n.shapeDataPath,rt.properties[si],n.shapeDataPath),!Object(r.isNullOrUndefined)(yi.property))if(p=[[]],u[s]._isMultiPolygon||"Point"===u[s].type)for(ii=u[s],"Point"===ii.type&&(ci=!0,li=[],li.push(this.getPoint(u,[])),yt<(pt=(p=li)[p.length-1].length)&&(yt=pt,st=p.length-1)),ft=0;ft<ii.length;ft++)p.push(this.getPoint(ii[ft],[])),yt<(pt=p[p.length-1].length)&&(yt=pt,st=p.length-1);else p.push(this.getPoint(u[s],[])),yt<(pt=p[p.length-1].length)&&(yt=pt,st=p.length-1);if(a=Object(r.isNullOrUndefined)(d)?rt.properties[ni]:Object(r.isNullOrUndefined)(d[ni])?d[n.shapeDataPath]:d[ni].toString(),"[object Array]"===Object.prototype.toString.call(n.shapePropertyPath)&&Object(r.isNullOrUndefined)(a)&&0===n.dataSource.length)for(dt=0;dt<n.shapePropertyPath.length;dt++)if(rt.properties[n.shapePropertyPath[dt]]){a=rt.properties[n.shapePropertyPath[dt]];break}Object(r.isNullOrUndefined)(a)&&""!==n.dataLabelSettings.template&&0===n.dataSource.length&&(a=rt.properties[n.shapePropertyPath]);var nr=a,ki=this.maps.projectionType,di=l=ci?{x:p[st][s].x,y:p[st][s].y,rightMin:0,rightMax:0,leftMin:0,leftMax:0,points:p[st][s],topMax:0,topMin:0,bottomMax:0,bottomMin:0,height:0}:vi(p[st],ki);if(!Object(r.isNullOrUndefined)(a)&&!Object(r.isNullOrUndefined)(l)){if(bt&&wt>1&&!this.maps.zoomNotApplied&&""===lt.template){if(t>0)for(gt=0;gt<this.maps.zoomLabelPositions.length;gt++)if(this.maps.zoomLabelPositions[gt].dataLabelText===a){fi=s;s=gt;oi=!0;break}ei=l.x;ai=l.y;l.x=(l.x+ti.x)*w;l.y=(l.y+ti.y)*w}l.y="Mercator"===this.maps.projectionType?l.y:-l.y;l;Object(r.isNullOrUndefined)(this.maps.format)||isNaN(parseFloat(a))||this.maps.useGroupingSeparator&&(a=ar(this.maps,parseFloat(a)),Object(r.isNullOrUndefined)(d)||(d[ni]=a));b={name:"dataLabelRendering",maps:this.maps,cancel:!1,border:{color:lt.border.color,width:lt.border.width,opacity:lt.border.opacity},datalabel:lt,fill:lt.fill,template:lt.template,text:a};this.maps.trigger("dataLabelRendering",b,function(){var yt,ft,et,at,ii,si,dt,o,i,lt,li,yi;if(!b.cancel){ft=bt&&wt>1&&!c.maps.zoomNotApplied&&c.maps.zoomShapeCollection.length>s?c.maps.zoomShapeCollection[s].width:(l.rightMax.x-l.leftMax.x)*w;Object(r.isNullOrUndefined)(c.maps.dataLabelShape)||(pi=di.rightMax.x-di.leftMax.x,c.maps.dataLabelShape.push(pi));b.text===a||b.cancel||(a=b.text);var n=v(a,tt),u=a,pt=n,wi=l.y-n.height/4,bi=l.y+n.height/4,gi=(l.y+ct.y)*w-n.height/4,tr=(l.y+ct.y)*w+n.height/4;if((yt=function(n,t,i){for(var u,f=[],r=0;r<n.length;r++)u=n[r],t<=u.y&&i>=u.y&&f.push(u);return f}(p[st],wi,bi),!ci&&yt.length>5&&"MultiPolygon"!==rt.geometry.type&&"MultiPolygon"!==rt.type)&&(et=vi(yt,ki),bt&&wt>1&&!c.maps.zoomNotApplied&&""===b.template&&(et.x=(c.maps.zoomLabelPositions[s].location.x+ti.x)*w,et.y=(c.maps.zoomLabelPositions[s].location.y+ti.y)*w),ei=et.x,l.x=et.x,ft=bt&&wt>1&&!c.maps.zoomNotApplied&&c.maps.zoomShapeCollection.length>s?c.maps.zoomShapeCollection[s].width:(et.rightMax.x-et.leftMax.x)*w),ii=(l.x+ct.x)*w+n.width/2,si=(l.x+ct.x)*w-n.width/2,c.value[s]={rightWidth:ii,leftWidth:si,heightTop:gi,heightBottom:tr},""!==b.template)dt=(ri=ui(b.template))?ri(Object(r.isNullOrUndefined)(d)?rt.properties:d,c.maps,b.template,c.maps.element.id+"_LabelTemplate",!1):document.createElement("div"),dt.innerHTML=ri?"":b.template,(at=function(n,t,i){for(var f=(Object(r.isNullOrUndefined)(n.childElementCount)?n[0]:n).outerHTML,e=Object.keys(i),u=0;u<e.length;u++)f=f.replace(new RegExp("{{:"+e[u]+"}}","g"),i[e[u].toString()]);return Object(r.createElement)("div",{id:t,innerHTML:f,styles:"position: absolute"})}(dt,vt,Object(r.isNullOrUndefined)(d)?rt.properties:d,0,c.maps)).style.left=Math.abs(c.maps.baseMapRectBounds.min.x-l.x)*w+"px",at.style.top=Math.abs(c.maps.baseMapRectBounds.min.y-l.y)*w+"px",e.appendChild(at);else{if("Trim"===ut.smartLabelMode&&(pt=v(u=nt(ft,a,tt),tt),ot=new it(vt,g.x,g.y,"middle",u,"","")),"None"===ut.smartLabelMode&&(ot=new it(vt,g.x,g.y,"middle",a,"","")),"Hide"===ut.smartLabelMode&&(a=ft>=n.width?a:"",ot=new it(vt,g.x,g.y,"middle",a,"","")),a=ot.text,"Hide"===ut.intersectionAction){for(o=0;o<h.length;o++)if(!Object(r.isNullOrUndefined)(h[o])&&!(c.value[s].leftWidth>h[o].rightWidth||c.value[s].rightWidth<h[o].leftWidth||c.value[s].heightTop>h[o].heightBottom||c.value[s].heightBottom<h[o].heightTop)){a="";break}h.push(c.value[s]);ot=new it(vt,g.x,g.y,"middle",a,"","")}if("Trim"===ut.intersectionAction){for(i=0;i<h.length;i++)if(!Object(r.isNullOrUndefined)(h[i]))if(h[i].rightWidth<c.value[s].leftWidth||h[i].leftWidth>c.value[s].rightWidth||h[i].heightBottom<c.value[s].heightTop||h[i].heightTop>c.value[s].heightBottom)u=a,0;else{if(c.value[s].leftWidth>h[i].leftWidth){u=nt((ft=h[i].rightWidth-c.value[s].leftWidth)-(c.value[s].rightWidth-c.value[s].leftWidth),a,tt);break}if(c.value[s].leftWidth<h[i].leftWidth){ft=c.value[s].rightWidth-h[i].leftWidth;u=nt(Math.abs(ft-(c.value[s].rightWidth-c.value[s].leftWidth)),a,tt);break}}pt=v(u,tt);h.push(c.value[s]);ot=new it(vt,g.x,g.y,"middle",u,"","")}if(("None"===ut.intersectionAction&&(ot=new it(vt,g.x,g.y,"middle",a,"","")),u.length>1)&&(lt=b.border,lt.width>1)){var ir=b.fill,hi=ut.opacity,rr=ut.rx,ur=ut.ry,gt=void 0,ni=void 0;bt&&wt>1&&!c.maps.zoomNotApplied?(gt=l.x-n.width/2,ni=l.y-n.height/2-5):(gt=(l.x+ct.x)*w-n.width/2,ni=(l.y+ct.y)*w-n.height/2);lt.opacity=Object(r.isNullOrUndefined)(lt.opacity)?hi:lt.opacity;li=new k(c.maps.element.id+"_LayerIndex_"+t+"_shapeIndex_"+s+"_rectIndex_"+s,ir,lt,hi,new y(gt,ni,n.width,n.height),rr,ur);yi=c.maps.renderer.drawRectangle(li);f.appendChild(yi)}kt=ht(ot,tt,tt.color||c.maps.themeStyle.dataLabelFontColor,f);bt&&wt>1&&!c.maps.zoomNotApplied?(kt.setAttribute("transform","translate( "+l.x+" "+l.y+" )"),l.x=ei,l.y=ai):kt.setAttribute("transform","translate( "+(l.x+ct.x)*w+" "+((l.y+ct.y)*w+pt.height/4)+" )");f.appendChild(kt)}c.dataLabelCollections.push({location:{x:l.x,y:l.y},element:Object(r.isNullOrUndefined)(at)?kt:at,layerIndex:t,shapeIndex:oi?fi:s,labelIndex:oi?fi:s,dataLabelText:nr});e.childElementCount>0&&!c.maps.element.contains(e)&&(document.getElementById(c.maps.element.id+"_Secondary_Element").appendChild(e),c.maps.renderReactTemplates())}})}},n.prototype.getPoint=function(n,t){return n.map(function(n){t.push(new o(n.point.x,n.point.y))}),t},n.prototype.getModuleName=function(){return"DataLabel"},n.prototype.destroy=function(){},n}(),ve=function(){function n(n){this.maps=n}return n.prototype.renderNavigation=function(n,t,i){for(var v,kt,u,dt,nt,tt,gt,it,l,a,p,rt,lt,e,ot,st,ht,ft,k,at,vt,d,c,g,yt,pt,y,ct,et,wt,h=n.navigationLineSettings,f=[],bt=this.maps.renderer.createGroup({id:this.maps.element.id+"_LayerIndex_"+i+"_line_Group"}),s=0;s<h.length;s++){if(rt=h[s].properties.latitude,p=h[s].properties.longitude,lt=h[s].properties.visible,e=h[s].angle,ot=h[s].width||1,st=h[s].color,ht=h[s].properties.dashArray,c=h[s].properties.arrowSettings,at=!Object(r.isNullOrUndefined)(c)&&c.properties.showArrow,p.length===rt.length&&lt)for(v=0;v<p.length;v++)kt=this.maps.isTileMap?ut(new o(p[v],rt[v]),t,this.maps.tileTranslatePoint,!0):w(rt[v],p[v],t,n,this.maps),f.push(kt);for(et=this.maps.renderer.createGroup({id:this.maps.element.id+"_LayerIndex_"+i+"_NavigationGroup"+s}),u=0;u<f.length-1;u++)e=1<(e=-1>e?-1:e)?1:e,dt=this.maps.element.id+"_LayerIndex_"+i+"_NavigationIndex_"+s+"_Line"+u,nt=this.convertRadius(f[u],f[u+1]),(e<=1&&e>0&&(k=0,f[u].x>f[u+1].x&&(k=1)),e>=-1&&e<0&&(k=1,f[u].x>f[u+1].x&&(k=0)),f[u].x!==f[u+1].x)&&(at&&(vt=c.properties.color,d=c.properties.size,ct=void 0===c.properties.offSet?0:c.properties.offSet,tt=Math.round(d/2),yt="Start"===(g=c.properties.position)?"url(#triangle"+s+")":null,pt="End"===g?"url(#triangle"+s+")":null,0!==y&&0===e&&(y="Start"===g?ct:-ct),y=Object(r.isNullOrUndefined)(y)?0:y,gt=this.maps.element.id+"_triangle",it=this.maps.renderer.createDefs(),it.innerHTML+='<marker id="triangle'+s+'"><\/marker>',l=it.querySelector("#triangle"+s),l.setAttribute("markerWidth",d.toString()),l.setAttribute("markerHeight",d.toString()),l.setAttribute("refX",(tt-y).toString()),l.setAttribute("refY",tt.toString()),l.setAttribute("orient","auto"),ft=new b(gt,vt,ot,st,1,1,ht,"M 0,0  L 0,"+d+" L "+tt+", "+tt+" Z"),a=this.maps.renderer.drawPath(ft),l.appendChild(a),it.appendChild(l),et.appendChild(it)),(wt=0===(e=Math.abs(e))?"M "+f[u].x+","+f[u].y+"L "+f[u+1].x+","+f[u+1].y+" ":"M "+f[u].x+","+f[u].y+" A "+(nt/2+(1-e)*nt/(10*e))+" "+(nt/2+(1-e)*nt/(10*e))+" 0,0,"+k+" , "+f[u+1].x+","+f[u+1].y+" ",ft=new b(dt,"none",ot,st,1,1,ht,wt),a=this.maps.renderer.drawPath(ft),Object(r.isNullOrUndefined)(g))||("Start"===g?a.setAttribute("marker-start",yt):a.setAttribute("marker-end",pt)),ti(this.maps.selectedNavigationElementId,this.maps.navigationSelectionClass,a,"navigationlineselectionMapStyle"),et.appendChild(a),bt.appendChild(et));f=[]}return bt},n.prototype.convertRadius=function(n,t){var i=t.x-n.x,r=t.y-n.y;return Math.sqrt(Math.pow(i,2)+Math.pow(r,2))},n.prototype.getModuleName=function(){return"NavigationLine"},n.prototype.destroy=function(){},n}(),ye=function(){function n(n){this.legendBorderRect=new y(0,0,0,0);this.totalPages=[];this.page=0;this.currentPage=0;this.legendItemRect=new y(0,0,0,0);this.heightIncrement=0;this.widthIncrement=0;this.textMaxWidth=0;this.shapeHighlightCollection=[];this.legendHighlightCollection=[];this.shapePreviousColor=[];this.selectedNonLegendShapes=[];this.shapeToggled=!0;this.legendElement=null;this.maps=n;this.addEventListener()}return n.prototype.renderLegend=function(){this.legendRenderingCollections=[];this.legendCollection=[];this.totalPages=[];this.widthIncrement=0;this.heightIncrement=0;this.defsElement=this.maps.renderer.createDefs();this.maps.svgObject.appendChild(this.defsElement);this.calculateLegendBounds();this.drawLegend()},n.prototype.calculateLegendBounds=function(){var rt=this,w=this.maps,n=w.legendSettings,ot,i,ut,fi,ei,et,c,t,l,e,kt,ti,ii,ri,ui,dt;if(this.legendCollection=[],ot=w.mapAreaRect.y,this.legendRenderingCollections=[],Array.prototype.forEach.call(w.layersCollection,function(t,i){var o,h,u;if(!Object(r.isNullOrUndefined)(t.shapeData)){var c=t.shapeData.features,l=t.shapeDataPath,a=t.shapePropertyPath,s=t.dataSource,f=void 0,e=void 0;if("Layers"===n.type&&t.visible)f=t.shapeSettings.colorValuePath,e=t.shapeSettings.colorMapping,rt.getLegends(i,c,e,s,l,f,a);else if("Bubbles"===n.type)for(o=0,h=t.bubbleSettings;o<h.length;o++)u=h[o],u.visible&&(f=u.colorValuePath,e=u.colorMapping,s=u.dataSource,rt.getLegends(i,c,e,s,l,f,a));else rt.getMarkersLegendCollections(i,t.markerSettings)}}),this.legendCollection.length>0)for(i=0;i<this.legendCollection.length;i++)ut={name:"legendRendering",cancel:!1,fill:(l=this.legendCollection[i]).fill,shape:n.shape,shapeBorder:n.shapeBorder,text:"number"==typeof l.text?l.text.toString():l.text},w.trigger("legendRendering",ut),l.fill=ut.fill,l.shape=ut.shape,l.shapeBorder=ut.shapeBorder,l.text=ut.text,ut.cancel&&(this.legendCollection.splice(i,1),i--);if(fi=w.legendSettings.title.text,ei=w.legendSettings.titleStyle,this.legendCollection.length>0){var oi,si,ai=n.mode,b=0,k=0,ht=0,st=0,gt=n.shapePadding,a=n.shapeHeight,ft=n.shapeWidth,o=[],g=[],hi=n.position,ci=n.labelDisplayMode,p="None"===n.orientation?"Top"===hi||"Bottom"===hi?"Horizontal":"Vertical":n.orientation,u=n.width.length>1?n.width.indexOf("%")>-1?w.availableSize.width/100*parseInt(n.width,10):parseInt(n.width,10):null,f=n.height.length>1?n.height.indexOf("%")>-1?w.availableSize.height/100*parseInt(n.height,10):parseInt(n.height,10):null,s=0,h=0,li=v(fi,ei);if("Interactive"===ai){var ni=n.textStyle,ct=this.legendCollection.length,tt="Horizontal"===p?Object(r.isNullOrUndefined)(u)?w.mapAreaRect.width/ct:u/ct:Object(r.isNullOrUndefined)(u)?25:u,it="Horizontal"===p?Object(r.isNullOrUndefined)(f)?25:f:Object(r.isNullOrUndefined)(f)?w.mapAreaRect.height/ct:f/ct;s=0;h=li.height+10;var lt=n.labelPosition,at=0,vt=0,yt=0,pt=0,wt=0,bt=0;for(i=0;i<this.legendCollection.length;i++)s="Horizontal"===p?s+tt:s,h="Horizontal"===p?h:h+it,et=this.legendCollection[i].text,c=new d(0,0),"None"===ci?c=v(et,ni):"Trim"===ci?c=v(et=nt("Horizontal"===p?tt:it,et,ni),ni):et="",wt=Math.max(wt,c.height),bt=Math.max(bt,c.width),c.width>0&&c.height>0&&("Horizontal"===p?(at=s+tt/2,vt="After"===lt?h+it+c.height/2+10:h-10):(at="After"===lt?s-c.width/2-10:s+tt+c.width/2+10,vt=h+it/2+c.height/4)),0===i?(yt="Horizontal"===p?s:"After"===lt?at-c.width/2:s,pt="Horizontal"===p?"After"===lt?h:vt-c.height/2:h,1===this.legendCollection.length&&(u="Horizontal"===p?Math.abs(s+tt-yt):tt+bt+10,f="Horizontal"===p?it+wt/2+10:Math.abs(h+it-pt))):i===this.legendCollection.length-1&&(u="Horizontal"===p?Math.abs(s+tt-yt):tt+bt+10,f="Horizontal"===p?it+wt/2+10:Math.abs(h+it-pt)),this.legendRenderingCollections.push({fill:this.legendCollection[i].fill,x:s,y:h,width:tt,height:it,text:et,textX:at,textY:vt,textWidth:c.width,textHeight:c.height,shapeBorder:this.legendCollection[i].shapeBorder});1===this.legendCollection.length&&(f=it,u=tt);this.legendItemRect={x:yt,y:pt,width:u,height:f}}else{for(u=Object(r.isNullOrUndefined)(u)?w.mapAreaRect.width:u,f=Object(r.isNullOrUndefined)(f)?w.mapAreaRect.height:f,t=0,this.page=0,i=0;i<this.legendCollection.length;i++)l=this.legendCollection[i],Object(r.isNullOrUndefined)(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]}),e=v(l.text,n.textStyle),(this.textMaxWidth=Math.max(this.textMaxWidth,e.width),0===i)?(s=b=10+ft/2,h=k=ot+li.height+(a>e.height?a/2:e.height/4)):(kt=e.height>a?e.height:a,"Horizontal"===p?(ti=g[t-1].x+g[t-1].width+10+ft,ti+gt+e.width>u?(ii=(g[t-1].y>o[t-1].y+a/2?g[t-1].y:o[t-1].y+a/2)+ot,ii+kt>f?(this.getPageChanged(),t=0,o=[],g=[],[],b=s,k=h):(b=o[0].x,k=ii+kt/2)):(b=ti-ft/2,k=o[t-1].y)):(ri=g[t-1].y>o[t-1].y+a/2?g[t-1].y:o[t-1].y+a/2,ri+ot+kt>f?(ui=g[t-1].x+this.textMaxWidth+10,ui+gt+e.width>u?(b=s,k=h,[],g=[],o=[],this.getPageChanged(),t=0):(b=ui+ft/2,k=o[0].y)):(b=o[t-1].x,k=ri+ot+a/2))),ht=b+ft/2+gt,st=k+e.height/4,o.push({x:b,y:k}),g.push({x:ht,y:st,width:e.width,height:e.height/2}),this.totalPages[this.page].Collection.push({DisplayText:l.text,ImageSrc:l.imageSrc,Shape:{x:b,y:k},Text:{x:ht,y:st},Fill:l.fill,legendShape:l.shape,shapeBorder:l.shapeBorder,idIndex:i,Rect:{x:o[t].x-ft/2,y:o[t].y-a/2<st-e.height?o[t].y-a/2:st-e.height,width:Math.abs(o[t].x-ft/2-(ht+e.width)),height:a>e.height?a:e.height}}),t++;dt=this.totalPages[0].Collection;Array.prototype.forEach.call(dt,function(n,t){var i=new y(n.Rect.x,n.Rect.y,n.Rect.width,n.Rect.height);0===t&&(oi=i.x,si=i.y);rt.widthIncrement=Math.max(rt.widthIncrement,Math.abs(oi-(i.x+i.width)));rt.heightIncrement=Math.max(rt.heightIncrement,Math.abs(si-(i.y+i.height)))});u=this.widthIncrement<u?this.widthIncrement:u;f=this.heightIncrement<f?this.heightIncrement:f;this.legendItemRect={x:dt[0].Rect.x,y:dt[0].Rect.y,width:u,height:f}}}},n.prototype.getLegends=function(n,t,i,r,u,f,e){this.getRangeLegendCollection(n,t,i,r,u,f,e);this.getEqualLegendCollection(n,t,i,r,u,f,e);this.getDataLegendCollection(n,t,i,r,u,f,e)},n.prototype.getPageChanged=function(){this.page++;Object(r.isNullOrUndefined)(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]})},n.prototype.legendTextTrim=function(n,t,i,r){var u=t,e=v(t,i).width,o=r-e,f;if(r>n)for(f=t.length-1;f>=0;--f)if(o+(e=v(u=t.substring(0,f)+"...",i).width)<=n||u.length<4)return u.length<4&&(u=" "),u;return u},n.prototype.drawLegend=function(){var e,i=this.maps,u=i.legendSettings,s=i.renderer,n=u.textStyle,r,f,h;if(this.legendGroup=s.createGroup({id:i.element.id+"_Legend_Group"}),"Interactive"===u.mode)for(r=0;r<this.legendRenderingCollections.length;r++){var c=i.element.id+"_Legend_Index_"+r,l=i.element.id+"_Legend_Index_"+r+"_Text",t=this.legendRenderingCollections[r],a=new y(t.x,t.y,t.width,t.height);0===r&&this.renderLegendBorder();f=new o(t.textX,t.textY);n.color=null!==n.color?n.color:this.maps.themeStyle.legendTextColor;h=new k(c,t.fill,t.shapeBorder,u.opacity,a);e=new it(l,f.x,f.y,"middle",t.text,"","");n.fontFamily=i.themeStyle.fontFamily||n.fontFamily;n.size=i.themeStyle.legendFontSize||n.size;ht(e,n,n.color,this.legendGroup);this.legendGroup.appendChild(s.drawRectangle(h));this.legendToggle()}else this.drawLegendItem(this.currentPage)},n.prototype.drawLegendItem=function(n){var i=this.maps,t=i.legendSettings,at=new d(t.shapeWidth,t.shapeHeight),f=i.renderer,o,rt,s,ot,st,ct,lt;if(n>=0&&n<this.totalPages.length)for(h(this.legendGroup.id,this.maps.element.id)&&Object(r.remove)(h(this.legendGroup.id,this.maps.element.id)),o=0;o<this.totalPages[n].Collection.length;o++){var u=this.totalPages[n].Collection[o],c=u.shapeBorder,nt=f.createGroup({id:i.element.id+"_Legend_Index_"+u.idIndex}),tt=u.DisplayText,vt="Markers"===t.type?Object(r.isNullOrUndefined)(u.ImageSrc)?t.shape:"Image":u.legendShape,yt="HorizontalLine"===t.shape||"VerticalLine"===t.shape||"Cross"===t.shape?Object(r.isNullOrUndefined)(t.fill)?"#000000":t.fill:c.color,pt=("HorizontalLine"===t.shape||"VerticalLine"===t.shape||"Cross"===t.shape)&&0===c.width?1:c.width,wt=i.element.id+"_Legend_Shape_Index_"+u.idIndex,bt=i.element.id+"_Legend_Text_Index_"+u.idIndex,kt=u.Shape,ft=u.Text,dt=(Object(r.isNullOrUndefined)(u.ImageSrc)?t.shape:u.ImageSrc,new b(wt,u.Fill,pt,yt,t.opacity,Object(r.isNullOrUndefined)(c.opacity)?t.opacity:c.opacity,""));if(t.textStyle.color=null!==t.textStyle.color?t.textStyle.color:this.maps.themeStyle.legendTextColor,t.textStyle.fontFamily=i.themeStyle.fontFamily||t.textStyle.fontFamily,t.textStyle.size=i.themeStyle.legendFontSize||t.textStyle.size,0===o&&this.renderLegendBorder(),nt.appendChild(hf(kt,vt,at,u.ImageSrc,dt)),rt=u.Rect.x+u.Rect.width,rt>this.legendBorderRect.width&&(tt=this.legendTextTrim(this.legendBorderRect.width,tt,t.textStyle,rt)),ht(new it(bt,ft.x,ft.y,"start",tt,"",""),t.textStyle,t.textStyle.color,nt),this.legendGroup.appendChild(nt),o===this.totalPages[n].Collection.length-1){if(s=void 0,0!==this.page){var et=n+1+"/"+this.totalPages.length,a=t.textStyle,ut=v(et,a),p=this.legendItemRect.x+this.legendItemRect.width-ut.width-30,l=this.legendItemRect.x+this.legendItemRect.width,e=this.legendItemRect.y+this.legendItemRect.height+2.5+10,gt=l-10-ut.width/2-5;s=f.createGroup({id:i.element.id+"_Legend_Paging_Group"});var w=f.createGroup({id:i.element.id+"_Legend_Left_Paging_Group"}),g=f.createGroup({id:i.element.id+"_Legend_Right_Paging_Group"}),ni=" M "+l+" "+e+" L "+(l-10)+" "+(e-5)+" L "+(l-10)+" "+(e+5)+" z ",ti=" M "+p+" "+e+" L "+(p+10)+" "+(e-5)+" L "+(p+10)+" "+(e+5)+" z ",ii=new b(i.element.id+"_Left_Page","#a6a6a6",0,"#a6a6a6",1,1,"",ti);w.appendChild(f.drawPath(ii));ot=new k(i.element.id+"_Left_Page_Rect","transparent",{},1,new y(p-5,e-10,20,20),null,null,"","");w.appendChild(f.drawRectangle(ot));this.wireEvents(w);st=new b(i.element.id+"_Right_Page","#a6a6a6",0,"#a6a6a6",1,1,"",ni);g.appendChild(f.drawPath(st));ct=new k(i.element.id+"_Right_Page_Rect","transparent",{},1,new y(l-10,e-5,10,10),null,null,"","");g.appendChild(f.drawRectangle(ct));this.wireEvents(g);s.appendChild(w);s.appendChild(g);lt={id:i.element.id+"_Paging_Text",x:gt,y:e+ut.height/4,fill:"#a6a6a6","font-size":"14px","font-style":a.fontStyle,"font-family":a.fontFamily,"font-weight":a.fontWeight,"text-anchor":"middle",transform:"",opacity:1,"dominant-baseline":""};s.appendChild(f.createText(lt,et));this.legendGroup.appendChild(s)}this.legendToggle()}}},n.prototype.legendHighLightAndSelection=function(n,t){var g,nt,tt,h,ct="Default"===this.maps.legendSettings.mode?document.getElementById(n.id.replace("Shape","Text")):document.getElementById(n.id+"_Text"),s=this.maps.legendModule.legendCollection,a=this.maps.layers[s[0].data[0].layerIndex].selectionSettings.enableMultiSelect,v=0,w=!0,it=parseFloat(n.id.charAt(n.id.length-1)),rt,b,u,y,f,ut,e,o,k,p,et,ot,st,ht,d;if(this.updateLegendElement(),rt=this.maps.toggledLegendId.indexOf(it),this.maps.legendSettings.toggleLegendSettings.enable&&"highlight"===t&&-1!==rt)return b=this.getIndexofLegend(this.legendHighlightCollection,n),-1!==b&&this.legendHighlightCollection.splice(b,1),this.removeLegendHighlightCollection(),null;if("selection"===t){if(this.shapeHighlightCollection=[],this.maps.shapeSelections||a||(this.removeAllSelections(),this.maps.shapeSelections=!0),this.maps.legendSelectionCollection.length>0&&(a||this.maps.shapeSelections))for(u=0;u<this.maps.legendSelectionCollection.length;u++){if(n===this.maps.legendSelectionCollection[u].legendElement){this.maps.legendSelectionCollection[u].legendElement=n;w=!1;this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[u].legendElement);this.maps.selectedLegendElementId.splice(this.maps.selectedLegendElementId.indexOf(it),1);this.maps.legendSelectionCollection.splice(u,1);this.maps.legendSelection=!(this.maps.legendSelectionCollection.length>0);break}if(!a)if(this.maps.legendSelectionCollection.length>1){for(y=0;y<this.maps.legendSelectionCollection.length;y++)this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[y].legendElement);this.maps.legendSelectionCollection=[]}else this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[u].legendElement),this.maps.legendSelectionCollection.splice(u,1)}}else{if(this.maps.legendSelectionCollection.length>0)for(u=0;u<this.maps.legendSelectionCollection.length;u++){if((n.id.indexOf("_Legend_Shape")>-1||n.id.indexOf("_Legend_Index"))&&n===this.maps.legendSelectionCollection[u].legendElement){w=!1;break}this.removeLegendHighlightCollection()}this.removeLegendHighlightCollection()}if(w)for(f=0;f<s.length;f++)if(ut="Interactive"===this.maps.legendSettings.mode?parseFloat(n.id.split("_Legend_Index_")[1]):parseFloat(n.id.split("_Legend_Shape_Index_")[1]),ct.textContent===s[f].text&&s[f].data.length>0&&ut===f){var c=this.maps.layers[s[f].data[0].layerIndex],ft=void 0,i=void 0,l=void 0;if(Object(r.isNullOrUndefined)(c)||(ft="selection"===t?c.selectionSettings.enable:c.highlightSettings.enable,i=void 0,i="selection"===t?c.selectionSettings:c.highlightSettings,l=s[f].data),ft)for(e=0;e<l.length;e++)if(g=l[e].shapeIndex,nt=l[e].layerIndex,tt=l[e].dataIndex,o=document.getElementById(this.maps.element.id+"_LayerIndex_"+nt+"_shapeIndex_"+g+"_dataIndex_"+tt),null!==o){if(k=!0,null!==this.maps.legendSelectionCollection)for(p=0;p<this.maps.legendSelectionCollection.length;p++)if(this.maps.legendSelectionCollection[p].legendElement===n){k=!1;break}"highlight"===t&&k?(0===e&&(this.legendHighlightCollection=[],this.pushCollection(n,this.legendHighlightCollection,s[f],c.shapeSettings)),h=this.legendHighlightCollection.length,et=this.legendHighlightCollection[h-1].legendOldFill,this.legendHighlightCollection[h-1].MapShapeCollection.Elements.push(o),ot=this.legendHighlightCollection[h-1].MapShapeCollection.Elements.length-1,st=o.getAttribute("fill"),this.legendHighlightCollection[h-1].shapeOldFillColor.push(st),ht=this.legendHighlightCollection[h-1].shapeOldFillColor[ot],this.shapePreviousColor=this.legendHighlightCollection[h-1].shapeOldFillColor,this.setColor(o,Object(r.isNullOrUndefined)(i.fill)?ht:i.fill,i.opacity.toString(),i.border.color,i.border.width.toString(),"highlight"),this.setColor(n,Object(r.isNullOrUndefined)(i.fill)?et:i.fill,i.opacity.toString(),i.border.color,i.border.width.toString(),"highlight")):"selection"===t&&(this.legendHighlightCollection=[],this.maps.legendSelectionClass=i,0===e&&(this.pushCollection(n,this.maps.legendSelectionCollection,s[f],c.shapeSettings),a||0===this.maps.selectedLegendElementId.length||(this.maps.selectedLegendElementId=[]),this.maps.selectedLegendElementId.push(f)),v=this.maps.legendSelectionCollection.length,d=this.maps.legendSelectionCollection[v-1].legendOldFill,this.maps.legendSelectionCollection[v-1].MapShapeCollection.Elements.push(o),this.maps.legendSelectionCollection[v-1].shapeOldFillColor=this.shapePreviousColor,this.setColor(n,Object(r.isNullOrUndefined)(i.fill)?d:i.fill,i.opacity.toString(),i.border.color,i.border.width.toString(),"selection"),this.setColor(o,Object(r.isNullOrUndefined)(i.fill)?d:i.fill,i.opacity.toString(),i.border.color,i.border.width.toString(),"selection"),-1===this.maps.selectedElementId.indexOf(o.getAttribute("id"))&&this.maps.selectedElementId.push(o.getAttribute("id")),e===l.length-1&&(this.maps.legendSelection=!1,this.removeLegend(this.maps.legendSelectionCollection)))}}},n.prototype.setColor=function(n,t,i,u,f,e){"selection"===e?(!function(n,t,i,u,f,e,o){if(!c(n)){var s=Object(r.createElement)("style",{id:n,innerHTML:"."+t+"{fill:"+i+";opacity:"+u+";stroke-width:"+e+";stroke:"+f+";}"});o.shapeSelectionClass=s;document.body.appendChild(s)}}("ShapeselectionMap","ShapeselectionMapStyle",t,i,u,f,this.maps),n.setAttribute("class","ShapeselectionMapStyle")):(n.setAttribute("fill",t),n.setAttribute("fill-opacity",i),n.setAttribute("stroke",u),n.setAttribute("stroke-width",(Number(f)/this.maps.scale).toString()))},n.prototype.pushCollection=function(n,t,i,r){t.push({legendElement:n,legendOldFill:i.fill,legendOldOpacity:i.opacity,legendOldBorderColor:i.borderColor,legendOldBorderWidth:i.borderWidth,shapeOpacity:r.opacity,shapeOldBorderColor:r.border.color,shapeOldBorderWidth:r.border.width});var u=t.length;t[u-1].MapShapeCollection={Elements:[]};t[u-1].shapeOldFillColor=[]},n.prototype.removeLegend=function(n){for(var t,u,i,f,r=0;r<n.length;r++)for(t=n[r],this.setColor(t.legendElement,t.legendOldFill,t.legendOldOpacity,t.legendOldBorderColor,t.legendOldBorderWidth,"highlight"),u=t.MapShapeCollection.Elements.length,i=0;i<u;i++)f=-1!==t.legendOldFill.indexOf("url")?t.shapeOldFillColor[i]:t.legendOldFill,this.setColor(t.MapShapeCollection.Elements[i],f,t.shapeOpacity,t.shapeOldBorderColor,t.shapeOldBorderWidth,"highlight")},n.prototype.removeLegendHighlightCollection=function(){this.legendHighlightCollection.length>0&&(this.removeLegend(this.legendHighlightCollection),this.legendHighlightCollection=[])},n.prototype.removeLegendSelectionCollection=function(n){var t,r;if(this.maps.legendSelectionCollection.length>0){p(n);for(var u=this.shapesOfLegend(n),f=u.length,i=0;i<f;i++)t=c(u[i]),"ShapeselectionMapStyle"===t.getAttribute("class")&&(p(t),r=this.maps.selectedElementId.indexOf(t.id),-1!==r&&this.maps.selectedElementId.splice(r,1))}},n.prototype.removeShapeHighlightCollection=function(){var t;if(this.shapeHighlightCollection.length>0)for(t=0;t<this.shapeHighlightCollection.length;t++){for(var n=this.shapeHighlightCollection[t],r=!0,i=0;i<this.maps.legendSelectionCollection.length;i++)this.maps.legendSelectionCollection[i].legendElement===n.legendElement&&(r=!1);r&&this.setColor(n.legendElement,n.legendOldFill,n.legendOldOpacity,n.legendOldBorderColor,n.legendOldBorderWidth,"highlight")}},n.prototype.shapeHighLightAndSelection=function(n,t,i,u,f){var b,v,h,y,a,d,o,l,g,rt,nt,tt,it;if(void 0!==t){this.updateLegendElement();this.shapeToggled=!0;var w=this.maps.legendModule.legendCollection,e=this.legendIndexOnShape(t,f),s=this.shapeDataOnLegend(n),ut=this.maps.toggledLegendId.indexOf(e.actualIndex);if(this.maps.legendSettings.toggleLegendSettings.enable&&-1!==ut)return this.shapeToggled=!1,this.legendHighlightCollection=[],b=this.getIndexofLegend(this.shapeHighlightCollection,s.LegendEle),-1!==b&&this.shapeHighlightCollection.splice(b,1),this.removeShapeHighlightCollection(),null;if(void 0===e.currentIndex&&void 0===e.actualIndex)return this.removeShapeHighlightCollection(),null;if(void 0!==e.currentIndex||"selection"!==u||this.maps.layers[f].selectionSettings.enableMultiSelect||"ShapeselectionMapStyle"===n.getAttribute("class")||(this.maps.legendSelection=!1),"selection"!==u||this.maps.layers[f].selectionSettings.enableMultiSelect||this.maps.legendSelection||(this.removeAllSelections(),this.maps.legendSelection=!0),void 0===e.currentIndex){if("selection"===u&&void 0!==e.actualIndex){for(v=0,h=0;h<s.Elements.length;h++)"ShapeselectionMapStyle"===s.Elements[h].getAttribute("class")&&v++;y=this.maps.selectedLegendElementId.indexOf(e.actualIndex);-1===y?(this.maps.selectedLegendElementId.push(e.actualIndex),this.maps.legendSelectionClass=i):v<=1&&"ShapeselectionMapStyle"===n.getAttribute("class")&&(this.maps.layers[f].selectionSettings.enableMultiSelect?v<=1&&"ShapeselectionMapStyle"===n.getAttribute("class")&&this.maps.selectedLegendElementId.splice(y,1):this.maps.selectedLegendElementId.splice(y,1))}return this.removeShapeHighlightCollection(),null}var ft=w[e.actualIndex].text,k=void 0,c=void 0;if("Default"===this.maps.legendSettings.mode?void 0!==e.currentIndex&&(k=document.getElementById(this.maps.element.id+"_Legend_Text_Index_"+e.actualIndex).textContent,c=document.getElementById(this.maps.element.id+"_Legend_Shape_Index_"+e.actualIndex)):(k=document.getElementById(this.maps.element.id+"_Legend_Index_"+e.actualIndex+"_Text").textContent,c=document.getElementById(this.maps.element.id+"_Legend_Index_"+e.actualIndex)),this.oldShapeElement=s.LegendEle,a=this.maps.legendSelectionCollection.length,ft===k){if(d=!0,this.maps.legendSelectionCollection)for(h=0;h<this.maps.legendSelectionCollection.length;h++)if(this.maps.legendSelectionCollection[h].legendElement===s.LegendEle){d=!1;break}if("highlight"===u&&d){for((void 0===(l=this.isTargetSelected(s,this.shapeHighlightCollection))||l&&!l.IsSelected)&&this.pushCollection(c,this.shapeHighlightCollection,w[e.actualIndex],this.maps.layers[f].shapeSettings),o=0;o<this.shapeHighlightCollection.length;o++)s.LegendEle.id===this.shapeHighlightCollection[o].legendElement.id&&(this.shapeHighlightCollection[o].legendElement=s.LegendEle);if(a>0)for(o=0;o<a;o++){if(s.LegendEle===this.maps.legendSelectionCollection[o].legendElement){this.maps.legendSelectionCollection[o].legendElement=s.LegendEle;this.removeShapeHighlightCollection();break}o===a-1&&(this.removeShapeHighlightCollection(),this.setColor(c,Object(r.isNullOrUndefined)(i.fill)?c.getAttribute("fill"):i.fill,i.opacity.toString(),i.border.color,i.border.width.toString(),"highlight"))}else this.removeShapeHighlightCollection(),this.setColor(c,Object(r.isNullOrUndefined)(i.fill)?c.getAttribute("fill"):i.fill,i.opacity.toString(),i.border.color,i.border.width.toString(),"highlight")}else if("selection"===u){if(l=this.isTargetSelected(s,this.maps.legendSelectionCollection),a>0)for(o=0;o<this.maps.legendSelectionCollection.length;)s.LegendEle===this.maps.legendSelectionCollection[o].legendElement||i.enableMultiSelect?o++:(g=this.maps.legendSelectionCollection[o],rt=this.maps.selectedLegendElementId.indexOf(e.actualIndex),this.maps.selectedLegendElementId.splice(rt,1),this.maps.legendSelectionCollection.splice(o,1),p(g.legendElement),this.maps.shapeSelections=!0,o=0);if(l&&l.IsSelected&&"ShapeselectionMapStyle"===n.getAttribute("class")){if(g=this.maps.legendSelectionCollection[l.SelectionIndex],nt=0,i.enableMultiSelect)for(h=0;h<s.Elements.length;h++)n.getAttribute("class")===s.Elements[h].getAttribute("class")&&nt++;nt<=1&&(i.enableMultiSelect||this.maps.legendSelection)&&(this.maps.selectedLegendElementId.splice(this.maps.selectedLegendElementId.indexOf(e.actualIndex),1),Object(r.isNullOrUndefined)(s.LegendEle)||p(s.LegendEle),this.maps.legendSelectionCollection.splice(l.SelectionIndex,1),this.maps.shapeSelections=!0)}else{for(void 0!==l&&(!l||l.IsSelected)||Object(r.isNullOrUndefined)(c)||-1===(it=this.getIndexofLegend(this.maps.legendSelectionCollection,c))&&this.pushCollection(c,this.maps.legendSelectionCollection,w[e.actualIndex],this.maps.layers[f].shapeSettings),tt=!0,h=0;h<this.maps.selectedLegendElementId.length;h++)e.actualIndex===this.maps.selectedLegendElementId[h]&&(tt=!1);(tt&&this.maps.selectedLegendElementId.push(e.actualIndex),this.maps.legendSelectionClass=i,this.removeLegend(this.shapeHighlightCollection),Object(r.isNullOrUndefined)(c))||(this.setColor(c,Object(r.isNullOrUndefined)(i.fill)?c.getAttribute("fill"):i.fill,i.opacity.toString(),i.border.color,i.border.width.toString(),"selection"),it=this.getIndexofLegend(this.maps.legendSelectionCollection,c),this.maps.legendSelectionCollection[it].MapShapeCollection.Elements.push(n));this.maps.shapeSelections=!1}}else document.getElementsByClassName("highlightMapStyle").length>0&&(this.removeShapeHighlightCollection(),p(document.getElementsByClassName("highlightMapStyle")[0]))}}else this.removeShapeHighlightCollection()},n.prototype.isTargetSelected=function(n,t){for(var u,i=0;i<t.length;i++)Object(r.isNullOrUndefined)(n.LegendEle.getAttribute("id"))||n.LegendEle.getAttribute("id")!==t[i].legendElement.getAttribute("id")||(u={IsSelected:!0,SelectionIndex:i});return u},n.prototype.updateLegendElement=function(){for(var n=0;n<this.maps.legendSelectionCollection.length;n++)document.getElementById(this.maps.legendSelectionCollection[n].legendElement.id)&&(this.maps.legendSelectionCollection[n].legendElement=document.getElementById(this.maps.legendSelectionCollection[n].legendElement.id))},n.prototype.getIndexofLegend=function(n,t){return n.map(function(n){return n.legendElement}).indexOf(t)},n.prototype.removeAllSelections=function(){for(var t,i,u,n=0;n<this.maps.selectedElementId.length;n++)p(i=document.getElementById(this.maps.selectedElementId[n]));for(t=0;t<this.maps.selectedLegendElementId.length;t++)i=("Interactive"===this.maps.legendSettings.mode?"container_Legend_Index_":"container_Legend_Shape_Index_")+this.maps.selectedLegendElementId[t],u=document.getElementById(i),Object(r.isNullOrUndefined)(u)||p(document.getElementById(i));this.maps.legendSelectionCollection=[];this.maps.selectedLegendElementId=[];this.maps.selectedElementId=[]},n.prototype.legendIndexOnShape=function(n,t){var c,l,o,a=n[this.maps.layers[t].shapeDataPath],s=this.maps.legendSettings.mode,h=this.maps.legendModule.legendCollection,v,u,f,e,i;for("Default"!==s||Object(r.isNullOrUndefined)(this.maps.legendModule.totalPages)||(o=this.maps.legendModule.totalPages[this.maps.legendModule.currentPage].Collection),v="Default"===s?o.length:1,u=0;u<h.length;u++){for(f=h[u].data,e=0;e<v;e++)if("Default"!==s||h[u].text===o[e].DisplayText)for(i=0;i<f.length;i++)a===f[i].name&&(c=e);for(i=0;i<f.length;i++)a===f[i].name&&(l=u)}return{currentIndex:c,actualIndex:l}},n.prototype.shapeDataOnLegend=function(n){for(var e,o,s,h,c=this.maps.legendModule.legendCollection,v=this.maps.legendSettings,t=0;t<c.length;t++){for(var u=c[t].data,l=!1,a=[],f={Elements:[]},i=0;i<u.length;i++)o=u[i].shapeIndex,s=u[i].layerIndex,h=u[i].dataIndex,e=document.getElementById(this.maps.element.id+"_LayerIndex_"+s+"_shapeIndex_"+o+"_dataIndex_"+h),n===e&&(l=!0),a.push(e);if(l)return Object(r.isNullOrUndefined)(f.LegendEle)&&(f.LegendEle="Default"===v.mode?document.getElementById(this.maps.element.id+"_Legend_Shape_Index_"+t):document.getElementById(this.maps.element.id+"_Legend_Index_"+t)),f.Elements=a,f}return null},n.prototype.shapesOfLegend=function(n){for(var u,f,e,o,h=parseFloat(n.id.charAt(n.id.length-1)),i=this.maps.legendModule.legendCollection[h].data,s=[],t=0;t<i.length;t++)f=i[t].shapeIndex,e=i[t].layerIndex,o=i[t].dataIndex,u=document.getElementById(this.maps.element.id+"_LayerIndex_"+e+"_shapeIndex_"+f+"_dataIndex_"+o),Object(r.isNullOrUndefined)(u)||s.push(u.id);return s},n.prototype.legendToggle=function(){var u=this.maps,f=u.legendSettings,n,s,t,h,i,c,l,e,a,o;if(this.maps.selectedLegendElementId)for(n=0;n<this.maps.selectedLegendElementId.length;n++)if(s="Interactive"===f.mode?this.maps.element.id+"_Legend_Index_":this.maps.element.id+"_Legend_Shape_Index_",t=u.svgObject.querySelector("#"+s+this.maps.selectedLegendElementId[n]),!Object(r.isNullOrUndefined)(t)){for(h=Object(r.isNullOrUndefined)(this.maps.legendSelectionClass.fill)?t.getAttribute("fill"):this.maps.legendSelectionClass.fill,this.setColor(t,h,this.maps.legendSelectionClass.opacity.toString(),this.maps.legendSelectionClass.border.color,this.maps.legendSelectionClass.border.width.toString(),"selection"),i=0;i<this.maps.legendSelectionCollection.length;i++)this.maps.legendSelectionCollection[i].legendElement.id===t.id&&(this.maps.legendSelectionCollection[i].legendElement=t);-1===this.getIndexofLegend(this.maps.legendSelectionCollection,t)&&(c=this.maps.legendModule.legendCollection[this.maps.selectedLegendElementId[n]].data[n].layerIndex,this.pushCollection(t,this.maps.legendSelectionCollection,this.maps.legendModule.legendCollection[this.maps.selectedLegendElementId[n]],this.maps.layers[c].shapeSettings))}if(this.maps.toggledLegendId)for(n=0;n<this.maps.toggledLegendId.length;n++)l="Interactive"===f.mode?"#"+this.maps.element.id+"_Legend_Index_"+this.maps.toggledLegendId[n]+"_Text":"#"+this.maps.element.id+"_Legend_Text_Index_"+this.maps.toggledLegendId[n],e=u.svgObject.querySelector(l),Object(r.isNullOrUndefined)(e)||e.setAttribute("fill","#E5E5E5"),a="Interactive"===f.mode?"#"+this.maps.element.id+"_Legend_Index_"+this.maps.toggledLegendId[n]:"#"+this.maps.element.id+"_Legend_Shape_Index_"+this.maps.toggledLegendId[n],o=u.svgObject.querySelector(a),Object(r.isNullOrUndefined)(o)||o.setAttribute("fill","#E5E5E5")},n.prototype.renderLegendBorder=function(){var i=this.maps,n=i.legendSettings,e=n.title.text,t=n.titleStyle,o=nt(this.legendItemRect.width+20,e,t),f=v(o,t),u,s;this.legendBorderRect=new y(this.legendItemRect.x-10,this.legendItemRect.y-10-f.height,this.legendItemRect.width+20,this.legendItemRect.height+20+f.height+("Interactive"===n.mode?0:0!==this.page?10:0));u={color:n.border.color,width:n.border.width,opacity:n.border.opacity};u.opacity=Object(r.isNullOrUndefined)(u.opacity)?1:u.opacity;s=new k(i.element.id+"_Legend_Border",n.background,u,1,this.legendBorderRect,null,null,"","");this.legendGroup.appendChild(i.renderer.drawRectangle(s));this.getLegendAlignment(i,this.legendBorderRect.width,this.legendBorderRect.height,n);this.legendGroup.setAttribute("transform","translate( "+(this.translate.x+-this.legendBorderRect.x)+" "+(this.translate.y+-this.legendBorderRect.y)+" )");i.svgObject.appendChild(this.legendGroup);e&&(t.color=null!==t.color?t.color:this.maps.themeStyle.legendTitleFontColor,ht(new it(i.element.id+"_LegendTitle",this.legendItemRect.x+this.legendItemRect.width/2,this.legendItemRect.y-f.height/2-5,"middle",o,""),t,t.color,this.legendGroup))},n.prototype.changeNextPage=function(n){this.currentPage=n.target.id.indexOf("_Left_Page_")>-1?this.currentPage-1:this.currentPage+1;this.legendGroup=this.maps.renderer.createGroup({id:this.maps.element.id+"_Legend_Group"});this.drawLegendItem(this.currentPage);h(this.maps.element.id+"_Legend_Border",this.maps.element.id)&&(h(this.maps.element.id+"_Legend_Border",this.maps.element.id).style.pointerEvents="none")},n.prototype.getLegendAlignment=function(n,t,i,u){var e,s,f,h=(f=Object(r.extend)({},n.mapAreaRect,f,!0)).x,c=f.y,v=f.height,y=f.width,l=n.availableSize.width,a=n.availableSize.height;if("Float"===u.position)this.translate=u.location;else{switch(u.position){case"Top":case"Bottom":f.height=v-i;e=l/2-t/2;s="Top"===u.position?c:c+f.height;f.y="Top"===u.position?c+i+10:c;break;case"Left":case"Right":f.width=y-t;e="Left"===u.position?h:h+f.width-10;s=a/2-i/2;f.x="Left"===u.position?h+t:h}switch(u.alignment){case"Near":"Top"===u.position||"Bottom"===u.position?e=f.x:s=f.y;break;case"Far":"Top"===u.position||"Bottom"===u.position?e=l-t-10:s=a-i}(u.height||u.width)&&"Interactive"!==u.mode?n.totalRect=f:((u.height||u.width)&&"Interactive"===u.mode&&(n.totalRect=f),n.mapAreaRect=f);this.translate=new o(e,s)}},n.prototype.getMarkersLegendCollections=function(n,t){var i=this;Array.prototype.forEach.call(t,function(t,u){var e=t.dataSource,f=t.legendText;Array.prototype.forEach.call(e,function(e,o){var a=!!Object(r.isNullOrUndefined)(e[i.maps.legendSettings.showLegendPath])||e[i.maps.legendSettings.showLegendPath],s;if(t.visible&&a&&!Object(r.isNullOrUndefined)(e.latitude)&&!Object(r.isNullOrUndefined)(e.longitude)){t.template&&(s=ui(t.template)(i.maps),(Object(r.isNullOrUndefined)(s.childElementCount)?s[0]:s).querySelector("img").src);var h=Object(r.isNullOrUndefined)(e[f])?"":e[f],c=Object(r.isNullOrUndefined)(t.colorValuePath)?t.fill:e[t.colorValuePath],l=[];i.maps.legendSettings.removeDuplicateLegend?(l.push(i.getMarkerLegendData(n,h,c)),i.getOverallLegendItemsCollection(h,c,l,a)):(l.push({layerIndex:n,markerIndex:u,dataIndex:o,value:c,name:h,shape:Object(r.isNullOrUndefined)(t.shapeValuePath)?t.shape:e[t.shapeValuePath]}),i.getOverallLegendItemsCollection(h,c,l,a))}})})},n.prototype.getMarkerLegendData=function(n,t,i){var f=this,u=[];return this.maps.layers[n].markerSettings.map(function(e,o){var s=e.dataSource;Array.prototype.forEach.call(s,function(e,s){var h=f.maps.layers[n].markerSettings[o];t!==e[h.legendText]&&""!==t||i!=e[h.colorValuePath]||u.push({layerIndex:n,markerIndex:o,dataIndex:s,value:i,name:t,shape:Object(r.isNullOrUndefined)(h.shapeValuePath)?h.shape:e[h.shapeValuePath]})})}),u},n.prototype.getRangeLegendCollection=function(n,t,i,u,f,e,o){for(var l,w=this,a=0,v=this.maps.legendSettings.fill,h=[],b=function(i){var c,p;Object(r.isNullOrUndefined)(i.from)||Object(r.isNullOrUndefined)(i.to)||(l=Object(r.isNullOrUndefined)(i.label)?i.from+" - "+i.to:i.label,h=[],c=!1,Array.prototype.forEach.call(u,function(r,u){var l=e.indexOf(".")>-1?Number(s(r,e)):parseFloat(r[e]);l>=i.from&&l<=i.to&&(c=!0,h.push(w.getLegendData(n,u,r,f,t,o,l)))}),c||h.push({layerIndex:n,shapeIndex:null,dataIndex:null,name:null,value:null}),p=Object(r.isNullOrUndefined)(v)?"[object Array]"===Object.prototype.toString.call(i.color)?Object(r.isNullOrUndefined)(i.value)?y.legendGradientColor(i,a):i.color[0]:i.color:v,a++,y.getOverallLegendItemsCollection(l,p,h,i.showLegend))},y=this,c=0,p=i;c<p.length;c++)b(p[c])},n.prototype.getOverallLegendItemsCollection=function(n,t,i,r){var f=[],s=this.maps.legendSettings,u,e,o;if(i.length>0&&r){for(u=0;u<i.length;u++){if(e=i[u],e.length>0)for(o=0;o<e.length;o++)f.push(e[o]);else f.push(i[u]);f._isVisible=!0}!!this.maps.legendSettings.removeDuplicateLegend&&this.removeDuplicates(this.legendCollection,n,t)||this.legendCollection.push({text:n,fill:t,data:f,opacity:s.opacity,borderColor:s.shapeBorder.color,borderWidth:s.shapeBorder.width})}},n.prototype.removeDuplicates=function(n,t,i){for(var u=!1,r=0;r<n.length;r++)if((n[r].text===t||""===n[r].text)&&n[r].fill===i){u=!0;break}return u},n.prototype.getEqualLegendCollection=function(n,t,i,u,f,e,o){for(var l,v=this,w=this.maps.legendSettings.fill,c=[],a=[],h=[],y=[],d=function(p){var k,tt,nt,d,g,it,rt;if(Object(r.isNullOrUndefined)(p.value))Object(r.isNullOrUndefined)(p.minOpacity)&&Object(r.isNullOrUndefined)(p.maxOpacity)&&Object(r.isNullOrUndefined)(p.value)&&Object(r.isNullOrUndefined)(p.from)&&Object(r.isNullOrUndefined)(p.to)&&!Object(r.isNullOrUndefined)(p.color)&&((Array.prototype.forEach.call(u,function(i,r){for(var c=e.indexOf(".")>-1?s(i,e):i[e],u=0;u<h.length;u++)c===h[u]&&y.push(v.getLegendData(n,r,i,f,t,o,c))}),0===h.length)&&(k=!1,Array.prototype.forEach.call(u,function(u,s){k=!1;for(var h=u[e],c=0;c<i.length;c++)Object(r.isNullOrUndefined)(h)||isNaN(h)?k||(k=!1):h>=i[c].from&&h<=i[c].to&&(k=!0);k||y.push(v.getLegendData(n,s,u,f,t,o,h))})),l=Object(r.isNullOrUndefined)(p.label)?"Others":p.label,tt="[object Array]"===Object.prototype.toString.call(p.color)?p.color[0]:p.color,b.getOverallLegendItemsCollection(l,tt,y,p.showLegend));else{for(l=Object(r.isNullOrUndefined)(p.label)?p.value:p.label,a=[],nt=!1,Array.prototype.forEach.call(u,function(i,r){var u=e.indexOf(".")>-1?s(i,e):i[e];u===p.value?(nt=!0,-1===c.indexOf(u)&&c.push(u),a.push(v.getLegendData(n,r,i,f,t,o,u))):-1===h.indexOf(u)&&h.push(u)}),d=0;d<c.length;d++)for(g=0;g<h.length;g++)c[d]===h[g]&&(it=h.indexOf(c[d]),h.splice(it,1));nt||a.push({layerIndex:n,shapeIndex:null,dataIndex:null,name:null,value:null});rt=Object(r.isNullOrUndefined)(w)?"[object Array]"===Object.prototype.toString.call(p.color)?p.color[0]:p.color:w;b.getOverallLegendItemsCollection(l,rt,a,p.showLegend)}},b=this,p=0,k=i;p<k.length;p++)d(k[p])},n.prototype.getDataLegendCollection=function(n,t,i,u,f,e,o){var l,h=this,a=this.maps.legendSettings.fill,c=this.maps.legendSettings.valuePath;Object(r.isNullOrUndefined)(e)||Object(r.isNullOrUndefined)(u)||Array.prototype.forEach.call(u,function(u,v){var w=!!Object(r.isNullOrUndefined)(h.maps.legendSettings.showLegendPath)||!Object(r.isNullOrUndefined)(u[h.maps.legendSettings.showLegendPath])&&u[h.maps.legendSettings.showLegendPath],y=e.indexOf(".")>-1?s(u,e):u[e],p=[],b=Object(r.isNullOrUndefined)(a)?y:a;Object(r.isNullOrUndefined)(y)||0!==i.length||(l=Object(r.isNullOrUndefined)(u[c])?f.indexOf(".")>-1?s(u,f):u[f]:c.indexOf(".")>-1?s(u,c):u[c],p.push(h.getLegendData(n,v,u,f,t,o,y)));h.getOverallLegendItemsCollection(l,b,p,w)})},n.prototype.interactiveHandler=function(n){var e=n.target,t=this.maps.legendSettings,i=this.maps.element.id+"_Interactive_Legend",g="Layers"===t.type?"_shapeIndex_":"Markers"===t.type?"_MarkerIndex_":"_BubbleIndex_",l,b,a,u,s,f;if(e.id.indexOf(g)>1){var c=parseFloat(e.id.split("_LayerIndex_")[1].split("_")[0]),nt=parseFloat(e.id.split(/_dataIndex_/i)[1].split("_")[0]),v=void 0,p=void 0,w=void 0;if(Object(r.isNullOrUndefined)(h(i,this.maps.element.id))||Object(r.remove)(h(i,this.maps.element.id)),l=this.maps.layersCollection[c],b="Layers"===t.type?l.visible:"Markers"===t.type?l.markerSettings[parseFloat(e.id.split("_MarkerIndex_")[1].split("_")[0])].visible:this.maps.getBubbleVisible(this.maps.layersCollection[c]),t.visible&&this.legendRenderingCollections.length>0&&"Interactive"===t.mode&&b)for(a=this.maps.svgObject.getBoundingClientRect(),u=0;u<this.legendCollection.length;u++){var k=this.legendCollection[u],d=h(this.maps.element.id+"_Legend_Index_"+u,this.maps.element.id),o=d.getBoundingClientRect(),tt=new y(Math.abs(o.left-a.left),Math.abs(o.top-a.top),o.width,o.height);if(v=d.getAttribute("fill"),p=t.shapeBorder.color,w=t.shapeBorder.width,!Object(r.isNullOrUndefined)(k.data))for(s=k.data,f=0;f<s.length;f++)if(nt===s[f].dataIndex&&c===s[f].layerIndex){this.renderInteractivePointer(t,v,p,i,w,tt);break}}}else Object(r.isNullOrUndefined)(h(i,this.maps.element.id))||Object(r.remove)(h(i,this.maps.element.id))},n.prototype.renderInteractivePointer=function(n,t,i,r,u,f){var s,e,o,h;s="Horizontal"===("None"===n.orientation?"Top"===n.position||"Bottom"===n.position?"Horizontal":"Vertical":n.orientation)?n.invertedPointer?" M "+(e=f.x+f.width/2)+" "+(o=f.y+f.height)+" L "+(e-10)+" "+(o+10)+" L "+(e+10)+" "+(o+10)+" Z ":" M "+(e=f.x+f.width/2)+" "+(o=f.y)+" L "+(e-10)+" "+(o-10)+" L "+(e+10)+" "+(o-10)+" Z ":n.invertedPointer?" M "+(e=f.x)+" "+(o=f.y+f.height/2)+" L "+(e-10)+" "+(o-10)+" L "+(e-10)+" "+(o+10)+" z ":" M "+(e=f.x+f.width)+" "+(o=f.y+f.height/2)+" L "+(e+10)+" "+(o-10)+" L "+(e+10)+" "+(o+10)+" z ";h=new b(r,t,u,i,1,1,"",s);this.maps.svgObject.appendChild(this.maps.renderer.drawPath(h))},n.prototype.wireEvents=function(n){r.EventHandler.add(n,r.Browser.touchStartEvent,this.changeNextPage,this)},n.prototype.addEventListener=function(){this.maps.isDestroyed||(this.maps.on(r.Browser.touchMoveEvent,this.interactiveHandler,this),this.maps.on(r.Browser.touchEndEvent,this.interactiveHandler,this),this.maps.on(ft,this.legendClick,this))},n.prototype.markerToggleSelection=function(n,t,i,u){n.setAttribute("fill",this.legendCollection[u].fill);n.setAttribute("stroke",this.maps.layers[t].markerSettings[i].border.color);n.setAttribute("fill-opacity",this.maps.layers[t].markerSettings[i].opacity.toString());n.setAttribute("stroke-width",this.maps.layers[t].markerSettings[i].border.width.toString());n.setAttribute("stroke-opacity",(Object(r.isNullOrUndefined)(this.maps.layers[t].markerSettings[i].border.opacity)?this.maps.layers[t].markerSettings[i].opacity:this.maps.layers[t].markerSettings[i].border.opacity).toString())},n.prototype.bubbleToggleSelection=function(n,t,i,u){n.setAttribute("fill",this.legendCollection[u].fill);n.setAttribute("stroke",this.maps.layers[t].bubbleSettings[i].border.color);n.setAttribute("fill-opacity",this.maps.layers[t].bubbleSettings[i].opacity.toString());n.setAttribute("stroke-width",this.maps.layers[t].bubbleSettings[i].border.width.toString());n.setAttribute("stroke-opacity",(Object(r.isNullOrUndefined)(this.maps.layers[t].bubbleSettings[i].border.opacity)?this.maps.layers[t].bubbleSettings[i].opacity:this.maps.layers[t].bubbleSettings[i].border.opacity).toString())},n.prototype.legendClick=function(n){var w=this.maps.legendSettings.toggleLegendSettings.fill,b=this.maps.legendSettings.toggleLegendSettings.opacity,k=this.maps.legendSettings.toggleLegendSettings.border.color,d=this.maps.legendSettings.toggleLegendSettings.border.width,g=Object(r.isNullOrUndefined)(this.maps.legendSettings.toggleLegendSettings.border.opacity)?this.maps.legendSettings.toggleLegendSettings.opacity:this.maps.legendSettings.toggleLegendSettings.border.opacity,t,u,f,o,nt,p,y,c,a,s,tt;if(n.parentNode.id.indexOf(this.maps.element.id+"_Legend_Index_")>-1){var e=void 0,i=parseFloat(n.parentElement.id.substr((this.maps.element.id+"_Legend_Index_").length)),v=(y=this.legendCollection[i].data)._isVisible,l=void 0;if(this.maps.legendSettings.toggleLegendSettings.enable&&("Bubbles"===this.maps.legendSettings.type||"Markers"===this.maps.legendSettings.type))for(t=0;t<this.maps.layers.length;t++)for(u=0;u<("Bubbles"===this.maps.legendSettings.type?this.maps.layers[t].bubbleSettings.length:this.maps.layers[t].markerSettings.length);u++){for(f=0;f<y.length;f++)l=this.legendCollection[i].data[f],"Bubbles"===this.maps.legendSettings.type?e=h(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+l.dataIndex,this.maps.element.id):l.layerIndex==t&&l.markerIndex==u&&(e=h(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_MarkerIndex_"+u+"_dataIndex_"+l.dataIndex,this.maps.element.id)),Object(r.isNullOrUndefined)(l.shape)||"Balloon"!==l.shape||Object(r.isNullOrUndefined)(e)||(e=e.children[0]),v&&!Object(r.isNullOrUndefined)(e)?(this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(e.setAttribute("fill",this.maps.layers[t].shapeSettings.fill),e.setAttribute("stroke",this.maps.layers[t].shapeSettings.border.color),e.setAttribute("fill-opacity",this.maps.layers[t].shapeSettings.opacity.toString()),e.setAttribute("stroke-width",this.maps.layers[t].shapeSettings.border.width.toString()),e.setAttribute("stroke-opacity",(Object(r.isNullOrUndefined)(this.maps.layers[t].shapeSettings.border.opacity)?this.maps.layers[t].shapeSettings.opacity:this.maps.layers[t].shapeSettings.border.opacity).toString())):(e.setAttribute("fill",w),e.setAttribute("fill-opacity",b.toString()),e.setAttribute("stroke",k),e.setAttribute("stroke-width",d.toString()),e.setAttribute("stroke-opacity",g.toString())),null!==n&&(h(this.maps.element.id+"_Legend_Shape_Index_"+i,this.maps.element.id).setAttribute("fill","#E5E5E5"),h(this.maps.element.id+"_Legend_Text_Index_"+i,this.maps.element.id).setAttribute("fill","#E5E5E5"))):Object(r.isNullOrUndefined)(e)||("Markers"===this.maps.legendSettings.type?this.markerToggleSelection(e,t,u,i):this.bubbleToggleSelection(e,t,u,i),null!==n&&(h(this.maps.element.id+"_Legend_Shape_Index_"+i,this.maps.element.id).setAttribute("fill",this.legendCollection[i].fill),h(this.maps.element.id+"_Legend_Text_Index_"+i,this.maps.element.id).setAttribute("fill","#757575")));y._isVisible=!v}if("Layers"===this.maps.legendSettings.type&&this.maps.legendSettings.toggleLegendSettings.enable){for(o=void 0,this.removeCollections(n,i),nt=this.maps.toggledLegendId.indexOf(i),-1!==nt&&(v=!1),u=0;u<this.maps.layers.length;u++)for(f=0;f<y.length;f++)(l=this.legendCollection[i].data[f],null!==(o=h(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_shapeIndex_"+l.shapeIndex+"_dataIndex_"+l.dataIndex,this.maps.element.id)))&&(p=this.maps.toggledShapeElementId.indexOf(o.id),v?(0===f&&this.maps.toggledLegendId.push(i),-1===p&&this.maps.toggledShapeElementId.push(o.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(o.setAttribute("fill",this.maps.layers[u].shapeSettings.fill),o.setAttribute("fill-opacity",this.maps.layers[u].shapeSettings.opacity.toString()),o.setAttribute("stroke",this.maps.layers[u].shapeSettings.border.color),o.setAttribute("stroke-width",this.maps.layers[u].shapeSettings.border.width.toString()),o.setAttribute("stroke-opacity",(Object(r.isNullOrUndefined)(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity).toString())):(o.setAttribute("fill",w),o.setAttribute("fill-opacity",b.toString()),o.setAttribute("stroke",k),o.setAttribute("stroke-width",d.toString()),o.setAttribute("stroke-opacity",g.toString())),null!==n&&(h(this.maps.element.id+"_Legend_Text_Index_"+i,this.maps.element.id).setAttribute("fill","#E5E5E5"),h(this.maps.element.id+"_Legend_Shape_Index_"+i,this.maps.element.id).setAttribute("fill","#E5E5E5"))):(-1!==nt&&0===f&&this.maps.toggledLegendId.splice(nt,1),-1!==p&&this.maps.toggledShapeElementId.splice(p,1),o.setAttribute("fill",this.legendCollection[i].fill),o.setAttribute("stroke-opacity",(Object(r.isNullOrUndefined)(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity).toString()),o.setAttribute("stroke-width",this.maps.layers[u].shapeSettings.border.width.toString()),o.setAttribute("fill-opacity",this.maps.layers[u].shapeSettings.opacity.toString()),o.setAttribute("stroke",this.maps.layers[u].shapeSettings.border.color),null!==n&&(h(this.maps.element.id+"_Legend_Text_Index_"+i,this.maps.element.id).setAttribute("fill","#757575"),h(this.maps.element.id+"_Legend_Shape_Index_"+i,this.maps.element.id).setAttribute("fill",this.legendCollection[i].fill))));y._isVisible=!v}}else if(!Object(r.isNullOrUndefined)(n.id)&&(n.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")>-1||-1!==n.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendSettings.visible&&-1===n.id.indexOf("_Text")){if(c=void 0,a=(i=parseFloat(n.id.substr((this.maps.element.id+"_Legend_Index_").length)),void 0),v=(y=this.legendCollection[i].data)._isVisible,("Bubbles"===this.maps.legendSettings.type||"Markers"===this.maps.legendSettings.type)&&this.maps.legendSettings.toggleLegendSettings.enable)for(t=0;t<this.maps.layers.length;t++)for(u=0;u<("Bubbles"===this.maps.legendSettings.type?this.maps.layers[t].bubbleSettings.length:this.maps.layers[t].markerSettings.length);u++){for(f=0;f<y.length;f++)a=this.legendCollection[i].data[f],c="Bubbles"===this.maps.legendSettings.type?h(this.maps.element.id+"_LayerIndex_"+a.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+a.dataIndex,this.maps.element.id):h(this.maps.element.id+"_LayerIndex_"+a.layerIndex+"_MarkerIndex_"+u+"_dataIndex_"+a.dataIndex,this.maps.element.id),Object(r.isNullOrUndefined)(a.shape)||"Balloon"!==a.shape||(c=c.children[0]),v&&null!==c?(this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(c.setAttribute("fill",this.maps.layers[t].shapeSettings.fill),c.setAttribute("stroke",this.maps.layers[t].shapeSettings.border.color),c.setAttribute("stroke-width",this.maps.layers[t].shapeSettings.border.width.toString()),c.setAttribute("stroke-opacity",(Object(r.isNullOrUndefined)(this.maps.layers[t].shapeSettings.border.opacity)?this.maps.layers[t].shapeSettings.opacity:this.maps.layers[t].shapeSettings.border.opacity).toString()),c.setAttribute("fill-opacity",this.maps.layers[t].shapeSettings.opacity.toString())):(c.setAttribute("fill",w),c.setAttribute("fill-opacity",b.toString()),c.setAttribute("stroke",k),c.setAttribute("stroke-width",d.toString()),c.setAttribute("stroke-opacity",g.toString())),null!==n&&(h(this.maps.element.id+"_Legend_Index_"+i+"_Text",this.maps.element.id).setAttribute("fill","#E5E5E5"),h(this.maps.element.id+"_Legend_Index_"+i,this.maps.element.id).setAttribute("fill","#E5E5E5"))):("Markers"===this.maps.legendSettings.type?this.markerToggleSelection(c,t,u,i):this.bubbleToggleSelection(c,t,u,i),null!==n&&(h(this.maps.element.id+"_Legend_Index_"+i,this.maps.element.id).setAttribute("fill",this.legendCollection[i].fill),h(this.maps.element.id+"_Legend_Index_"+i+"_Text",this.maps.element.id).setAttribute("fill","#757575")));y._isVisible=!v}if("Layers"===this.maps.legendSettings.type&&this.maps.legendSettings.toggleLegendSettings.enable){for(s=void 0,this.removeCollections(n,i),tt=this.maps.toggledLegendId.indexOf(i),-1!==tt&&(v=!1),t=0;t<this.maps.layers.length;t++)for(f=0;f<y.length;f++)(a=this.legendCollection[i].data[f],null!==(s=h(this.maps.element.id+"_LayerIndex_"+a.layerIndex+"_shapeIndex_"+a.shapeIndex+"_dataIndex_"+a.dataIndex,this.maps.element.id)))&&(p=this.maps.toggledShapeElementId.indexOf(s.id),v?(0===f&&this.maps.toggledLegendId.push(i),-1===p&&this.maps.toggledShapeElementId.push(s.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(s.setAttribute("fill",this.maps.layers[0].shapeSettings.fill),s.setAttribute("stroke",this.maps.layers[0].shapeSettings.border.color),s.setAttribute("fill-opacity",this.maps.layers[t].shapeSettings.opacity.toString()),s.setAttribute("stroke-width",this.maps.layers[t].shapeSettings.border.width.toString()),s.setAttribute("stroke-opacity",(Object(r.isNullOrUndefined)(this.maps.layers[t].shapeSettings.border.opacity)?this.maps.layers[t].shapeSettings.opacity:this.maps.layers[t].shapeSettings.border.opacity).toString())):(s.setAttribute("fill",w),s.setAttribute("fill-opacity",b.toString()),s.setAttribute("stroke",k),s.setAttribute("stroke-width",d.toString()),s.setAttribute("stroke-opacity",g.toString())),null!==n&&(h(this.maps.element.id+"_Legend_Index_"+i,this.maps.element.id).setAttribute("fill","#E5E5E5"),h(this.maps.element.id+"_Legend_Index_"+i+"_Text",this.maps.element.id).setAttribute("fill","#E5E5E5"))):(-1!==tt&&0===f&&this.maps.toggledLegendId.splice(tt,1),-1!==p&&this.maps.toggledShapeElementId.splice(p,1),s.setAttribute("fill-opacity",this.maps.layers[t].shapeSettings.opacity.toString()),s.setAttribute("stroke-width",this.maps.layers[t].shapeSettings.border.width.toString()),s.setAttribute("stroke",this.maps.layers[0].shapeSettings.border.color),s.setAttribute("stroke-opacity",(Object(r.isNullOrUndefined)(this.maps.layers[t].shapeSettings.border.opacity)?this.maps.layers[t].shapeSettings.opacity:this.maps.layers[t].shapeSettings.border.opacity).toString()),s.setAttribute("fill",this.legendCollection[i].fill),null!==n&&(h(this.maps.element.id+"_Legend_Index_"+i+"_Text",this.maps.element.id).setAttribute("fill","#757575"),h(this.maps.element.id+"_Legend_Index_"+i,this.maps.element.id).setAttribute("fill",this.legendCollection[i].fill))));y._isVisible=!v}}},n.prototype.removeCollections=function(n,t){var i,r,u;this.removeLegendSelectionCollection(n);i=this.getIndexofLegend(this.maps.legendSelectionCollection,n);-1!==i&&this.maps.legendSelectionCollection.splice(i,1);-1!==this.getIndexofLegend(this.legendHighlightCollection,n)&&this.legendHighlightCollection.splice(i,1);r=this.getIndexofLegend(this.shapeHighlightCollection,n);-1!==r&&this.shapeHighlightCollection.splice(r,1);u=this.maps.selectedLegendElementId.indexOf(t);-1!==u&&this.maps.selectedLegendElementId.splice(u,1)},n.prototype.removeEventListener=function(){this.maps.isDestroyed||(this.maps.off(r.Browser.touchMoveEvent,this.interactiveHandler),this.maps.off(r.Browser.touchEndEvent,this.interactiveHandler),this.maps.off(ft,this.legendClick))},n.prototype.getLegendData=function(n,t,i,u,f,e,o){var v=[],h;if("[object Array]"===Object.prototype.toString.call(f))for(h=0;h<f.length;h++){var c=f[h],a=u.indexOf(".")>-1?s(i,u):i[u],l=ri(i[u],e,c.properties),y=Object(r.isNullOrUndefined)(a)?a:a.toLowerCase();(!Object(r.isNullOrUndefined)(c.properties[l])&&isNaN(c.properties[l])?c.properties[l].toLowerCase():c.properties[l])===y&&v.push({layerIndex:n,shapeIndex:h,dataIndex:t,name:i[u],value:o})}return v},n.prototype.legendGradientColor=function(n,t){var o,s="http://www.w3.org/2000/svg",u,h,f,c;if(!Object(r.isNullOrUndefined)(n.color)&&"object"==typeof n.color){var i=document.createElementNS(s,"linearGradient"),e=this.maps.legendSettings.position,l="Top"===e||"Bottom"===e?"100":"0",a="Top"===e||"Bottom"===e?"0":"100";for(i.setAttribute("id","linear_"+t+"_"+this.maps.element.id),i.setAttribute("x1","0%"),i.setAttribute("y1","0%"),i.setAttribute("x2",l+"%"),i.setAttribute("y2",a+"%"),u=0;u<n.color.length;u++)h=100/(n.color.length-1),f=document.createElementNS(s,"stop"),f.setAttribute("offset",u*h+"%"),f.setAttribute("stop-color",n.color[u]),f.setAttribute("stop-opacity",1..toString()),i.appendChild(f);this.legendLinearGradient=i;c="url(#linear_"+t+"_"+this.maps.element.id+")";this.defsElement.appendChild(i);o=c}return o},n.prototype.getModuleName=function(){return"Legend"},n.prototype.destroy=function(){this.removeEventListener()},n}(),pe=function(){function n(n){this.maps=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.maps.isDestroyed||(this.maps.on(r.Browser.touchMoveEvent,this.mouseMove,this),this.maps.on(r.Browser.touchStartEvent,this.mouseMove,this))},n.prototype.removeEventListener=function(){this.maps.isDestroyed||(this.maps.off(r.Browser.touchMoveEvent,this.mouseMove),this.maps.off(r.Browser.touchStartEvent,this.mouseMove))},n.prototype.addHighlight=function(n,t,i){var r=vr(n,t,0,this.maps);i?this.mapHighlight(r,null,null):p(r)},n.prototype.mouseMove=function(n){var i,t=n.target,v="touch"===n.pointerType||"2"===n.pointerType||n.type.indexOf("touch")>-1,h,c,u,f,l;if((-1!==t.id.indexOf("LayerIndex")||t.id.indexOf("NavigationIndex")>-1)&&"ShapeselectionMapStyle"!==t.getAttribute("class")&&!v&&"MarkerselectionMapStyle"!==t.getAttribute("class")&&"BubbleselectionMapStyle"!==t.getAttribute("class")&&"navigationlineselectionMapStyle"!==t.getAttribute("class")){i=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10);var s=void 0,o=void 0,a=void 0,e=void 0;t.id.indexOf("shapeIndex")>-1?(a=parseInt(t.id.split("_shapeIndex_")[1].split("_")[0],10),s=this.maps.layers[i].shapeData.features?this.maps.layers[i].shapeData.features[a].properties:null,e=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),o=Object(r.isNullOrUndefined)(e)?null:this.maps.layers[i].dataSource[e],this.highlightSettings=this.maps.layers[i].highlightSettings):t.id.indexOf("BubbleIndex")>-1?(h=parseInt(t.id.split("_BubbleIndex_")[1].split("_")[0],10),e=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),o=this.maps.layers[i].bubbleSettings[h].dataSource[e],this.highlightSettings=this.maps.layers[i].bubbleSettings[h].highlightSettings):t.id.indexOf("MarkerIndex")>-1?(c=parseInt(t.id.split("_MarkerIndex_")[1].split("_")[0],10),e=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),o=this.maps.layers[i].markerSettings[c].dataSource[e],this.highlightSettings=this.maps.layers[i].markerSettings[c].highlightSettings):(u=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),i=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),s=null,o={latitude:this.maps.layers[i].navigationLineSettings[u].latitude,longitude:this.maps.layers[i].navigationLineSettings[u].longitude},this.highlightSettings=this.maps.layers[i].navigationLineSettings[u].highlightSettings);this.highlightSettings.enable?(this.maps.legendSettings.visible&&-1===t.id.indexOf("_MarkerIndex_")&&this.maps.legendModule.shapeHighLightAndSelection(t,o,this.highlightSettings,"highlight",i),t.id.indexOf("shapeIndex")>-1&&this.maps.legendSettings.visible&&!this.maps.legendModule.shapeToggled||this.mapHighlight(t,s,o)):(f=document.getElementsByClassName("highlightMapStyle")[0],!Object(r.isNullOrUndefined)(f)&&(p(f),f.id.indexOf("NavigationIndex")>-1)&&(u=parseInt(f.id.split("_NavigationIndex_")[1].split("_")[0],10),l=parseInt(f.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),f.setAttribute("stroke-width",this.maps.layers[l].navigationLineSettings[u].width.toString()),f.setAttribute("stroke",this.maps.layers[l].navigationLineSettings[u].color)))}else fi("highlightMapStyle").length>0?((t=fi("highlightMapStyle")[0]).id.indexOf("NavigationIndex")>-1&&(u=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),i=parseInt(t.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),t.setAttribute("stroke-width",this.maps.layers[i].navigationLineSettings[u].width.toString()),t.setAttribute("stroke",this.maps.layers[i].navigationLineSettings[u].color)),p(t),this.maps.legendSettings.visible&&this.maps.legendModule.removeShapeHighlightCollection()):-1===t.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")&&-1===t.id.indexOf(this.maps.element.id+"_Legend_Index")||!this.maps.legendSettings.visible||-1!==t.id.indexOf("_Text")?this.maps.legendSettings.visible&&this.maps.legendModule.removeLegendHighlightCollection():this.maps.legendModule.legendHighLightAndSelection(t,"highlight")},n.prototype.mapHighlight=function(n,t,i){var u=this,h=parseInt(n.id.split("_LayerIndex_")[1].split("_")[0],10),e=!1,o,s,f;n.id.indexOf("MarkerIndex")>-1&&(o=parseInt(n.id.split("_MarkerIndex_")[1].split("_")[0],10),e=this.maps.layers[h].markerSettings[o].highlightSettings.enable);s={color:this.highlightSettings.border.color,width:this.highlightSettings.border.width/(e?1:this.maps.scale),opacity:this.highlightSettings.border.opacity};f={opacity:this.highlightSettings.opacity,fill:-1===n.id.indexOf("NavigationIndex")?Object(r.isNullOrUndefined)(this.highlightSettings.fill)?n.getAttribute("fill"):this.highlightSettings.fill:"none",border:s,name:"itemHighlight",target:n.id,cancel:!1,shapeData:t,data:i,maps:this.maps};this.maps.trigger("itemHighlight",f,function(){f.border.opacity=Object(r.isNullOrUndefined)(u.highlightSettings.border.opacity)?u.highlightSettings.opacity:u.highlightSettings.border.opacity;u.highlightMap(n,f)})},n.prototype.highlightMap=function(n,t){var i,r,u;"highlightMapStyle"!==n.getAttribute("class")&&(fi("highlightMapStyle").length>0&&(i=fi("highlightMapStyle")[0],(p(i),i.id.indexOf("NavigationIndex")>-1)&&(r=parseInt(i.id.split("_NavigationIndex_")[1].split("_")[0],10),u=parseInt(i.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),i.setAttribute("stroke-width",this.maps.layers[u].navigationLineSettings[r].width.toString()),i.setAttribute("stroke",this.maps.layers[u].navigationLineSettings[r].color))),c("highlightMap")?vt("highlightMap","highlightMapStyle",t):document.body.appendChild(ei("highlightMap","highlightMapStyle",t)),n.setAttribute("class","highlightMapStyle"))},n.prototype.getModuleName=function(){return"Highlight"},n.prototype.destroy=function(){this.removeEventListener()},n}(),we=function(){function n(n){this.maps=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.maps.isDestroyed||(this.maps.on(ft,this.mouseClick,this),this.maps.on(r.Browser.touchEndEvent,this.mouseClick,this))},n.prototype.removeEventListener=function(){this.maps.isDestroyed||(this.maps.off(ft,this.mouseClick),this.maps.off(r.Browser.touchEndEvent,this.mouseClick))},n.prototype.mouseClick=function(n){var s,h,f;if(!Object(r.isNullOrUndefined)(n.type)&&-1!==n.type.indexOf("touch")&&Object(r.isNullOrUndefined)(n.id)&&(n=n.target),!Object(r.isNullOrUndefined)(n.id)&&(n.id.indexOf("LayerIndex")>-1||n.id.indexOf("NavigationIndex")>-1)){var e=void 0,u=void 0,o=void 0,i=void 0,t=parseInt(n.id.split("_LayerIndex_")[1].split("_")[0],10);n.id.indexOf("shapeIndex")>-1?(o=parseInt(n.id.split("_shapeIndex_")[1].split("_")[0],10),e=this.maps.layers[t].shapeData.features.length>o?this.maps.layers[t].shapeData.features[o].properties:null,i=parseInt(n.id.split("_dataIndex_")[1].split("_")[0],10),u=Object(r.isNullOrUndefined)(i)?null:this.maps.layers[t].dataSource[i],this.selectionsettings=this.maps.layers[t].selectionSettings,this.selectionType="Shape"):n.id.indexOf("BubbleIndex")>-1?(s=parseInt(n.id.split("_BubbleIndex_")[1].split("_")[0],10),i=parseInt(n.id.split("_dataIndex_")[1].split("_")[0],10),u=this.maps.layers[t].bubbleSettings[s].dataSource[i],this.selectionsettings=this.maps.layers[t].bubbleSettings[s].selectionSettings,this.selectionType="Bubble"):n.id.indexOf("MarkerIndex")>-1?(h=parseInt(n.id.split("_MarkerIndex_")[1].split("_")[0],10),i=parseInt(n.id.split("_dataIndex_")[1].split("_")[0],10),u=this.maps.layers[t].markerSettings[h].dataSource[i],this.selectionsettings=this.maps.layers[t].markerSettings[h].selectionSettings,this.selectionType="Marker"):(f=parseInt(n.id.split("_NavigationIndex_")[1].split("_")[0],10),e=null,u={latitude:this.maps.layers[t].navigationLineSettings[f].latitude,longitude:this.maps.layers[t].navigationLineSettings[f].longitude},this.selectionsettings=this.maps.layers[t].navigationLineSettings[f].selectionSettings,this.selectionType="navigationline");this.selectionsettings.enable&&(this.maps.mapSelect=!!n,this.maps.legendSettings.visible&&-1===n.id.indexOf("_MarkerIndex_")&&this.maps.legendModule.shapeHighLightAndSelection(n,u,this.selectionsettings,"selection",t),(!(n.id.indexOf("shapeIndex")>-1&&this.maps.legendSettings.visible)||this.maps.legendModule.shapeToggled)&&this.selectMap(n,e,u))}else this.maps.legendSettings.visible&&!this.maps.legendSettings.toggleLegendSettings.enable&&!Object(r.isNullOrUndefined)(n.id)&&-1===n.id.indexOf("_Text")&&(n.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")>-1||-1!==n.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendModule.legendHighLightAndSelection(n,"selection")},n.prototype.addSelection=function(n,t,i){var r=vr(n,t,0,this.maps);i?this.selectMap(r,null,null):p(r)},n.prototype.selectMap=function(n,t,i){var u=this,o=(this.selectionsettings,{color:this.selectionsettings.border.color,width:this.selectionsettings.border.width/("Marker"===this.selectionType?1:this.maps.scale),opacity:this.selectionsettings.border.opacity}),f={opacity:this.selectionsettings.opacity,fill:"navigationline"!==this.selectionType?this.selectionsettings.fill:"none",border:o,name:bu,target:n.id,cancel:!1,shapeData:t,data:i,maps:this.maps};this.maps.trigger("itemSelection",f,function(){var s,i,o,h,v,l,y;if(f.border.opacity=Object(r.isNullOrUndefined)(u.selectionsettings.border.opacity)?u.selectionsettings.opacity:u.selectionsettings.border.opacity,!f.cancel)if(n.getAttribute("class")===u.selectionType+"selectionMapStyle"){for(p(n),u.removedSelectionList(n),s=0;s<u.maps.shapeSelectionItem.length;s++)if(u.maps.shapeSelectionItem[s]===f.shapeData){u.maps.shapeSelectionItem.splice(s,1);break}n.id.indexOf("NavigationIndex")>-1&&(i=parseInt(n.id.split("_NavigationIndex_")[1].split("_")[0],10),o=parseInt(n.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),n.setAttribute("stroke-width",u.maps.layers[o].navigationLineSettings[i].width.toString()),n.setAttribute("stroke",u.maps.layers[o].navigationLineSettings[i].color))}else{if(h=e(u.maps.element.id+"_Layer_Collections"),!u.selectionsettings.enableMultiSelect&&h.getElementsByClassName(u.selectionType+"selectionMapStyle").length>0){for(var w=h.getElementsByClassName(u.selectionType+"selectionMapStyle").length,t=void 0,a=0;a<w;a++)p(t=h.getElementsByClassName(u.selectionType+"selectionMapStyle")[0]),u.removedSelectionList(t);if("Shape"===u.selectionType)for(u.maps.shapeSelectionItem=[],v=u.maps.selectedElementId.length,l=0;l<v;l++)p(t=h.getElementsByClassName(u.selectionType+"selectionMapStyle")[0]),y=u.maps.selectedElementId.indexOf(t.getAttribute("id")),u.maps.selectedElementId.splice(y,1);t.id.indexOf("NavigationIndex")>-1&&(i=parseInt(n.id.split("_NavigationIndex_")[1].split("_")[0],10),o=parseInt(n.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),t.setAttribute("stroke-width",u.maps.layers[o].navigationLineSettings[i].width.toString()),t.setAttribute("stroke",u.maps.layers[o].navigationLineSettings[i].color))}c(u.selectionType+"selectionMap")?vt(u.selectionType+"selectionMap",u.selectionType+"selectionMapStyle",f):document.body.appendChild(ei(u.selectionType+"selectionMap",u.selectionType+"selectionMapStyle",f));n.setAttribute("class",u.selectionType+"selectionMapStyle");"ShapeselectionMapStyle"===n.getAttribute("class")&&(u.maps.shapeSelectionClass=c(u.selectionType+"selectionMap"),u.maps.selectedElementId.push(n.getAttribute("id")),u.maps.shapeSelectionItem.push(f.shapeData));"MarkerselectionMapStyle"===n.getAttribute("class")&&(u.maps.markerSelectionClass=c(u.selectionType+"selectionMap"),u.maps.selectedMarkerElementId.push(n.getAttribute("id")));"BubbleselectionMapStyle"===n.getAttribute("class")&&(u.maps.bubbleSelectionClass=c(u.selectionType+"selectionMap"),u.maps.selectedBubbleElementId.push(n.getAttribute("id")));"navigationlineselectionMapStyle"===n.getAttribute("class")&&(u.maps.navigationSelectionClass=c(u.selectionType+"selectionMap"),u.maps.selectedNavigationElementId.push(n.getAttribute("id")))}})},n.prototype.removedSelectionList=function(n){"Shape"===this.selectionType&&this.maps.selectedElementId.splice(this.maps.selectedElementId.indexOf(n.getAttribute("id")),1);"Bubble"===this.selectionType&&this.maps.selectedBubbleElementId.splice(this.maps.selectedBubbleElementId.indexOf(n.getAttribute("id")),1);"Marker"===this.selectionType&&this.maps.selectedMarkerElementId.splice(this.maps.selectedMarkerElementId.indexOf(n.getAttribute("id")),1);"navigationline"===this.selectionType&&this.maps.selectedBubbleElementId.splice(this.maps.selectedBubbleElementId.indexOf(n.getAttribute("id")),1)},n.prototype.getModuleName=function(){return"Selection"},n.prototype.destroy=function(){this.removeEventListener()},n}(),be=function(){function n(n){this.maps=n;this.tooltipId=this.maps.element.id+"_mapsTooltip";this.addEventListener()}return n.prototype.renderTooltip=function(n){var ut,et,d,ot,o,y,t,u=this,ht,w,k,tt,it,at,yt,l,rt;-1!==n.type.indexOf("touch")?(this.isTouch=!0,ut=(ot=n).changedTouches[0].pageX,et=ot.changedTouches[0].pageY,d=ot.target):(this.isTouch="touch"===n.pointerType,ut=n.pageX,et=n.pageY,d=n.target);var g,nt,v="",f=d.id,p=[],h=f.indexOf("_LayerIndex_")>-1&&parseFloat(f.split("_LayerIndex_")[1].split("_")[0]),i=this.maps.layersCollection[h],pt=li(ut,et,this.maps.svgObject);if(this.tooltipTargetID=f,f.indexOf("_shapeIndex_")>-1||f.indexOf("_MarkerIndex_")>-1||f.indexOf("_BubbleIndex_")>-1){if(f.indexOf("_shapeIndex_")>-1){if((t=i.tooltipSettings).textStyle.fontFamily=this.maps.themeStyle.fontFamily||t.textStyle.fontFamily,t.textStyle.opacity=this.maps.themeStyle.tooltipTextOpacity||t.textStyle.opacity,ht=parseInt(f.split("_shapeIndex_")[1].split("_")[0],10),Object(r.isNullOrUndefined)(i.layerData)||Object(r.isNullOrUndefined)(i.layerData[ht]))return;var c=i.layerData[ht].property,ct=!1,b="[object Array]"===Object.prototype.toString.call(i.shapePropertyPath)?i.shapePropertyPath:[i.shapePropertyPath];if(!Object(r.isNullOrUndefined)(b)){for(w=0;w<b.length;w++)for(k=0;k<i.dataSource.length;k++)if(tt=i.dataSource[k],it=i.shapeDataPath.indexOf(".")>-1?s(tt,i.shapeDataPath):tt[i.shapeDataPath],(!Object(r.isNullOrUndefined)(it)&&isNaN(tt[i.shapeDataPath])?it.toLowerCase():it)===(!Object(r.isNullOrUndefined)(c[b[w]])&&isNaN(c[b[w]])?c[b[w]].toLowerCase():c[b[w]])){ct=!0;h=k;w=b.length;break}if(h=ct?h:null,!Object(r.isNullOrUndefined)(i.dataSource[h]))for(nt in p=JSON.parse(JSON.stringify(i.dataSource[h])),c)p.hasOwnProperty(nt)||(p[nt]=c[nt])}!t.visible||(Object(r.isNullOrUndefined)(h)||isNaN(h))&&Object(r.isNullOrUndefined)(c)||(i.tooltipSettings.format?v=this.formatter(i.tooltipSettings.format,p):(at=ri(i.shapeDataPath,i.shapePropertyPath,c),v=Object(r.isNullOrUndefined)(i.dataSource)||Object(r.isNullOrUndefined)(h)?c[at]:lt(t.valuePath.indexOf(".")>-1?s(i.dataSource[h],t.valuePath):i.dataSource[h][t.valuePath],this.maps),Object(r.isNullOrUndefined)(v)&&(v=t.valuePath.indexOf(".")>-1?s(c,t.valuePath):c[t.valuePath])))}else if(f.indexOf("_MarkerIndex_")>-1){var vt=parseInt(f.split("_MarkerIndex_")[1].split("_")[0],10),a=parseInt(f.split("_MarkerIndex_")[1].split("_")[2],10),e=i.markerSettings[vt];t=e.tooltipSettings;p=e.dataSource[a];t.visible&&!isNaN(vt)&&(v=e.tooltipSettings.format?this.formatter(e.tooltipSettings.format,e.dataSource[a]):e.template&&!e.tooltipSettings.valuePath?e.template.split(">")[1].split("<")[0]:lt(e.tooltipSettings.valuePath.indexOf(".")>-1?s(e.dataSource[a],e.tooltipSettings.valuePath):e.dataSource[a][e.tooltipSettings.valuePath],this.maps))}else f.indexOf("_BubbleIndex_")>-1&&(yt=parseInt(f.split("_BubbleIndex_")[1].split("_")[0],10),l=(a=parseInt(f.split("_BubbleIndex_")[1].split("_")[2],10),i.bubbleSettings[yt]),t=l.tooltipSettings,p=l.dataSource[a],t.visible&&!isNaN(a)&&(v=l.tooltipSettings.format?this.formatter(l.tooltipSettings.format,l.dataSource[a]):lt(l.tooltipSettings.valuePath.indexOf(".")>-1?s(l.dataSource[a],l.tooltipSettings.valuePath):l.dataSource[a][l.tooltipSettings.valuePath],this.maps)));document.getElementById(this.tooltipId)?g=document.getElementById(this.tooltipId):(g=Object(r.createElement)("div",{id:this.maps.element.id+"_mapsTooltip",className:"EJ2-maps-Tooltip",styles:"position: absolute;pointer-events:none;"}),document.getElementById(this.maps.element.id+"_Secondary_Element").appendChild(g));null!==t.template&&1===Object.keys("object"==typeof t.template?t.template:{}).length&&(t.template=t.template[Object.keys(t.template)[0]]);rt={location:pt,text:[],data:p=this.setTooltipContent(t,p),textStyle:t.textStyle,template:t.template};o={cancel:!1,name:"tooltipRender",options:rt,fill:t.fill,maps:this.maps,element:d,eventArgs:n};this.maps.trigger("tooltipRender",o,function(){if(o.cancel||!t.visible||Object(r.isNullOrUndefined)(v)||-1!==f.indexOf("_cluster_")||-1!==f.indexOf("_dataLabel_"))u.removeTooltip(),u.maps.clearTemplate();else if(u.maps.isProtectedOnChange=!0,o.options.textStyle.color=o.options.textStyle.color||u.maps.themeStyle.tooltipFontColor,u.svgTooltip=o.cancel?new st.Tooltip({enable:!0,header:"",data:t.data,template:t.template,content:[v.toString()],shapes:[],location:t.location,palette:[void 0],areaBounds:u.maps.mapAreaRect,textStyle:t.textStyle,availableSize:u.maps.availableSize,fill:t.fill||u.maps.themeStyle.tooltipFillColor}):new st.Tooltip({enable:!0,header:"",data:o.options.data,template:o.options.template,content:[v.toString()],shapes:[],location:o.options.location,palette:[void 0],areaBounds:u.maps.mapAreaRect,textStyle:o.options.textStyle,availableSize:u.maps.availableSize,fill:o.fill||u.maps.themeStyle.tooltipFillColor}),u.svgTooltip.opacity=u.maps.themeStyle.tooltipFillOpacity||u.svgTooltip.opacity,u.svgTooltip.appendTo(g),u.maps.renderReactTemplates(),null!==(y=document.getElementById(u.maps.element.id+"_mapsTooltip"))&&-1!==y.innerHTML.indexOf("href")&&-1!==y.innerHTML.indexOf("<\/a>")){var n=y.getAttribute("style");n=n.replace("pointer-events: none;","position-events:all;");y.setAttribute("style",n)}});this.svgTooltip&&this.maps.trigger("tooltipRenderComplete",{cancel:!1,name:"tooltipRenderComplete",maps:this.maps,options:rt,element:this.svgTooltip.element});this.svgTooltip?this.maps.trigger("tooltipRenderComplete",{cancel:!1,name:"tooltipRenderComplete",maps:this.maps,options:rt,element:this.svgTooltip.element}):(this.removeTooltip(),this.maps.clearTemplate())}else null!==(y=document.getElementById(this.maps.element.id+"_mapsTooltip"))&&-1!==y.innerHTML.indexOf("href")&&-1!==y.innerHTML.indexOf("<\/a>")?this.maps.notify(ft,this):(this.removeTooltip(),this.maps.clearTemplate())},n.prototype.setTooltipContent=function(n,t){var i=Object(r.extend)({},t,null,!0);return this.maps.format&&!isNaN(Number(i[n.valuePath]))?i[n.valuePath]=ar(this.maps,Number(i[n.valuePath])):i=Object.keys(i).length?i:void 0,i},n.prototype.formatter=function(n,t){var i,u,r;for(void 0===t&&(t={}),i=0,u=Object.keys(t);i<u.length;i++)r=u[i],n="object"==typeof t[r]?ur("",n,t,this.maps):n.split("${"+r+"}").join(lt(t[r],this.maps));return n},n.prototype.mouseUpHandler=function(n){this.renderTooltip(n);"MouseMove"===this.maps.tooltipDisplayMode&&(clearTimeout(this.clearTimeout),this.clearTimeout=setTimeout(this.removeTooltip.bind(this),2e3))},n.prototype.removeTooltip=function(){document.getElementsByClassName("EJ2-maps-Tooltip").length>0&&Object(r.remove)(document.getElementsByClassName("EJ2-maps-Tooltip")[0])},n.prototype.addEventListener=function(){this.maps.isDestroyed||("DoubleClick"===this.maps.tooltipDisplayMode?this.maps.on("dblclick",this.renderTooltip,this):"Click"===this.maps.tooltipDisplayMode?this.maps.on(r.Browser.touchEndEvent,this.mouseUpHandler,this):this.maps.on(r.Browser.touchMoveEvent,this.renderTooltip,this),this.maps.element.addEventListener("contextmenu",this.removeTooltip),this.maps.on(r.Browser.touchCancelEvent,this.removeTooltip,this))},n.prototype.removeEventListener=function(){this.maps.isDestroyed||("DoubleClick"===this.maps.tooltipDisplayMode?this.maps.off("dblclick",this.removeTooltip):"Click"===this.maps.tooltipDisplayMode?this.maps.off(r.Browser.touchEndEvent,this.mouseUpHandler):this.maps.off(r.Browser.touchMoveEvent,this.renderTooltip),this.maps.off(r.Browser.touchCancelEvent,this.removeTooltip))},n.prototype.getModuleName=function(){return"MapsTooltip"},n.prototype.destroy=function(){this.removeEventListener()},n}(),ke=function(){function n(n){this.isPanning=!1;this.mouseEnter=!1;this.isTouch=!1;this.rectZoomingStart=!1;this.pinchRect=new y(0,0,0,0);this.browserName=r.Browser.info.name;this.isPointer=r.Browser.isPointer;this.handled=!1;this.pinchFactor=1;this.startTouches=[];this.shapeZoomLocation=[];this.intersect=[];this.mouseDownLatLong={x:0,y:0};this.mouseMoveLatLong={x:0,y:0};this.isSingleClick=!1;this.maps=n;this.wheelEvent="mozilla"===this.browserName?this.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel";this.cancelEvent=this.isPointer?"pointerleave":"mouseleave";this.selectionColor=this.maps.zoomSettings.selectionColor;this.fillColor=this.maps.zoomSettings.color;this.addEventListener();this.groupElements=[]}return n.prototype.performZooming=function(n,t,i){var s=this,r=this.maps,c;r.previousProjection=r.projectionType;r.defaultState=!1;r.initialCheck=!1;r.markerZoomedState=!1;r.zoomPersistence=r.enablePersistence;var h=r.tileZoomLevel,v=r.previousScale=r.scale,y=r.zoomSettings.maxZoom,f=r.zoomSettings.minZoom;if(t=f>t&&"ZoomIn"===i?f+1:t,c=r.tileTranslatePoint,!r.isTileMap&&("ZoomIn"===i?t>=f&&t<=y:t>=f)){var u=r.mapAreaRect,e=r.baseMapRectBounds.min,p=r.baseMapRectBounds.max,k=Math.abs(e.x-p.x),d=Math.abs(e.y-p.y),w=r.translatePoint,l=w.x-(u.width/v-u.width/t)/(u.width/n.x),a=w.y-(u.height/v-u.height/t)/(u.height/n.y),b=Math.abs(r.baseMapRectBounds.max.y-r.baseMapRectBounds.min.y)*t;l=b<r.mapAreaRect.height?u.x+(-e.x+(u.width/2-k/2)):l;a=b<r.mapAreaRect.height?u.y+(-e.y+(u.height/2-d/2)):a;r.translatePoint=new o(l,a);r.scale=t;this.triggerZoomEvent(c,h,i);this.applyTransform()}else r.isTileMap&&t>=f&&t<=y&&(this.getTileTranslatePosition(h,t,n,i),r.tileZoomLevel=t,r.zoomSettings.zoomFactor=t,r.scale=Math.pow(2,t-1),"ZoomOut"===i&&r.zoomSettings.resetToInitial&&r.applyZoomReset&&t<=r.initialZoomLevel&&(r.initialCheck=!0,r.zoomPersistence=!1,r.tileTranslatePoint.x=r.initialTileTranslate.x,r.tileTranslatePoint.y=r.initialTileTranslate.y,t=r.tileZoomLevel=r.mapScaleValue=r.initialZoomLevel,r.scale=Math.pow(2,t-1)),r.translatePoint.y=(r.tileTranslatePoint.y-.01*r.mapScaleValue)/r.scale,r.translatePoint.x=(r.tileTranslatePoint.x-.01*r.mapScaleValue)/r.scale,this.triggerZoomEvent(c,h,i),document.querySelector(".GroupElement")&&(document.querySelector(".GroupElement").style.display="none"),document.getElementById(this.maps.element.id+"_LayerIndex_1")&&(document.getElementById(this.maps.element.id+"_LayerIndex_1").style.display="none"),r.mapLayerPanel.generateTiles(t,r.tileTranslatePoint,i+"wheel",null,n),document.getElementById(this.maps.element.id+"_tiles"),setTimeout(function(){s.applyTransform();document.getElementById(s.maps.element.id+"_LayerIndex_1")&&(document.getElementById(s.maps.element.id+"_LayerIndex_1").style.display="block")},250));this.maps.zoomNotApplied=!1},n.prototype.triggerZoomEvent=function(n,t,i){var u,r=this.maps;u=r.isTileMap?{cancel:!1,name:"zoom",type:i,maps:r,tileTranslatePoint:{previous:n,current:r.tileTranslatePoint},translatePoint:{previous:r.previousPoint,current:r.translatePoint},tileZoomLevel:{previous:t,current:r.tileZoomLevel},scale:{previous:r.previousScale,current:r.scale}}:{cancel:!1,name:"zoom",type:i,maps:r,tileTranslatePoint:{},translatePoint:{previous:r.previousPoint,current:r.translatePoint},tileZoomLevel:{},scale:{previous:r.previousScale,current:r.scale}};r.trigger("zoom",u)},n.prototype.getTileTranslatePosition=function(n,t,i,r){var u=this.maps,s="ZoomOut"===r?10:"Reset"===r&&t>1?0:10,f=u.availableSize,e=256*Math.pow(2,n),o=256*Math.pow(2,t),h=(i.x-u.tileTranslatePoint.x)/e*100,c=(i.y-u.tileTranslatePoint.y)/e*100;u.tileTranslatePoint.x=1===t?f.width/2-256:i.x-h*o/100;u.tileTranslatePoint.y=1===t?f.height/2-256+2*s:i.y-c*o/100},n.prototype.performRectZooming=function(){var n,i,f;this.isDragZoom=!0;n=this.maps;i=n.availableSize;n.previousProjection=n.projectionType;var u=n.tileZoomLevel,e=n.tileTranslatePoint,r=this.zoomingRect,s=n.zoomSettings.maxZoom,a=n.zoomSettings.minZoom;if(r.height>0&&r.width>0){var h=this.zoomingRect.x+this.zoomingRect.width/2,c=this.zoomingRect.y+this.zoomingRect.height/2,t=void 0;if(n.isTileMap)t=(t=u+Math.round(u+(i.width/r.width+i.height/r.height)/2))>=a&&t<=s?t:s,n.zoomSettings.zoomFactor=t,this.getTileTranslatePosition(u,t,{x:h,y:c}),n.tileZoomLevel=t,n.translatePoint.x=(n.tileTranslatePoint.x-.5*Math.pow(2,t))/Math.pow(2,t),n.translatePoint.y=(n.tileTranslatePoint.y-.5*Math.pow(2,t))/Math.pow(2,t),n.scale=Math.pow(2,t),this.triggerZoomEvent(e,u,""),n.mapLayerPanel.generateTiles(t,n.tileTranslatePoint);else{f=n.previousScale=n.scale;t=f+Math.round((i.width/r.width+i.height/r.height)/2);var l=n.previousPoint=n.translatePoint,v=l.x-(i.width/f-i.width/t)/(i.width/h),y=l.y-(i.height/f-i.height/t)/(i.height/c);n.translatePoint=new o(v,y);n.scale=t;this.triggerZoomEvent(e,u,"")}n.mapScaleValue=t;this.applyTransform(!0);this.maps.zoomNotApplied=!1;this.zoomingRect=null}},n.prototype.setInteraction=function(n){this.lastScale=1;this.interaction=n},n.prototype.updateInteraction=function(){2===this.fingers?this.setInteraction("zoom"):this.setInteraction(null)},n.prototype.performPinchZooming=function(){var n=this.maps,e=n.tileZoomLevel,t=n.mapAreaRect,r,i;n.previousScale=n.scale;n.previousPoint=n.translatePoint;var s,h,v,y,p,c,w,b,k=n.tileTranslatePoint,d=(s=this.touchStartList,h=this.touchMoveList,v=kr(s[0],s[1]),kr(h[0],h[1])/v),u=function(n){return{x:n.map(function(n){return n.x}).reduce(dr)/n.length,y:n.map(function(n){return n.y}).reduce(dr)/n.length}}((y=this.touchMoveList,p=this.maps,c=p.element.getBoundingClientRect(),w=c.top+document.defaultView.pageXOffset,b=c.left+document.defaultView.pageYOffset,Array.prototype.slice.call(y).map(function(n){return{x:n.pageX-b,y:n.pageY-w}}))),it=d/this.lastScale;if(this.lastScale=d,this.pinchFactor*=it,this.pinchFactor=Math.min(this.maps.zoomSettings.maxZoom,Math.max(this.pinchFactor,this.maps.zoomSettings.minZoom)),r=this.pinchFactor,n.isTileMap)i=r,this.getTileTranslatePosition(e,i,{x:u.x,y:u.y}),n.tileZoomLevel=i,n.translatePoint.x=(n.tileTranslatePoint.x-.5*Math.pow(2,i))/Math.pow(2,i),n.translatePoint.y=(n.tileTranslatePoint.y-.5*Math.pow(2,i))/Math.pow(2,i),n.scale=Math.pow(2,i),this.triggerZoomEvent(k,e,""),n.mapLayerPanel.generateTiles(i,n.tileTranslatePoint);else{var f=n.baseMapRectBounds.min,g=n.baseMapRectBounds.max,rt=Math.abs(f.y-g.y),ut=Math.abs(f.x-g.x),nt=n.translatePoint,tt=Math.abs(n.baseMapRectBounds.max.y-n.baseMapRectBounds.min.y)*r,l=nt.x-(t.width/n.scale-t.width/r)/(t.width/u.x),a=nt.y-(t.height/n.scale-t.height/r)/(t.height/u.y);l=tt<n.mapAreaRect.height?t.x+(-f.x+(t.width/2-ut/2)):l;a=tt<n.mapAreaRect.height?t.y+(-f.y+(t.height/2-rt/2)):a;n.translatePoint=new o(l,a);n.scale=r;this.triggerZoomEvent(k,e,"")}this.applyTransform()},n.prototype.drawZoomRectangle=function(){var n=this.maps,t=this.mouseDownPoints,i=this.mouseMovePoints,o=Math.abs(i.x-t.x),s=Math.abs(i.y-t.y),r=i.x>t.x?t.x:t.x-o,u=i.y>t.y?t.y:t.y-s,f,h;e(n.element.id).getBoundingClientRect();r>n.mapAreaRect.x&&r<n.mapAreaRect.x+n.mapAreaRect.width&&u>n.mapAreaRect.y&&u<n.mapAreaRect.y+n.mapAreaRect.height&&(this.zoomingRect=new y(r,u,o,s),f=n.renderer.createSvg({id:n.element.id+"_Selection_Rect_Zooming",width:n.availableSize.width,height:n.availableSize.height}),h=new k(n.element.id+"_ZoomRect","#d3d3d3",{width:1,color:"#009900"},.5,this.zoomingRect,0,0,"","3"),f.appendChild(n.renderer.drawRectangle(h)),e(n.element.id+"_Secondary_Element").appendChild(f))},n.prototype.animateTransform=function(n,t,i,r,u){var f=this.currentLayer.animationDuration;t&&0!==f?function(n,t,i,r,u,f,e){var c=0,o=e.previousPoint,l=e.previousScale,v=u-l,s=new rt(0,0),h=1;if(u!==l){var a=function(n,t){return n.x===t.x?null:(t.y-n.y)/(t.x-n.x)}(o,r),y=function(n,t){return null===t?n.x:n.y-t*n.x}(o,a),p=r.x-o.x,w=r.y-o.y;gr(n,t,i,function(n){n.timeStamp>n.delay&&(c=(n.timeStamp-n.delay)/n.duration,h=l+c*v,s.x=o.x+c*p/(h/u),s.y=null==a?o.y+c*w:a*s.x+y,n.element.setAttribute("transform","scale( "+h+" ) translate( "+s.x+" "+s.y+" )"),e.translatePoint=s,e.scale=h,e.zoomModule.processTemplate(r.x,r.y,h,e))},function(){e.translatePoint=r;e.scale=u;n.setAttribute("transform","scale( "+u+" ) translate( "+r.x+" "+r.y+" )");e.zoomModule.processTemplate(r.x,r.y,u,e)})}else n.setAttribute("transform","scale( "+u+" ) translate( "+r.x+" "+r.y+" )")}(n,0,f,new rt(i,r),u,this.maps.mapAreaRect,this.maps):n.setAttribute("transform","scale("+u+") translate( "+i+" "+r+" )")},n.prototype.applyTransform=function(n){var ft,b,u,k,y,t,i,p,w,it,ut,s,ot,nt,l,tt,lt;this.templateCount=0;var f=this.maps.scale,e=this.maps.translatePoint.x,o=this.maps.translatePoint.y;if(this.maps.zoomShapeCollection=[],document.getElementById(this.maps.element.id+"_mapsTooltip")&&a(this.maps.element.id+"_mapsTooltip"),this.layerCollectionEle){for(b=0;b<this.layerCollectionEle.childElementCount;b++){if(u=this.layerCollectionEle.childNodes[b],"g"===u.tagName)for(this.templateCount++,this.index=u.id.indexOf("_LayerIndex_")>-1&&parseFloat(u.id.split("_LayerIndex_")[1].split("_")[0]),this.currentLayer=this.maps.layersCollection[this.index],k=this.maps.mapLayerPanel.calculateFactor(this.currentLayer),y=0;y<u.childElementCount;y++)if(t=u.childNodes[y],t.id.indexOf("_Markers_Group")>-1||t.id.indexOf("_bubble_Group")>-1||t.id.indexOf("_dataLableIndex_Group")>-1){if(t.id.indexOf("_Markers_Group")>-1){if(this.isPanning||this.markerTranslates(t.childNodes[0],k,e,o,f,"Marker",u,n),t=u.childNodes[y],!Object(r.isNullOrUndefined)(t)&&-1!==t.id.indexOf("Markers")){for(i=0;i<t.childElementCount;i++){this.markerTranslate(t.childNodes[i],k,e,o,f,"Marker",n);parseInt(t.childNodes[i].id.split("_LayerIndex_")[1].split("_")[0],10);for(var d=parseInt(t.childNodes[i].id.split("_dataIndex_")[1].split("_")[0],10),h=parseInt(t.childNodes[i].id.split("_MarkerIndex_")[1].split("_")[0],10),et=this.currentLayer.markerSettings[h].dataSource[d],g=0;g<this.currentLayer.markerSettings[h].initialMarkerSelection.length;g++)this.currentLayer.markerSettings[h].initialMarkerSelection[g].latitude!==et.latitude&&this.currentLayer.markerSettings[h].initialMarkerSelection[g].longitude!==et.longitude||this.maps.markerSelection(this.currentLayer.markerSettings[h].selectionSettings,this.maps,t.children[i],this.currentLayer.markerSettings[h].dataSource[d]);!this.maps.isTileMap&&this.currentLayer.animationDuration>0&&t.setAttribute("style","visibility:hidden")}(this.isPanning&&this.maps.markerModule.sameMarkerData.length>0?or(this.maps.markerModule.sameMarkerData,this.maps,t,!0):this.maps.markerModule.sameMarkerData.length>0&&(this.maps.markerModule.sameMarkerData=[],document.getElementById(this.maps.element.id+"_mapsTooltip")&&a(this.maps.element.id+"_mapsTooltip")),document.getElementById(this.maps.element.id+"_mapsTooltip")&&this.maps.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")&&!this.isPanning)&&(p=this.maps.mapsTooltipModule,w=t.querySelector("#"+p.tooltipTargetID),Object(r.isNullOrUndefined)(w)||("hidden"===w.style.visibility?a(this.maps.element.id+"_mapsTooltip"):(it=parseFloat(w.getAttribute("transform").split("(")[1].split(")")[0].split(" ")[1]),ut=parseFloat(w.getAttribute("transform").split("(")[1].split(")")[0].split(" ")[2]),this.maps.isTileMap&&(it+=+c(this.maps.element.id+"_tile_parent").style.left.split("px")[0],ut+=+c(this.maps.element.id+"_tile_parent").style.top.split("px")[0]),p.svgTooltip.location.x=it,p.svgTooltip.location.y=ut,p.svgTooltip.enableAnimation=!1)))}}else if(t.id.indexOf("_bubble_Group")>-1){for(s=void 0,i=0;i<t.childElementCount;i++)for((s=t.childNodes[i]).getAttribute("transform"),ft=parseFloat(s.id.split("_LayerIndex_")[1].split("_")[0]),ot=parseFloat(s.id.split("_BubbleIndex_")[1].split("_")[0]),nt=(d=parseFloat(s.id.split("_BubbleIndex_")[1].split("_")[2]),0);nt<this.maps.bubbleModule.bubbleCollection.length;nt++)if(l=this.maps.bubbleModule.bubbleCollection[nt],l.LayerIndex===ft&&l.BubbleIndex===ot&&l.DataIndex===d){var st=(l.center.x+e)*f,ht=(l.center.y+o)*f,ct=this.currentLayer.animationDuration;n&&0!==ct?wi(s,0,ct,new rt(st,ht)):s.setAttribute("transform","translate( "+st+" "+ht+" )");break}}else if(t.id.indexOf("_dataLableIndex_Group")>-1)for(this.intersect=[],this.maps.zoomLabelPositions=[],this.maps.zoomLabelPositions=this.maps.dataLabelModule.dataLabelCollections,i=0;i<t.childElementCount;i++)if(t.childNodes[i].id.indexOf("_LabelIndex_")>-1&&(tt=parseFloat(t.childNodes[i].id.split("_LabelIndex_")[1].split("_")[0]),this.zoomshapewidth=this.shapeZoomLocation[tt].getBoundingClientRect(),this.maps.zoomShapeCollection.push(this.zoomshapewidth),this.dataLabelTranslate(t.childNodes[i],k,e,o,f,"DataLabel",n),lt=this.maps.layers[this.index].dataLabelSettings.border,i>0&&lt.width>1&&t.childNodes[i-1].id.indexOf("_rectIndex_")>-1)){var yt=(this.maps.zoomLabelPositions[tt].location.x+e)*f,pt=(this.maps.zoomLabelPositions[tt].location.y+o)*f,at=v(t.childNodes[i].innerHTML,this.maps.layers[this.index].dataLabelSettings.textStyle),vt=t.childNodes[i-1],wt=yt-at.width/2,bt=pt-at.height/2-5;vt.setAttribute("x",wt);vt.setAttribute("y",bt)}}else this.maps.isTileMap&&t.id.indexOf("_line_Group")>-1?(t.remove(),u.children.length>0&&u.children[0]?u.insertBefore(this.maps.navigationLineModule.renderNavigation(this.currentLayer,this.maps.tileZoomLevel,this.index),u.children[0]):u.appendChild(this.maps.navigationLineModule.renderNavigation(this.currentLayer,this.maps.tileZoomLevel,this.index))):(wr(t,this.index,f,this.maps),this.maps.zoomTranslatePoint=this.maps.translatePoint,this.animateTransform(t,n,e,o,f),this.shapeZoomLocation=t.childNodes);this.maps.arrangeTemplate()}Object(r.isNullOrUndefined)(this.currentLayer)||n&&0!==this.currentLayer.animationDuration||this.processTemplate(e,o,f,this.maps)}},n.prototype.markerTranslates=function(n,t,i,u,f,o,h,c){var l=this,k,p,y;void 0===c&&(c=!1);var d=0,g=0,nt=0,b=parseInt((n||h).id.split("_LayerIndex_")[1].split("_")[0],10),v=this.maps.renderer.createGroup({id:this.maps.element.id+"_Markers_Group","class":"GroupElement",style:"pointer-events: auto;"});document.getElementById(v.id)&&a(v.id);k=this.maps.mapAreaRect;p=Object(r.createElement)("div",{id:this.maps.element.id+"_LayerIndex_"+b+"_Markers_Template_Group",className:"template",styles:"overflow: hidden; position: absolute;pointer-events: none;top:"+k.y+"px;left:"+k.x+"px;height:"+k.height+"px;width:"+k.width+"px;"});document.getElementById(p.id)&&a(p.id);y=this.maps.layersCollection[b];y.markerSettings.map(function(n,c){var a=n.dataSource;Array.prototype.forEach.call(a,function(k,tt){l.maps.markerNullCount=c>=0&&0===tt?0:l.maps.markerNullCount;var it={template:n.template,data:k,maps:l.maps,marker:n,cancel:!1,name:lu,fill:n.fill,colorValuePath:n.colorValuePath,shapeValuePath:n.shapeValuePath,height:n.height,width:n.width,imageUrl:n.imageUrl,imageUrlValuePath:n.imageUrlValuePath,shape:n.shape,border:n.border};it=dt(it=gt(it,k),k);l.maps.trigger("markerRendering",it,function(){n.shapeValuePath!==it.shapeValuePath&&(it=gt(it,k));n.colorValuePath!==it.colorValuePath&&(it=dt(it,k));var et=Object(r.isNullOrUndefined)(n.latitudeValuePath)?Object(r.isNullOrUndefined)(k.latitude)?Object(r.isNullOrUndefined)(k.Latitude)?0:k.Latitude:parseFloat(k.latitude):Number(s(k,n.latitudeValuePath)),ot=Object(r.isNullOrUndefined)(n.longitudeValuePath)?Object(r.isNullOrUndefined)(k.longitude)?Object(r.isNullOrUndefined)(k.Longitude)?0:k.Longitude:parseFloat(k.longitude):Number(s(k,n.longitudeValuePath)),st=n.offset;if(!it.cancel&&n.visible&&!Object(r.isNullOrUndefined)(ot)&&!Object(r.isNullOrUndefined)(et)){var ht=l.maps.element.id+"_LayerIndex_"+b+"_MarkerIndex_"+c+"_dataIndex_"+tt,ft=l.maps.isTileMap?ut(new rt(ot,et),l.maps.tileZoomLevel,l.maps.tileTranslatePoint,!0):w(et,ot,t,y,l.maps),ct=(0!==y.animationDuration||Object(r.isNullOrUndefined)(l.maps.zoomModule),{x:i,y:u});!it.template||isNaN(ft.x)||isNaN(ft.y)?it.template||isNaN(ft.x)||isNaN(ft.y)||(g++,sr(it,n,a,tt,ft,ct,ht,st,f,l.maps,v)):(nt++,hr(it,void 0,ht,k,c,p,ft,ct,f,st,l.maps))}d+=isNaN(et)||isNaN(ot)?1:0;nt+=it.cancel?1:0;g+=it.cancel?1:0;l.maps.markerNullCount=Object(r.isNullOrUndefined)(et)&&Object(r.isNullOrUndefined)(ot)?l.maps.markerNullCount+1:l.maps.markerNullCount;a.length;l.maps.markerNullCount;v.childElementCount===a.length-nt-d&&"Template"!==o&&(h.appendChild(v),y.markerClusterSettings.allowClustering&&(l.maps.svgObject.appendChild(v),l.maps.element.appendChild(l.maps.svgObject),ni(y,v,l.maps,b,v,h,!0,!0)));p.childElementCount===a.length-g-d&&e(l.maps.element.id+"_Secondary_Element")&&(e(l.maps.element.id+"_Secondary_Element").appendChild(p),f>=1&&y.markerClusterSettings.allowClustering&&ni(y,p,l.maps,b,v,h,!1,!0))})})})},n.prototype.processTemplate=function(n,t,i,u){for(var f,o=0;o<this.templateCount;o++){this.currentLayer=u.layersCollection[o];var c=u.mapLayerPanel.calculateFactor(this.currentLayer),s=e(u.element.id+"_LayerIndex_"+o+"_Markers_Template_Group"),h=e(u.element.id+"_LayerIndex_"+o+"_Label_Template_Group");if(!Object(r.isNullOrUndefined)(s)&&s.childElementCount>0)for(f=0;f<s.childElementCount;f++)this.markerTranslate(s.childNodes[f],c,n,t,i,"Template");if(!Object(r.isNullOrUndefined)(h)&&h.childElementCount>0)for(f=0;f<h.childElementCount;f++)this.dataLabelTranslate(h.childNodes[f],c,n,t,i,"Template")}},n.prototype.dataLabelTranslate=function(n,t,i,u,f,o,s){var it,tt,d,p,w,ot,b,l,ut;void 0===s&&(s=!1);var h,a,y,g,ft,et=this.maps.dataLabelModule.dataLabelCollections,k=(n.getBoundingClientRect(),this.maps.layers[this.index].dataLabelSettings.textStyle),lt=(this.maps.layers[this.index].dataLabelSettings.labelPath,parseFloat(n.id.split("_LayerIndex_")[1].split("_")[0])),at=parseFloat(n.id.split("_shapeIndex_")[1].split("_")[0]);for(n.id.indexOf("_LabelIndex_")>-1&&(ft=parseFloat(n.id.split("_LabelIndex_")[1].split("_")[0])),it=this.currentLayer.animationDuration,tt=0;tt<et.length;tt++)if(d=et[tt],d.layerIndex===lt&&d.shapeIndex===at&&d.labelIndex===ft)if(p=d.location.x,w=d.location.y,"Template"===o){ot=e(this.maps.element.id+"_Layer_Collections");p=Math.abs(this.maps.baseMapRectBounds.min.x-p)*f;w=Math.abs(this.maps.baseMapRectBounds.min.y-w)*f;var st=n.getBoundingClientRect(),ht=ot.getBoundingClientRect(),ct=n.parentElement.getBoundingClientRect(),vt=p+(ht.left-ct.left)-st.width/2,yt=w+(ht.top-ct.top)-st.height/2;n.style.left=vt+"px";n.style.top=yt+"px"}else{p=(p+i)*f;var pt=(w=(w+u)*f)-(g=v(y=d.dataLabelText,k)).height/4,wt=w+g.height/4,c={rightWidth:p+g.width/2,leftWidth:p-g.width/2,heightTop:pt,heightBottom:wt};if(s&&0!==it||n.setAttribute("transform","translate( "+p+" "+w+" )"),"Hide"===this.maps.layers[this.index].dataLabelSettings.smartLabelMode&&(f>1?(h=this.zoomshapewidth.width>=g.width?y:"",n.innerHTML=h):(h=this.maps.dataLabelShape[tt]>=g.width?y:"",n.innerHTML=h)),"Trim"===this.maps.layers[this.index].dataLabelSettings.smartLabelMode&&(f>1?(h=nt(this.zoomshapewidth.width,y,k),n.innerHTML=h):(h=nt(this.maps.dataLabelShape[tt],y,k),n.innerHTML=h)),"Hide"===this.maps.layers[this.index].dataLabelSettings.intersectionAction){for(b=0;b<this.intersect.length;b++)if(!Object(r.isNullOrUndefined)(this.intersect[b])){if(!(c.leftWidth>this.intersect[b].rightWidth||c.rightWidth<this.intersect[b].leftWidth||c.heightTop>this.intersect[b].heightBottom||c.heightBottom<this.intersect[b].heightTop)){h="";n.innerHTML=h;break}h=Object(r.isNullOrUndefined)(h)?y:h;n.innerHTML=h}this.intersect.push(c)}if("Trim"===this.maps.layers[this.index].dataLabelSettings.intersectionAction){for(l=0;l<this.intersect.length;l++)if(!Object(r.isNullOrUndefined)(this.intersect[l]))if(c.rightWidth<this.intersect[l].leftWidth||c.leftWidth>this.intersect[l].rightWidth||c.heightBottom<this.intersect[l].heightTop||c.heightTop>this.intersect[l].heightBottom)a=Object(r.isNullOrUndefined)(h)?y:h,f>1&&(a=nt(this.zoomshapewidth.width,a,k)),n.innerHTML=a;else{if(c.leftWidth>this.intersect[l].leftWidth){a=nt((ut=this.intersect[l].rightWidth-c.leftWidth)-(c.rightWidth-c.leftWidth),h=Object(r.isNullOrUndefined)(h)?y:h,k);n.innerHTML=a;break}if(c.leftWidth<this.intersect[l].leftWidth){ut=c.rightWidth-this.intersect[l].leftWidth;a=nt(Math.abs(ut-(c.rightWidth-c.leftWidth)),h=Object(r.isNullOrUndefined)(h)?y:h,k);n.innerHTML=a;break}}this.intersect.push(c);Object(r.isNullOrUndefined)(a)&&(a=nt(this.zoomshapewidth.width,y,k),n.innerHTML=a)}else wi(n,0,it,new rt(p,w))}},n.prototype.markerTranslate=function(n,t,i,u,f,h,c){var v,p,b;void 0===c&&(c=!1);var tt=parseInt(n.id.split("_LayerIndex_")[1].split("_")[0],10),it=parseInt(n.id.split("_MarkerIndex_")[1].split("_")[0],10),y=parseInt(n.id.split("_dataIndex_")[1].split("_")[0],10),k=this.maps.layersCollection[tt],l=k.markerSettings[it];if(!Object(r.isNullOrUndefined)(l)&&!Object(r.isNullOrUndefined)(l.dataSource)&&!Object(r.isNullOrUndefined)(l.dataSource[y])){var d=Object(r.isNullOrUndefined)(l.longitudeValuePath)?Object(r.isNullOrUndefined)(l.dataSource[y].longitude)?Object(r.isNullOrUndefined)(l.dataSource[y].Latitude)?0:parseFloat(l.dataSource[y].Latitude):parseFloat(l.dataSource[y].longitude):Number(s(l.dataSource[y],l.longitudeValuePath)),g=Object(r.isNullOrUndefined)(l.latitudeValuePath)?Object(r.isNullOrUndefined)(l.dataSource[y].latitude)?Object(r.isNullOrUndefined)(l.dataSource[y].Latitude)?0:parseFloat(l.dataSource[y].Latitude):parseFloat(l.dataSource[y].latitude):Number(s(l.dataSource[y],l.latitudeValuePath)),nt=this.currentLayer.animationDuration,a=this.maps.isTileMap?ut(new o(d,g),this.maps.tileZoomLevel,this.maps.tileTranslatePoint,!0):w(g,d,t,k,this.maps);this.maps.isTileMap?"Template"===h?(v=n.getBoundingClientRect(),(n.style.left=a.x-v.width/2+l.offset.x+"px",n.style.top=a.y-v.height/2+l.offset.y+"px","GoogleStaticMap"===this.maps.layers[this.maps.baseLayerIndex].layerType)&&(p=e(this.maps.element.id+"_StaticGoogleMap").getBoundingClientRect(),"none"!==n.style.display&&((p.x>v.x||p.x+640<v.x+v.width)&&(p.y>v.y||p.y+p.height<v.y+v.height)||p.x>v.x||p.x+640<v.x+v.width)&&(n.style.display="none"))):(a.x+=l.offset.x,a.y+=l.offset.y,n.setAttribute("transform","translate( "+a.x+" "+a.y+" )")):"Template"===h?(b=n.getBoundingClientRect(),n.style.left=(a.x+i)*f+l.offset.x-this.maps.mapAreaRect.x-b.width/2+"px",n.style.top=(a.y+u)*f+l.offset.y-this.maps.mapAreaRect.y-b.height/2+"px"):(a.x=(a.x+i)*f+l.offset.x,a.y=(a.y+u)*f+l.offset.y,c&&0!==nt?wi(n,0,nt,a):n.setAttribute("transform","translate( "+a.x+" "+a.y+" )"))}},n.prototype.panning=function(n,t,i,u){var a,f=this.maps,p=this.mouseDownPoints,w=this.mouseMovePoints,b=f.scale,s,h,v,k,y;if(f.markerZoomedState=!1,f.zoomPersistence=f.enablePersistence,f.defaultState=!1,f.initialCheck=!1,v=f.translatePoint,k=f.tileTranslatePoint,t=Object(r.isNullOrUndefined)(t)?p.x-w.x:t,i=Object(r.isNullOrUndefined)(i)?p.y-w.y:i,this.maps.mergeCluster(),f.isTileMap)this.maps.tileZoomLevel>1&&(s=f.tileTranslatePoint.x-t,h=f.tileTranslatePoint.y-i,this.distanceX=s-f.tileTranslatePoint.x,this.distanceY=h-f.tileTranslatePoint.y,f.tileTranslatePoint.x=s,f.tileTranslatePoint.y=h,(f.tileTranslatePoint.y>-10&&i<0||f.tileTranslatePoint.y<-256*(Math.pow(2,this.maps.tileZoomLevel)-2)&&i>0)&&(f.tileTranslatePoint.x=s+t,f.tileTranslatePoint.y=h+i),f.translatePoint.x=(f.tileTranslatePoint.x-t)/f.scale,f.translatePoint.y=(f.tileTranslatePoint.y-i)/f.scale,y=this.maps.getTileGeoLocation(u.layerX,u.layerY),a={cancel:!1,name:"pan",maps:f,tileTranslatePoint:{previous:k,current:f.tileTranslatePoint},translatePoint:{previous:v,current:f.translatePoint},scale:f.scale,tileZoomLevel:f.tileZoomLevel,latitude:y.latitude,longitude:y.longitude},f.trigger("pan",a),f.mapLayerPanel.generateTiles(f.tileZoomLevel,f.tileTranslatePoint,"Pan"),this.applyTransform());else{s=v.x-t/b;h=v.y-i/b;var c=e(f.element.id+"_Layer_Collections").getBoundingClientRect(),l=e(f.element.id+"_svg").getBoundingClientRect(),d=t<0?c.left<=l.left+f.mapAreaRect.x:c.left+c.width>=l.left+l.width+f.mapAreaRect.x+f.margin.left,g=i<0?c.top<=l.top+f.mapAreaRect.y:c.top+c.height+f.margin.top>=l.top+l.height,nt=this.maps.getGeoLocation(this.maps.layersCollection.length-1,u.layerX,u.layerY);a={cancel:!1,name:"pan",maps:f,tileTranslatePoint:{},translatePoint:{previous:v,current:new o(s,h)},scale:f.scale,tileZoomLevel:f.tileZoomLevel,latitude:nt.latitude,longitude:nt.longitude};f.trigger("pan",a);a.cancel||(d&&g?(f.translatePoint=new o(s,h),this.applyTransform()):d?(f.translatePoint=new o(s,f.translatePoint.y),this.applyTransform()):g&&(f.translatePoint=new o(f.translatePoint.x,h),this.applyTransform()));this.maps.zoomNotApplied=!1}f.zoomTranslatePoint=f.translatePoint;this.mouseDownPoints=this.mouseMovePoints;this.maps.zoomNotApplied=!1;this.isSingleClick=!1},n.prototype.toAlignSublayer=function(){this.maps.translatePoint.x=Object(r.isNullOrUndefined)(this.distanceX)?this.maps.translatePoint.x:this.maps.translatePoint.x-this.distanceX/this.maps.scale;this.maps.translatePoint.y=Object(r.isNullOrUndefined)(this.distanceY)?this.maps.translatePoint.y:this.maps.translatePoint.y-this.distanceY/this.maps.scale;this.applyTransform(!1)},n.prototype.toolBarZooming=function(n,t){var h=this,i=this.maps,e,c,f,k;i.initialCheck=!1;i.defaultState="Reset"===t&&1===n&&!(i.zoomSettings.resetToInitial&&i.applyZoomReset)||"ZoomOut"===t&&1===n;e=i.tileZoomLevel;c=i.previousScale=i.scale;i.markerZoomedState=!1;i.zoomPersistence=i.enablePersistence;i.mapScaleValue=n;var v=i.zoomSettings.maxZoom,u=i.zoomSettings.minZoom,r=i.mapAreaRect,y=i.previousPoint=i.translatePoint,p=i.tileTranslatePoint;if(i.previousProjection=i.projectionType,n="ZoomOut"===t&&1===Math.round(n)?1:n,n=u>(n="Reset"===t||0===Math.round(n)?1:n)&&"ZoomIn"===t?u+1:n,!i.isTileMap&&("ZoomIn"===t?n>=u&&n<=v:n>=u||i.isReset)){var s=i.baseMapRectBounds.min,w=i.baseMapRectBounds.max,d=Math.abs(w.x-s.x),g=Math.abs(s.y-w.y),l=y.x-(r.width/c-r.width/n)/2,a=y.y-(r.height/c-r.height/n)/2,b=Math.abs(i.baseMapRectBounds.max.y-i.baseMapRectBounds.min.y)*n;l=b<i.mapAreaRect.height?r.x+(-s.x+(r.width/2-d/2)):l;a=b<i.mapAreaRect.height?r.y+(-s.y+(r.height/2-g/2)):a;i.translatePoint=new o(l,a);i.zoomTranslatePoint=i.translatePoint;i.scale=n;this.triggerZoomEvent(p,e,t);this.applyTransform(!0)}else i.isTileMap&&(n>=u&&n<=v||i.isReset)&&(f=e<u&&!i.isReset?u:n,i.scale=Math.pow(2,f-1),i.tileZoomLevel=f,i.zoomSettings.zoomFactor=n,k={x:i.availableSize.width/2,y:i.availableSize.height/2},this.getTileTranslatePosition(e,f,k,t),(i.zoomSettings.resetToInitial&&i.applyZoomReset&&"Reset"===t||"ZoomOut"===t&&i.zoomSettings.resetToInitial&&i.applyZoomReset&&f<=i.initialZoomLevel)&&(i.initialCheck=!0,i.zoomPersistence=!1,i.tileTranslatePoint.x=i.initialTileTranslate.x,i.tileTranslatePoint.y=i.initialTileTranslate.y,f=i.tileZoomLevel=i.mapScaleValue=i.initialZoomLevel),this.triggerZoomEvent(p,e,t),i.translatePoint.y=(i.tileTranslatePoint.y-.01*i.mapScaleValue)/i.scale,i.translatePoint.x=(i.tileTranslatePoint.x-.01*i.mapScaleValue)/i.scale,document.getElementById(this.maps.element.id+"_LayerIndex_1")&&(document.getElementById(this.maps.element.id+"_LayerIndex_1").style.display="none"),document.querySelector(".GroupElement")&&(document.querySelector(".GroupElement").style.display="none"),i.mapLayerPanel.generateTiles(f,i.tileTranslatePoint,t),document.getElementById(this.maps.element.id+"_tiles"),setTimeout(function(){h.applyTransform(!0);document.getElementById(h.maps.element.id+"_LayerIndex_1")&&(document.getElementById(h.maps.element.id+"_LayerIndex_1").style.display="block")},250));this.maps.zoomNotApplied=!1},n.prototype.createZoomingToolbars=function(){var n=this.maps,l,a,c,i,u,t,f,e,r;this.toolBarGroup=n.renderer.createGroup({id:n.element.id+"_Zooming_KitCollection",opacity:.3});var o=15,s=15,v=n.zoomSettings.toolBarOrientation,p=n.zoomSettings.toolbars,h=n.zoomSettings.toolbars.length,w="Horizontal"===n.zoomSettings.toolBarOrientation?16*h+20*h:32,d="Horizontal"===n.zoomSettings.toolBarOrientation?32:16*h+20*h;for(this.toolBarGroup.appendChild(n.renderer.drawRectangle(new k(n.element.id+"_Zooming_Rect","transparent",{color:"transparent",width:1},1,new y(0,0,w,d),0,0))),l=n.renderer.createDefs(),l.innerHTML='<filter id="chart_shadow" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="5"/><feOffset dx="-3" dy="4" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="1"/><\/feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/><\/feMerge><\/filter>',this.toolBarGroup.appendChild(l),a=n.renderer.drawRectangle(new k(n.element.id+"_Zooming_Rect","transparent",{color:"transparent",width:1},.1,new y(0,0,w,d),0,0)),a.setAttribute("filter","url(#chart_shadow)"),this.toolBarGroup.appendChild(a),c=0;c<p.length;c++){i=p[c];this.currentToolbarEle=n.renderer.createGroup({id:n.element.id+"_Zooming_ToolBar_"+i+"_Group",transform:"translate( "+o+" "+s+" ) "});this.currentToolbarEle.setAttribute("class","e-maps-toolbar");u="transparent";t="";switch(this.selectionColor=this.maps.zoomSettings.selectionColor||this.maps.themeStyle.zoomSelectionColor,i.toLowerCase()){case"zoom":f=void 0;e=void 0;t="M0.001,14.629L1.372,16l4.571-4.571v-0.685l0.228-0.274c1.051,0.868,2.423,1.417,3.885,1.417c3.291,0,";t+="5.943-2.651,5.943-5.943S13.395,0,10.103,0S4.16,2.651,4.16,5.943c0,1.508,0.503,2.834,1.417,3.885l-0.274,0.228H4.571";t+="L0.001,14.629L0.001,14.629z M5.943,5.943c0-2.285,1.828-4.114,4.114-4.114s4.114,1.828,4.114,";this.maps.zoomSettings.enablePanning&&!this.maps.zoomSettings.enableSelectionZooming||this.maps.zoomSettings.enablePanning&&this.maps.zoomSettings.enableSelectionZooming?(f=u,e=this.maps.themeStyle.zoomFillColor):this.maps.zoomSettings.enablePanning||this.maps.zoomSettings.enableSelectionZooming?(f=this.selectionColor,e=this.selectionColor):(f=u,e=this.maps.themeStyle.zoomFillColor);this.currentToolbarEle.appendChild(n.renderer.drawPath(new b(n.element.id+"_Zooming_ToolBar_"+i,f,1,e,1,1,null,t+"4.114s-1.828,4.114-4.114,4.114S5.943,8.229,5.943,5.943z")));this.zoomElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"zoomin":t="M 8, 0 L 8, 16 M 0, 8 L 16, 8";this.currentToolbarEle.appendChild(n.renderer.drawPath(new b(n.element.id+"_Zooming_ToolBar_"+i+"_Path",u,3,this.maps.themeStyle.zoomFillColor,1,1,null,t)));this.zoomInElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"zoomout":t="M 0, 8 L 16, 8";this.currentToolbarEle.appendChild(n.renderer.drawPath(new b(n.element.id+"_Zooming_ToolBar_"+i,u,3,this.maps.themeStyle.zoomFillColor,1,1,null,t)));this.zoomOutElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"pan":r=void 0;t="M5,3h2.3L7.275,5.875h1.4L8.65,3H11L8,0L5,3z M3,11V8.7l2.875,0.025v-1.4L3,7.35V5L0,8L3,";t+="11z M11,13H8.7l0.025-2.875h-1.4L7.35,13H5l3,3L11,13z M13,5v2.3l-2.875-0.025v1.4L13,8.65V11l3-3L13,5z";this.maps.zoomSettings.enablePanning&&this.maps.zoomModule.isDragZoom?r="#737373":this.maps.zoomSettings.enablePanning?r=this.selectionColor:(r="#737373",this.currentToolbarEle.setAttribute("class",""));this.currentToolbarEle.appendChild(n.renderer.drawPath(new b(n.element.id+"_Zooming_ToolBar_"+i,r,1,r,1,1,null,t)));this.panColor=r;this.panElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"reset":t="M12.364,8h-2.182l2.909,3.25L16,8h-2.182c0-3.575-2.618-6.5-5.818-6.5c-1.128,0-2.218,0.366-3.091,";t+="1.016l1.055,1.178C6.581,3.328,7.272,3.125,8,3.125C10.4,3.125,12.363,5.319,12.364,8L12.364,8z M11.091,";t+="13.484l-1.055-1.178C9.419,12.672,8.728,12.875,8,12.875c-2.4,0-4.364-2.194-4.364-4.875h2.182L2.909,4.75L0,8h2.182c0,";this.currentToolbarEle.appendChild(n.renderer.drawPath(new b(n.element.id+"_Zooming_ToolBar_"+i,this.fillColor,null,this.maps.themeStyle.zoomFillColor,1,1,null,t+"3.575,2.618,6.5,5.818,6.5C9.128,14.5,10.219,14.134,11.091,13.484L11.091,13.484z")));this.wireEvents(this.currentToolbarEle,this.performToolBarAction)}this.currentToolbarEle.appendChild(n.renderer.drawCircle(new kt(n.element.id+"_Zooming_ToolBar_"+i+"_Rect",u,{color:this.maps.themeStyle.zoomFillColor,width:1},1,8,8,16,"")));o="Horizontal"===v?o+36:o;s="Horizontal"===v?s:s+36;this.toolBarGroup.appendChild(this.currentToolbarEle)}},n.prototype.performToolBarAction=function(n){var r=n.target,i,t;n.stopImmediatePropagation();i="touch"===n.pointerType||"2"===n.pointerType||n.type.indexOf("touch")>-1;t=r.id.split("_Zooming_ToolBar_")[1].split("_")[0];i?(this.handled=!0,this.performZoomingByToolBar(t)):"mousedown"!==n.type&&"pointerdown"!==n.type||this.handled?this.handled=!1:(this.handled=!1,this.performZoomingByToolBar(t))},n.prototype.performZoomingByToolBar=function(n){var t=this.maps;switch(t.isReset=!1,n.toLowerCase()){case"zoom":this.panColor=this.fillColor;this.zoomColor=this.selectionColor;this.applySelection(this.zoomElements,this.selectionColor);this.applySelection(this.panElements,this.fillColor);break;case"pan":this.panColor=this.maps.zoomSettings.enablePanning?this.selectionColor:"#737373";this.zoomColor=this.fillColor;this.maps.zoomSettings.enablePanning?(this.applySelection(this.zoomElements,this.fillColor),this.applySelection(this.panElements,this.panColor)):(this.applySelection(this.zoomElements,this.selectionColor),this.applySelection(this.panElements,this.panColor));break;case"zoomin":t.staticMapZoom=t.tileZoomLevel;t.staticMapZoom>0&&t.staticMapZoom<22&&(t.staticMapZoom+=1);this.toolBarZooming((t.isTileMap?t.tileZoomLevel:t.scale)+1,"ZoomIn");break;case"zoomout":t.staticMapZoom=t.tileZoomLevel;t.markerCenterLatitude=null;t.markerCenterLongitude=null;this.toolBarZooming((t.isTileMap?t.tileZoomLevel:t.scale)-1,"ZoomOut");break;case"reset":t.staticMapZoom=t.zoomSettings.enable?t.zoomSettings.zoomFactor:0;t.markerCenterLatitude=null;t.markerCenterLongitude=null;this.toolBarZooming(1,"Reset");this.maps.zoomSettings.enablePanning?(this.applySelection(this.zoomElements,this.fillColor),this.applySelection(this.panElements,this.selectionColor)):(this.applySelection(this.zoomElements,this.selectionColor),this.applySelection(this.panElements,"#737373"))}this.panningStyle(n.toLowerCase())},n.prototype.panningStyle=function(n){var t=e(this.maps.element.id+"_svg");"pan"===n||this.isPanning?t.setAttribute("class","e-maps-panning"):t.setAttribute("class","")},n.prototype.applySelection=function(n,t){if(n)for(var i,r=0;r<n.childElementCount;r++)"circle"!==(i=n.childNodes[r]).tagName&&(i.setAttribute("fill",t),i.setAttribute("stroke",t))},n.prototype.showTooltip=function(n){var t=n.target.id.split("_Zooming_ToolBar_")[1].split("_")[0];this.isTouch||function(n,t,i,u,f){var e=c(n),o="top:"+i.toString()+"px;left:"+u.toString()+"px;color: #000000; background:#FFFFFF;position:absolute;border:1px solid #707070;font-size:"+f+";border-radius:2px;";e?(e.setAttribute("innerHTML","&nbsp;"+t+"&nbsp;"),e.setAttribute("styles",o)):(e=Object(r.createElement)("div",{id:n,innerHTML:"&nbsp;"+t+"&nbsp;",styles:o}),document.body.appendChild(e))}("EJ2_Map_Toolbar_Tip",this.maps.getLocalizedLabel(t),n.pageY+10,n.pageX+10,"10px")},n.prototype.removeTooltip=function(){e("EJ2_Map_Toolbar_Tip")&&Object(r.remove)(e("EJ2_Map_Toolbar_Tip"))},n.prototype.alignToolBar=function(){var n=this.maps,u=Object(r.createElement)("div",{id:n.element.id+"_ToolBar",styles:"position:absolute;z-index:2"}),f=n.renderer.createSvg({id:n.element.id+"_Zooming_ToolBar",width:10,height:10}),t;f.appendChild(this.toolBarGroup);u.appendChild(f);e(n.element.id+"_Secondary_Element")&&e(n.element.id+"_Secondary_Element").appendChild(u);t=this.toolBarGroup.getBoundingClientRect();f.setAttribute("height",(t.height+5).toString());f.setAttribute("width",(t.width+5).toString());var i=Object(r.isNullOrUndefined)(n.totalRect)?n.mapAreaRect:n.totalRect,o=0,s=0;switch(n.zoomSettings.verticalAlignment){case"Near":s=i.y;break;case"Center":s=i.height/2-t.height/2;break;case"Far":s=i.height-t.height-10}switch(n.zoomSettings.horizontalAlignment){case"Near":o=i.x;break;case"Center":o=i.width/2-t.width/2;break;case"Far":o=i.width-t.width-10}u.style.left=o+"px";u.style.top=s+"px";var h=this.maps.zoomSettings.highlightColor||this.maps.themeStyle.zoomSelectionColor,l=" .e-maps-toolbar:hover > circle { stroke:"+h+"; } .e-maps-toolbar:hover > path { fill: "+h+" ;  stroke: "+h+"; }.e-maps-toolbar:hover { cursor: pointer; } .e-maps-cursor-disable:hover { cursor: not-allowed; } .e-maps-panning:hover { cursor: pointer; } .e-maps-popup-close { display: block; opacity: 0; }",c=document.createElement("style");c.appendChild(document.createTextNode(l));u.appendChild(c)},n.prototype.wireEvents=function(n,t){r.EventHandler.add(n,r.Browser.touchStartEvent,t,this);r.EventHandler.add(n,"mouseover",this.showTooltip,this);r.EventHandler.add(n,"mouseout",this.removeTooltip,this)},n.prototype.mapMouseWheel=function(n){var t,u;if(this.maps.zoomSettings.enable&&this.maps.zoomSettings.mouseWheelZoom){t=this.maps;t.availableSize;t.markerZoomedState=!1;t.zoomPersistence=t.enablePersistence;var i=this.getMousePosition(n.pageX,n.pageY),f=t.tileZoomLevel,e=t.scale,r=t.isTileMap?f:e;i.x>t.mapAreaRect.x&&i.x<t.mapAreaRect.x+t.mapAreaRect.width&&i.y>t.mapAreaRect.y&&i.y<t.mapAreaRect.y+t.mapAreaRect.height&&(n.preventDefault(),u="mozilla"!==this.browserName||this.isPointer?n.wheelDelta/120>0?"ZoomIn":"ZoomOut":-n.detail/3>0?"ZoomIn":"ZoomOut","ZoomIn"===u?(t.mapScaleValue=r+1,t.staticMapZoom=t.tileZoomLevel,t.staticMapZoom>0&&t.staticMapZoom<22&&(t.staticMapZoom+=1),this.performZooming(i,r+1,u)):(t.mapScaleValue=r-1,t.staticMapZoom=t.tileZoomLevel,1===t.mapScaleValue&&(t.markerCenterLatitude=null,t.markerCenterLongitude=null),t.staticMapZoom>1&&t.staticMapZoom<22&&(t.staticMapZoom-=1),this.performZooming(i,r-1,u)))}},n.prototype.doubleClick=function(n){var u=n.pageX,f=n.pageY,r;if(n.target,this.maps.zoomSettings.enable&&this.maps.zoomSettings.doubleClickZoom&&!(n.target.id.indexOf("_Zooming_")>-1)){var i=this.getMousePosition(u,f),t=this.maps,e=(t.availableSize,t.tileZoomLevel),o=t.scale;t.mapScaleValue=t.mapScaleValue+1;r=t.isTileMap?e:o;i.x>t.mapAreaRect.x&&i.x<t.mapAreaRect.x+t.mapAreaRect.width&&i.y>t.mapAreaRect.y&&i.y<t.mapAreaRect.y+t.mapAreaRect.height&&this.performZooming(i,r+1,"ZoomIn")}},n.prototype.mouseDownHandler=function(n){var t,i,r=null;n.target;"touchstart"===n.type?(this.isTouch=!0,r=n.touches,n.target,t=r[0].clientX,i=r[0].clientY):(t=n.pageX,i=n.pageY,n.target);this.isPanning=this.maps.zoomSettings.enablePanning?this.panColor===this.selectionColor?this.maps.zoomSettings.enablePanning:this.zoomColor!==this.selectionColor:this.panColor!==this.selectionColor?this.maps.zoomSettings.enablePanning:this.zoomColor===this.selectionColor;this.mouseDownLatLong={x:t,y:i};this.rectZoomingStart=!this.isPanning&&this.maps.zoomSettings.enable;this.mouseDownPoints=this.getMousePosition(t,i);this.isTouch&&(this.firstMove=!0,this.pinchFactor=this.maps.scale,this.fingers=r.length);this.isSingleClick=!0},n.prototype.mouseMoveHandler=function(n){var u,f,o,t=this.maps,i=null,s=this.maps.zoomSettings;"touchmove"===n.type?(this.isTouch=!0,o=n.target,u=(i=n.touches)[0].clientX,f=i[0].clientY):(u=n.pageX,f=n.pageY,o=n.target);e(t.element.id+"_Zooming_KitCollection")&&(o.id.indexOf("_Zooming_")>-1?(e(t.element.id+"_Zooming_KitCollection").setAttribute("opacity","1"),document.getElementById(t.element.id+"_Zooming_ToolBar_Pan_Group")&&(this.maps.zoomSettings.enablePanning||(o.id.indexOf("_Zooming_ToolBar")>-1||o.id.indexOf("_Zooming_Rect")>-1)&&(e(t.element.id+"_Zooming_ToolBar_Pan_Rect").setAttribute("opacity","0.3"),e(t.element.id+"_Zooming_ToolBar_Pan").setAttribute("opacity","0.3")))):(e(t.element.id+"_Zooming_KitCollection").setAttribute("opacity","0.3"),!this.maps.zoomSettings.enablePanning&&document.getElementById(t.element.id+"_Zooming_ToolBar_Pan_Group")&&(e(t.element.id+"_Zooming_ToolBar_Pan_Rect").setAttribute("opacity","1"),e(t.element.id+"_Zooming_ToolBar_Pan").setAttribute("opacity","1"))));this.isTouch&&this.maps.zoomSettings.pinchZooming&&(this.firstMove&&2===i.length?(this.rectZoomingStart=!1,this.updateInteraction(),this.touchStartList=br(n)):2===i.length&&2===this.touchStartList.length&&(this.touchMoveList=br(n),n.preventDefault(),this.rectZoomingStart=!1,this.performPinchZooming(n)),this.firstMove=!1);this.mouseMovePoints=this.getMousePosition(u,f);n.target.id;n.target;s.enable&&this.isPanning&&(r.Browser.isDevice&&i.length>=1||!r.Browser.isDevice)&&(n.preventDefault(),this.maps.element.style.cursor="pointer",this.mouseMoveLatLong={x:u,y:f},this.mouseDownLatLong.x!==this.mouseMoveLatLong.x&&this.mouseDownLatLong.y!==this.mouseMoveLatLong.y&&(this.maps.zoomSettings.enablePanning&&this.panning("None",null,null,n),this.mouseDownLatLong.x=u,this.mouseDownLatLong.y=f));(this.isTouch?1===i.length&&this.rectZoomingStart:this.rectZoomingStart)&&(n.preventDefault(),this.maps.zoomSettings.enableSelectionZooming&&this.drawZoomRectangle())},n.prototype.mouseUpHandler=function(){this.maps;this.rectZoomingStart=!1;this.isPanning=!1;this.isSingleClick=!!this.isSingleClick;this.isTouch=!1;this.touchStartList=[];this.touchMoveList=[];this.lastScale=1;this.maps.element.style.cursor="auto";Object(r.isNullOrUndefined)(this.distanceX)&&Object(r.isNullOrUndefined)(this.distanceY)||Object(r.isNullOrUndefined)(this.currentLayer)||"SubLayer"!==this.currentLayer.type||(this.toAlignSublayer(),this.distanceX=this.distanceY=null);var n=e(this.maps.element.id+"_Selection_Rect_Zooming");n&&this.maps.zoomSettings.enable&&this.maps.zoomSettings.enableSelectionZooming&&(Object(r.remove)(n),this.performRectZooming());this.mouseMoveLatLong={x:0,y:0};this.mouseDownLatLong={x:0,y:0}},n.prototype.mouseCancelHandler=function(){this.isPanning=!1;this.isTouch=!1;this.rectZoomingStart=!1;var n=e(this.maps.element.id+"_Selection_Rect_Zooming");n&&this.maps.zoomSettings.enable&&(Object(r.remove)(n),this.performRectZooming())},n.prototype.click=function(n){var t=this.maps,r;if(t.markerModule&&t.markerModule.sameMarkerData.length>0||n.target.id.indexOf("MarkerIndex")>-1&&-1===n.target.id.indexOf("cluster"))return null;if(this.isSingleClick&&t.zoomSettings.zoomOnClick&&!(n.target.id.indexOf("_Zooming_")>-1)&&!t.zoomSettings.doubleClickZoom&&this.zoomColor!==this.selectionColor){var u=n.pageX,f=n.pageY,i=this.getMousePosition(u,f),e=t.tileZoomLevel,o=t.scale;t.mapScaleValue=t.mapScaleValue+1;r=t.isTileMap?e:o;i.x>t.mapAreaRect.x&&i.x<t.mapAreaRect.x+t.mapAreaRect.width&&i.y>t.mapAreaRect.y&&i.y<t.mapAreaRect.y+t.mapAreaRect.height&&this.performZooming(i,r+1,"ZoomIn")}},n.prototype.getMousePosition=function(n,t){var i=this.maps,r=i.element.getBoundingClientRect(),u=i.element.ownerDocument.defaultView.pageXOffset,f=i.element.ownerDocument.defaultView.pageYOffset,e=i.element.ownerDocument.documentElement.clientTop,s=i.element.ownerDocument.documentElement.clientLeft,h=r.left+u-s,c=r.top+f-e;return new o(Math.abs(n-h),Math.abs(t-c))},n.prototype.addEventListener=function(){this.maps.isDestroyed||(r.EventHandler.add(this.maps.element,this.wheelEvent,this.mapMouseWheel,this),r.EventHandler.add(this.maps.element,"click",this.click,this),r.EventHandler.add(this.maps.element,"dblclick",this.doubleClick,this),this.maps.on(r.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.maps.on(r.Browser.touchStartEvent,this.mouseDownHandler,this),this.maps.on(r.Browser.touchEndEvent,this.mouseUpHandler,this),r.EventHandler.add(this.maps.element,this.cancelEvent,this.mouseCancelHandler,this))},n.prototype.removeEventListener=function(){this.maps.isDestroyed||(r.EventHandler.remove(this.maps.element,this.wheelEvent,this.mapMouseWheel),r.EventHandler.remove(this.maps.element,"click",this.click),r.EventHandler.remove(this.maps.element,"dblclick",this.doubleClick),this.maps.off(r.Browser.touchMoveEvent,this.mouseMoveHandler),this.maps.off(r.Browser.touchStartEvent,this.mouseDownHandler),this.maps.off(r.Browser.touchEndEvent,this.mouseUpHandler),this.maps.off(this.cancelEvent,this.mouseCancelHandler))},n.prototype.getModuleName=function(){return"Zoom"},n.prototype.destroy=function(){this.removeEventListener()},n}();i(3);nf.Inject(le,ye,cu,pe,we,be,ke,ae,ve,gu);hi={};hi.Maps=nf;tf={maps:hi=Object(di.copy)(window.ejs?window.ejs.maps:{},hi)};window.ejs=Object(di.copy)(window.ejs||{},tf);window.ejdashboard=window.ejs}]);
